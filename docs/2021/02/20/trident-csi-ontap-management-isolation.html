<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Limit CSI provisioner's blast radius for ONTAP storage | Acting Technologist</title>
<meta name="description" content="Limit blast radius of Trident CSI with ONTAP storage systems">


  <meta name="author" content="scaleoutSean">
  
  <meta property="article:author" content="scaleoutSean">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Acting Technologist">
<meta property="og:title" content="Limit CSI provisioner's blast radius for ONTAP storage">
<meta property="og:url" content="https://scaleoutsean.github.io/2021/02/20/trident-csi-ontap-management-isolation.html">


  <meta property="og:description" content="Limit blast radius of Trident CSI with ONTAP storage systems">





  <meta name="twitter:site" content="@scaleoutSean">
  <meta name="twitter:title" content="Limit CSI provisioner's blast radius for ONTAP storage">
  <meta name="twitter:description" content="Limit blast radius of Trident CSI with ONTAP storage systems">
  <meta name="twitter:url" content="https://scaleoutsean.github.io/2021/02/20/trident-csi-ontap-management-isolation.html">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2021-02-20T00:00:00+08:00">






<link rel="canonical" href="https://scaleoutsean.github.io/2021/02/20/trident-csi-ontap-management-isolation.html">







  <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />


  <meta name="msvalidate.01" content="7cf5b7d96a77410a8ad035f764dc81b3">





<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Acting Technologist Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic" rel="stylesheet" type="text/css">


  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/scaleoutsean-acting-technologist.png" alt="Acting Technologist"></a>
        
        <a class="site-title" href="/">
          Acting Technologist
          <span class="site-subtitle">human action through technology</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/archive/"
                
                
              >Archive</a>
            </li><li class="masthead__menu-item">
              <a
                href="/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/projects.html"
                
                
              >Projects</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Limit CSI provisioner's blast radius for ONTAP storage">
    <meta itemprop="description" content="How to limit CSI's blast radius in a Kubernetes environment with dynamically provisioned ONTAP storage">
    <meta itemprop="datePublished" content="2021-02-20T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://scaleoutsean.github.io/2021/02/20/trident-csi-ontap-management-isolation.html" itemprop="url">Limit CSI provisioner's blast radius for ONTAP storage
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-02-20T00:00:00+08:00">2021-02-20 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <ul>
  <li><a href="#problem">Problem</a></li>
  <li><a href="#solutions">Solutions</a></li>
  <li><a href="#demo">Demo</a></li>
</ul>

<h2 id="problem">Problem</h2>

<p>"We'd like to automate, but we don't expose storage management interface to workload nodes".</p>

<h2 id="solutions">Solutions</h2>

<p>There are several.</p>

<p>For the maximum security in management, don't use CSI. Provision manually. Problem solved! There's no dynamic storage provisioning, that's true, but you <em>could</em> automate out-of-band with Ansible and use static or host-path provisioning.</p>

<p>Another way is to use Storage Virtual Machine(s) or SVMs, which are conceptually similar to hypervisor VMs:</p>

<ul>
  <li>virtual data network</li>
  <li>virtual management network</li>
  <li>virtual management account</li>
  <li>virtual storage (RAID group)</li>
</ul>

<p>An ONTAP Storage VM (SVM) doesn't always have to have all these, but it can. To keep the post shorter, let's say we configure all four. What are the benefits of SVMs for <a href="https://netapp-trident.readthedocs.io/en/latest/search.html?q=svm+vsadmin&amp;check_keywords=no&amp;area=default#">Trident CSI</a> users?</p>

<ul>
  <li>Each container cluster (Kubernetes or other) can use its own SVM(s)
    <ul>
      <li>Container (worker) nodes use virtual data network(s) to access an SVM's storage resources (NFS, iSCSI)</li>
      <li>Because the SVM data network is exposed only to selected orchestrator (Kubernetes cluster), worker from other clusters cannot access this SVM's data interfaces</li>
      <li>Because the SVM "owns" only designated RAID group(s), it cannot access other "cluster level" (I don't mean KVM/vSphere, but ONTAP Cluster) storage resources</li>
    </ul>
  </li>
  <li>Each container cluster has its own Trident CSI instance (which, being one of the containers running on its worker nodes, can access designated SVM's Management IP)
    <ul>
      <li>Trident can use its own account (with minimal privileges) or an SVM admin (Vsadmin) account (highest SVM privileges) - it's up to you</li>
      <li>Because the worker nodes can access the SVM Management IP, we can set up two SVM management accounts for more flexibility: one for Trident CSI (HTTPS + API; minimum privileges) and one for the SVM admin (SSH, or HTTPS, or SSH and HTTPS; maximum SVM-scoped privileges) and use the SVM admin account for non-CSI purposes such as Ansible automation</li>
    </ul>
  </li>
  <li>ONTAP Cluster
    <ul>
      <li>Retains its cluster management interfaces which are exposed to a completely different network (highly secure "corporate management LAN")</li>
      <li>Has its own cluster management account</li>
      <li>Haa one or more SVMs</li>
      <li>Has one or more RAID groups, each of which can be placed under an SVM's control</li>
    </ul>
  </li>
</ul>

<p>In an environment with one ONTAP cluster, multiple container clusters could each have their own SVM Service Network, SVM Data Network, and SVM Management VLAN(s). An example of one container cluster with one SVM on one ONTAP cluster:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Who?</th>
      <th style="text-align: center">Corp Mgmt LAN</th>
      <th style="text-align: center">Service VLAN</th>
      <th style="text-align: center">SVM Data VLAN</th>
      <th style="text-align: center">SVM Mgmt VLAN</th>
      <th style="text-align: center">Backup VLAN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">K8s Masters</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">Optional*</td>
      <td style="text-align: center">Y</td>
    </tr>
    <tr>
      <td style="text-align: left">K8s Workers</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">Y</td>
    </tr>
    <tr>
      <td style="text-align: left">K8s Infra-N**</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">Optional*</td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">Y</td>
    </tr>
    <tr>
      <td style="text-align: left">ONTAP SVM</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">Y</td>
    </tr>
    <tr>
      <td style="text-align: left">ONTAP Cluster</td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">-</td>
    </tr>
  </tbody>
</table>

<p>* We can have the Masters connected to SVM Mgmt VLAN for Ansible or other purposes, but one can also run Ansible from a user shell account on Worker nodes
** K8s Infra-N is an option recommended for <a href="https://netapp-trident.readthedocs.io/en/stable-v21.01/dag/kubernetes/deploying_trident.html#deploy-trident-to-infrastructure-nodes-openshift-3-11">Red Hat OpenShift</a> if you have "infrastructure" nodes (two or more) for infrastructure workloads and want to avoid Trident on <code class="language-plaintext highlighter-rouge">node-role.kubernetes.io/compute=true</code>.</p>

<p>In my demo (link at the bottom) I cheated in the sense that ONTAP Cluster was in fact connected to External/Service VLAN, but from the demo it is clear that SVM Data and Management LANs are the only way Trident and Workers could use to reach SVM interfaces.</p>

<p><img src="/assets/images/k8s-ots-network.png" alt="K8s, and SVM-based Trident CSI provisioning with ONTAP Select" /></p>

<p>With this setup (multiple and independent) container cluster administrators can automate their storage without being able to impact anyone else.</p>

<p>They can't get 100% of ONTAP API functionality this way - because some actions require ONTAP Cluster admin account and access to ONTAP Cluster admin IP - but that's what security is about.</p>

<p>As I hinted earlier, a container cluster can be configured to simultaneously connect to several Trident back-ends, so we can fine tune and intermix various approaches even within one container cluster.</p>

<p>For example, we configure Trident CSI to use an SVM admin-level account for one SVM (a Trident CSI back-end for which we want more convenience and less security), add a more limited dedicated SVM account for iSCSI on another SVM where we won't more security and less flexibility, and add yet another SVM which isn't dynamically provisioned at all.</p>

<p>There are other settings not directly related to ONTAP, such as orchestrator-level RBAC and Storage Class settings, which can help us limit access or set resource consumption limits to achieve an even finer balance between security and convenience.</p>

<h2 id="demo">Demo</h2>

<p>Find it <a href="https://youtu.be/UCNziUG19bg">here</a> (1m51s).</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/csi" class="page__taxonomy-item p-category" rel="tag">csi</a><span class="sep">, </span>
    
      <a href="/tags/ontap" class="page__taxonomy-item p-category" rel="tag">ontap</a><span class="sep">, </span>
    
      <a href="/tags/trident" class="page__taxonomy-item p-category" rel="tag">trident</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/kubernetes" class="page__taxonomy-item p-category" rel="tag">kubernetes</a><span class="sep">, </span>
    
      <a href="/categories/storage" class="page__taxonomy-item p-category" rel="tag">storage</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2021-02-20T00:00:00+08:00">2021-02-20 00:00</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?via=scaleoutSean&text=Limit+CSI+provisioner%27s+blast+radius+for+ONTAP+storage%20https%3A%2F%2Fscaleoutsean.github.io%2F2021%2F02%2F20%2Ftrident-csi-ontap-management-isolation.html" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://scaleoutsean.github.io/2021/02/20/trident-csi-ontap-management-isolation.html" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>

</section>


      
  <nav class="pagination">
    
      <a href="/2021/02/17/storagegrid-s3-private-container-registry.html" class="pagination--pager" title="Use StorageGRID for private container registry">Previous</a>
    
    
      <a href="/2021/02/24/netapp-trident-on-arm64.html" class="pagination--pager" title="NetApp Trident v21.01.1 on Linux/ARM64 with SolidFire iSCSI storage">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2026/01/19/netapp-eseries-santricity-csi.html" rel="permalink">NetApp E-Series SANtricity CSI
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2026-01-19T00:00:00+08:00">2026-01-19 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Community CSI driver for NetApp E-Series arrays: what it is and what it does
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2026/01/16/santricity-eseries-datalake-storage.html" rel="permalink">Big Data &amp; analytics patterns for NetApp object &amp; block
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2026-01-16T00:00:00+08:00">2026-01-16 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2026/01/16/eseries-santricity-terraform-provider.html" rel="permalink">NetApp E-Series SANtricity Terraform Provider
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2026-01-16T00:00:00+08:00">2026-01-16 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          15 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Provision storage in seconds with Terraform and E-Series
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2026/01/15/santricity-go-language-library-cli.html" rel="permalink">E-Series SANtricity Go client for Day 1+ operations
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2026-01-15T00:00:00+08:00">2026-01-15 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Permissive OSS client Go library and CLI for E-Series SANtricity storage systems
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2020-2026 scaleoutSean.github.io | <a href="https://scaleoutsean.github.io">Acting Technologist</a> | Terms: <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank">CC BY 4.0</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
