<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>SGAC v0.1 | Acting Technologist</title>
<meta name="description" content="Convert NetApp StorageGRID audit log to JSON">


  <meta name="author" content="scaleoutSean">
  
  <meta property="article:author" content="scaleoutSean">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Acting Technologist">
<meta property="og:title" content="SGAC v0.1">
<meta property="og:url" content="https://scaleoutsean.github.io/2021/08/09/sgac-storagegrid-audit-log-converter-v0.1.html">


  <meta property="og:description" content="Convert NetApp StorageGRID audit log to JSON">





  <meta name="twitter:site" content="@scaleoutSean">
  <meta name="twitter:title" content="SGAC v0.1">
  <meta name="twitter:description" content="Convert NetApp StorageGRID audit log to JSON">
  <meta name="twitter:url" content="https://scaleoutsean.github.io/2021/08/09/sgac-storagegrid-audit-log-converter-v0.1.html">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2021-08-09T00:00:00+08:00">






<link rel="canonical" href="https://scaleoutsean.github.io/2021/08/09/sgac-storagegrid-audit-log-converter-v0.1.html">







  <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />


  <meta name="msvalidate.01" content="7cf5b7d96a77410a8ad035f764dc81b3">





<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Acting Technologist Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic" rel="stylesheet" type="text/css">


  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/scaleoutsean-acting-technologist.png" alt="Acting Technologist"></a>
        
        <a class="site-title" href="/">
          Acting Technologist
          <span class="site-subtitle">human action through technology</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/archive/"
                
                
              >Archive</a>
            </li><li class="masthead__menu-item">
              <a
                href="/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/projects/"
                
                
              >Projects</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="SGAC v0.1">
    <meta itemprop="description" content="How it begun">
    <meta itemprop="datePublished" content="2021-08-09T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://scaleoutsean.github.io/2021/08/09/sgac-storagegrid-audit-log-converter-v0.1.html" itemprop="url">SGAC v0.1
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-08-09T00:00:00+08:00">2021-08-09 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="how-it-begun">How it begun</h2>

<p>Last year I forked a stale community script for StorageGRID audit log analysis and made some improvements to it.</p>

<p>In my opinion it was useful and there have been a few downloads, but I don't know if anyone uses it.</p>

<p>What was useful about it? The reason I refreshed the script was a customer asked for a way to meter downloads and requests.</p>

<p>Because of that I kept the original destination format (CSV) and extracted showback/chargeback-related items.</p>

<p>Those could be loaded to a DB for simple reporting. For example, to show WAN-related egress (where client IPs are WAN IPs), we'd just look for requests where client IP wasn't from LAN (<code class="language-plaintext highlighter-rouge">%10.128.%</code>):</p>

<p><img src="/assets/images/sgac-storagegrid-usage-metering.png" alt="StorageGRID egress showback with SGAC" /></p>

<p>Some folks told me it's better to just send the log to Splunk or Elastic and let the user sort it out there. I still disagree with that.</p>

<p>That's not a solution, that's just exporting the logs. You still need someone to figure out what to query and how, and maybe don't even have Elastic (let alone Splunk).</p>

<p>Converting audit logs to CSV and importing them to RDMBS seems superior for cost and usage analysis because it:</p>

<ul>
  <li>it solves the problem (it doesn't just pass the bucket to another app)</li>
  <li>it does so in an easy to understand manner (run the script, import to an DB, run <em>this</em> query in order to get <em>this</em> result frm <em>these</em> columns)</li>
  <li>does it cost-effectively (above screenshot was taken from SQLite; the entire process of conversion and reporting can be run on a desktop or in a container)</li>
  <li>it didn't create and store junk (CSV data you didn't need) - you could retain those in original audit logs; [SGAC(CSV)] extracted only rows and fields required for its purpose</li>
</ul>

<p>A serverless way to use it was to upload original logs and SGAC output to a StorageGRID WORM bucket and run reports and queries from serverless containers. I know because I tested that with SGAC output converted to Parquet files uploaded to StorageGRID bucket.</p>

<p>What <em>didn't</em> work? Because [SGAC(CSV)] was initially focused on cost analysis (chargeback or showback), in order to extract what's necessary and leave out what's not I had to RTFM and figure out what each field was and build SQL queries. That was time-consuming and labor-intensive.</p>

<p>Because of that [SGAC(CSV)] wasn't capable of extracting <em>everything</em> and thanks to those limitations it couldn't be used for purposes unrelated to chargeback/showback. That older version can be found <a href="https://github.com/scaleoutsean/storagegrid-audit-analysis/blob/0de7882aa0a9a05b0bd8762b644705476be7bab5/sgac/sg_audit_csv_converter.py">here</a>.</p>

<p>After some thinking how to add additional features to [SGAC(CSV)], I decided to approach the problem differently.</p>

<h2 id="sgac-v01">SGAC v0.1</h2>

<p>I solved the features problem by employing the famous "pass the bucket" technique: I parse all audit log entries, convert each line of StorageGRID audit log to a JSON document and append it to a file. There are no features. The rest is up to the user.</p>

<p>There's no more "run the script with <code class="language-plaintext highlighter-rouge">--mode=showback</code>, import the resulting CSV file to RDBMS, and run <em>this</em> query". <del>Problem solved!</del> Bucket passed!</p>

<p>Because everything is converted to JSON, the resulting JSON file ends up being slightly larger than the audit log from which it was converted.</p>

<p>Which reminds me: in [SGAC(CSV)] I used to deliberately drop some "sensitive" fields, so that resulting CSV wouldn't need to be cleansed or masked for simple sharing around IT and Analytics teams purposes, but SGAC v0.1 converts everything so the user needs to think about dealing with PII and other potential challenges (in line with the new bucket-passing concept).</p>

<p>Like its predecessor, SGAC runs fast enough on modest hardware - 1.8 MB/s per CPU core. If you split the log in 8 chunks or run 8 uniprocessor containers or VMs against 8 logs, you could get 10 MB/s). That's why I haven't even tried to optimize it.</p>

<p>SGAC could be easily expanded to send data elsewhere (MongoDB, Elastic, etc.), so feel free to hack it if you want. Or reach out to NetApp Professional Services to do it for you.</p>

<p>Sample output:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"Timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-06-23T04:28:00.173006"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"RSLT"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCS"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"CNID"</span><span class="p">:</span><span class="w"> </span><span class="mi">1624422480164404</span><span class="p">,</span><span class="w">
  </span><span class="nl">"TIME"</span><span class="p">:</span><span class="w"> </span><span class="mi">2529</span><span class="p">,</span><span class="w">
  </span><span class="nl">"SAIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.128.59.192"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"TLIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.128.59.241"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"S3AI"</span><span class="p">:</span><span class="w"> </span><span class="mi">19663253853227287000</span><span class="p">,</span><span class="w">
  </span><span class="nl">"SACC"</span><span class="p">:</span><span class="w"> </span><span class="s2">"solidfire"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"S3AK"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SGKHulDF8HGK7Az_xR02pVQgooThBQ_rE9dmuuLsLg=="</span><span class="p">,</span><span class="w">
  </span><span class="nl">"SUSR"</span><span class="p">:</span><span class="w"> </span><span class="s2">"urn:sgws:identity::19663253853227287812:root"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"SBAI"</span><span class="p">:</span><span class="w"> </span><span class="mi">19663253853227287000</span><span class="p">,</span><span class="w">
  </span><span class="nl">"SBAC"</span><span class="p">:</span><span class="w"> </span><span class="s2">"solidfire"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"S3BK"</span><span class="p">:</span><span class="w"> </span><span class="s2">"local"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"S3SR"</span><span class="p">:</span><span class="w"> </span><span class="s2">"policy"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"AVER"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ATIM"</span><span class="p">:</span><span class="w"> </span><span class="mi">1624422480173006</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ATYP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SGET"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ANID"</span><span class="p">:</span><span class="w"> </span><span class="mi">12470893</span><span class="p">,</span><span class="w">
  </span><span class="nl">"AMID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"S3RQ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ATID"</span><span class="p">:</span><span class="w"> </span><span class="mi">7642530268470403000</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Because there's no more analysis and no more CSV, I no longer call it StorageGRID Audit Analysis (I haven't renamed the Github repo) or [SAGC(CSV)]. Now I just call it StorageGRID Audit log Converter, SGAC.</p>

<p>SGAC v0.1 can be found <a href="https://github.com/scaleoutsean/storagegrid-audit-analysis/releases/tag/v0.1">here</a>.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/audit" class="page__taxonomy-item p-category" rel="tag">audit</a><span class="sep">, </span>
    
      <a href="/tags/log" class="page__taxonomy-item p-category" rel="tag">log</a><span class="sep">, </span>
    
      <a href="/tags/netapp" class="page__taxonomy-item p-category" rel="tag">netapp</a><span class="sep">, </span>
    
      <a href="/tags/python" class="page__taxonomy-item p-category" rel="tag">python</a><span class="sep">, </span>
    
      <a href="/tags/s3" class="page__taxonomy-item p-category" rel="tag">s3</a><span class="sep">, </span>
    
      <a href="/tags/storagegrid" class="page__taxonomy-item p-category" rel="tag">storagegrid</a><span class="sep">, </span>
    
      <a href="/tags/visualization" class="page__taxonomy-item p-category" rel="tag">visualization</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/projects" class="page__taxonomy-item p-category" rel="tag">projects</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2021-08-09T00:00:00+08:00">2021-08-09 00:00</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?via=scaleoutSean&text=SGAC+v0.1%20https%3A%2F%2Fscaleoutsean.github.io%2F2021%2F08%2F09%2Fsgac-storagegrid-audit-log-converter-v0.1.html" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://scaleoutsean.github.io/2021/08/09/sgac-storagegrid-audit-log-converter-v0.1.html" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>

</section>


      
  <nav class="pagination">
    
      <a href="/2021/07/31/netapp-trident-v21.07.html" class="pagination--pager" title="GA of NetApp Trident v21.07">Previous</a>
    
    
      <a href="/2021/08/13/solidfire-snmp-v3-grafana.html" class="pagination--pager" title="SolidFire SNMP v3, Telegraf, Prometheus, Grafana">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/11/epa-4-beta.html" rel="permalink">E-Series Performance Analyzer (EPA) v4 beta
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-11T00:00:00+08:00">2025-08-11 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Introduction
  EPA 4
  EPA Collector-specific
  Details related to storage requirements
  What's next

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/11/bing-index-issue.html" rel="permalink">Got binged in July 2025
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-11T00:00:00+08:00">2025-08-11 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I don't track users (see Privacy page), don't have ads and don't care about "likes" or "followers", but generally I want my content to be in search engine in...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/07/30/solidfire-windows-admin-center-extension.html" rel="permalink">SolidFire Extension for Windows Admin Center 2025
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-07-30T00:00:00+08:00">2025-07-30 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          19 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Introduction
  Walk-through
  And now…
  Conclusion
  Appendix A: demo
    
      Animated GIF (no playback control)
      Video demo with voice-over
    ...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/07/26/solidfire-windows-admin-center-gateway.html" rel="permalink">SolidFire Gateway for Windows Admin Center 2025
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-07-26T00:00:00+08:00">2025-07-26 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Introduction
  What it is
  What it does
  IIS Setup
  Why this matters
  What about it?
  Conclusion

</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2020-2025 scaleoutSean.github.io | <a href="https://scaleoutsean.github.io">Acting Technologist</a> | Terms: <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank">CC BY 4.0</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
