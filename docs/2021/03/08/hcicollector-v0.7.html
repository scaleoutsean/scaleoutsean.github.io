<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8">
    <meta http-equiv="content-language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="googlebot" content="noarchive">
    <meta name="googlebot" content="max-snippet:60">
    <meta name="googlebot" content="max-image-preview:small">
    <meta name="bingbot" content="noarchive">
    <meta name="bingbot" content="max-snippet:60">
    <meta name="bingbot" content="max-image-preview:small">
    <meta name="robots" content="noarchive">
    <meta name="robots" content="max-snippet:60">
    <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />
    <title>
        
            Announcing HCICollector v0.7 | Acting Technologist
      
    </title>
    <meta name="description" content="
     Announcing HCICollector v0.7
     ">

    <!-- LINK TO ATOM FEED FOR SEO -->
    <link rel="alternate" type="application/atom+xml" href="https://scaleoutsean.github.io/feed.xml" />

    <!-- FAVICON -->
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

    <link href="/_pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script>
    <div id="search"></div>
    <script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ element: "#search" });
        });
    </script>

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Announcing HCICollector v0.7 | Acting Technologist</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Announcing HCICollector v0.7" />
<meta name="author" content="scaleoutSean" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Announcing HCICollector v0.7" />
<meta property="og:description" content="Announcing HCICollector v0.7" />
<link rel="canonical" href="https://scaleoutsean.github.io/2021/03/08/hcicollector-v0.7.html" />
<meta property="og:url" content="https://scaleoutsean.github.io/2021/03/08/hcicollector-v0.7.html" />
<meta property="og:site_name" content="Acting Technologist" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-08T00:00:00+08:00" />
<script type="application/ld+json">
{"headline":"Announcing HCICollector v0.7","dateModified":"2021-03-08T00:00:00+08:00","datePublished":"2021-03-08T00:00:00+08:00","author":{"@type":"Person","name":"scaleoutSean"},"@type":"BlogPosting","url":"https://scaleoutsean.github.io/2021/03/08/hcicollector-v0.7.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://scaleoutsean.github.io/2021/03/08/hcicollector-v0.7.html"},"description":"Announcing HCICollector v0.7","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

<body>

  <div class="container">
    <header id="header">
	<div id = site_title>
		<a href="https://scaleoutsean.github.io/">
			<h2 style="font-size:1.8em;">Acting Technologist</h2>
		</a>
		
		<h3>
			civilizations are created by individuals
		</h3>
		
	</div>

	<div id="subheader">
		
		<nav class="pages">
<a href="/about.html">About</a>

<a href="/archive.html">Archive</a>

<a href="/categories/">Categories</a>

<a href="/projects.html">Projects</a>
</nav>
		
		
		<nav class="social">
			
  
    <a href="https://www.github.com/scaleoutsean" target="_blank" id="github"><i class="fab fa-github" aria-hidden="true"></i></a>
  
   

  
    <a href="https://twitter.com/scaleoutsean" target="_blank" id="twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a>
  
   

  
  
    <a href="/feed.xml" target="_blank" id="rss"><i class="fas fa-rss" aria-hidden="true"></i></a>
   

		</nav>
		
	</div>
</header>


    <div class="post-container">
      <article id = "post">
        <h1 id = "post-title">Announcing HCICollector v0.7</h1>

  
  <div class = "post-info">
    <span>
        <i class="far fa-calendar" aria-hidden="true"></i> <span>08 Mar 2021</span> - <i class="far fa-clock"></i> 


  
  
    7 minute read
  

    </span>
  </div>
  
        <ul>
  <li><a href="#whats-new-in-hcicollector-v07">What’s new in HCICollector v0.7</a></li>
  <li><a href="#improvements">Improvements</a></li>
  <li><a href="#setbacks">Setbacks</a></li>
  <li><a href="#whats-next-for-hcicollector">What’s next for HCICollector</a>
    <ul>
      <li><a href="#unsolvable">Unsolvable</a></li>
      <li><a href="#netapp-trident">NetApp Trident</a></li>
    </ul>
  </li>
  <li><a href="#download-hcicollector">Download HCICollector</a></li>
</ul>

<h2 id="whats-new-in-hcicollector-v07">What’s new in HCICollector v0.7</h2>

<ul>
  <li>Updates: base images, SolidFire SDK, Grafana, and more</li>
  <li>sfcollector: this is the Python script that takes care of SolidFire-related metrics. Updated SolidFire SDK for Python which supports latest and greatest NetApp SolidFire 12 (which means storage QoS histograms and other features that appeared in 11 and 12.0)</li>
  <li>Dashboards: many small fixes and improvements</li>
  <li>Other: works with VMware vSphere 7.0 (and vSphere 7.0U1), improved documentation</li>
</ul>

<h2 id="improvements">Improvements</h2>

<p>I addressed 10% of items from my wish list. Not everything is visible in the Web UI (or even sfcollector) because before I created that wish list I had to evaluate several approaches for each objective.</p>

<p>Here are some examples of what’s visible:</p>

<p><img src="/assets/images/hcicollector-v0.7.png" alt="Main HCICollector dashboards" /></p>

<p>(1) Add clock. It bothered me that HCICollector screenshots didn’t have time on them. Now only the “main” SolidFire cluster dashboard has it, but it’s easy to add it elsewhere, make it bigger or smaller.</p>

<p>(2) Add links to the SolidFire UI. While there’s no point in duplicating (especially for a one-man hobbyist such as myself) existing features from the SolidFire UI, <em>finding</em> the corresponding Grafana page in the SolidFire UI takes a lot of clicks.</p>

<p>It doesn’t take a lot of time to find the Volumes tab in the SolidFire UI, but it takes a lot of time to find Warnings, or Volumes for User ID 57, for example (because we may need need to use the filter feature). Second, some important features that the SolidFire API has are not available in the SolidFire UI (it runs on storage nodes, after all) and that was addressed in (4), below.</p>

<p>(3) Tighten the formula for Storage Efficiency. Broadly speaking efficiency includes Thin Provisioning (Compression x Deduplication x Thin Provisioning). But that presents challenges when we want to find the wasters: misplaced data (say someone stores 1 TB of images on a 16 TB SolidFire volume) would result in a high (16x) efficiency thanks to Thin Provisioning and that broad definition.</p>

<p>Now there’s Efficiency Factor (Compression x Deduplication) and Thin Provisioning is separate, which results in an Efficiency Factor of 1x for the guy who saved 1TB of images on a SolidFire volume. We an easily find such volumes and also list storage user accounts with a low efficiency (by default, less than 2x).</p>

<p>(4) Expose more SolidFire API features in HCICollector. This is related to the fact that the SolidFire API provides some very good information about both the hardware and services, but it wasn’t available in HCICollector (maybe it wasn’t implemented, or has appeared in API version 11 or 12).</p>

<p>Thanks to the changes in <code class="language-plaintext highlighter-rouge">sfcollector</code>, new SolidFire SDK for Python and new dashboards panels, Operations folks can now easily expose some of that information in HCICollector or their own Grafana. To wit:</p>

<p><img src="/assets/images/hcicollector-v0.7-cluster-drive-view.png" alt="HCICollector Disk Drive and Wear Level dashboard" /></p>

<p>These are not the only such changes. HCICollector also gathers and exposes storage QoS histogram stats (see this short <a href="https://www.youtube.com/watch?v=9vW-PozlIUk">video demo</a>).</p>

<h2 id="setbacks">Setbacks</h2>

<p>The first one is related to ID vs Name dilemma. In dashboards I semi-abandoned the misleading Names and in the process introduced the hard-to use IDs. But potentially misleading is worse than hard-to-use, in my opinion, and could potentially be seen as an improvement. More on that under “Unsolvable” (below).</p>

<p>The second is: more data means more problems. Thanks to these changes, HCICollector v0.7 gathers more data than the previous version, so I had to trim some retention settings. But at least that’s easy to customize so I hope the improvements outnumber annoyances.</p>

<h2 id="whats-next-for-hcicollector">What’s next for HCICollector</h2>

<p>HCICollector v0.7 beta 1 came out in January 2020 and <a href="https://github.com/scaleoutsean/hcicollector/blob/v0.7-beta.1/FAQ.md#what-is-the-reason-trident-was-removed-from-hcicollector">at the time</a> I mentioned my primary goal was to “make it easier to install and use SolidFire collector with existing monitoring infrastructure”.</p>

<p>I didn’t get much feedback regarding that, but it appears that broadly speaking there are two groups of users:</p>

<ul>
  <li>People who use <code class="language-plaintext highlighter-rouge">sfcollector</code> to feed SolidFire metrics to their monitoring infrastructure where they visualize and analyze it based on own requirements. They don’t care about dashboards, automated installation, and already have own solutions for the rest (VMware and networking). They just want <code class="language-plaintext highlighter-rouge">sfcollector</code> to work.
    <ul>
      <li>Kubernetes users who run monitoring in Kubernetes</li>
      <li>Operations folks who run monitoring in VMs and don’t have Kubernetes</li>
    </ul>
  </li>
  <li>People who use HCICollector, usually NetApp HCI users or various smaller sites which do not have existing Grafana (or ELK, or Splunk) and want something simple that works</li>
</ul>

<p>I had investigated InfluxDB for HCICollector v0.7 and decided against it because it meant more work, I didn’t like its syntax (SQL), and I discovered the excellent <a href="https://github.com/mjavier2k/solidfire-exporter">solidfire-exporter</a> which took care of this problem.</p>

<p>Considering my limited resources, the ubiquity of Kubernetes, and the release of SolidFire eSDS (that is SolidFire software for 3rd party storage nodes), the following approach seems reasonable going forward:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Solution</th>
      <th style="text-align: center">Use case</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><a href="https://github.com/mjavier2k/solidfire-exporter">solidfire-exporter</a></td>
      <td style="text-align: center">Kubernetes users</td>
    </tr>
    <tr>
      <td style="text-align: center">sfcollector</td>
      <td style="text-align: center">Enterprise Operations users</td>
    </tr>
  </tbody>
</table>

<p>This would allow me to spend more time on <code class="language-plaintext highlighter-rouge">sfcollector</code>, the SolidFire API and the intersection of logging and monitoring (more on that under “Unsolvable”), and less on VMware and hardware.</p>

<p>Some ideas for <code class="language-plaintext highlighter-rouge">sfcollector</code> v0.8:</p>

<ul>
  <li>Move from Graphite to another back-end (not InfluxDB) or add support two-three popular back-ends</li>
  <li>For that, I’d have to rewrite <code class="language-plaintext highlighter-rouge">sfcollector</code> and recreate all dashboards. But it’s also an opportunity to move to Grafana 7 (which I tested and found to work as far as SolidFire is concerned, but HCICollector v0.7 doesn’t use it because VMware dashboards would need fixing) and make more visually appealing Grafana dashboards</li>
  <li>Create and maintain just one container image (sfcollector) and reference dashboards for Grafana 7</li>
</ul>

<h3 id="unsolvable">Unsolvable</h3>

<p>One challenge and a top annoyance that I briefly <a href="https://github.com/scaleoutsean/solidifire">looked into</a> last year is the need to keep record of Name-to-ID mappings for objects like Volumes and Accounts.</p>

<p>As explained in that repository and HCICollector v0.7 CHANGELOG, SolidFire volume names don’t have to be unique which makes sense (especially now that more people use Kubernetes and realize they can’t decide volume names), but it also means that names can be duplicate (Volume ID 5 and 7 both can be named “dbvol”, rendering Name-based Grafana visualizations useless). Kubernetes won’t do that to you, but people will.</p>

<p>Additionally, Names can be changed (Vol ID 5 can be named “dbvol” today and “datavol” tomorrow). Kubernetes also won’t do that to you, but people will (even in a Kubernetes environment, if you clone and import a Trident volume you can end up with a duplicate volume name).</p>

<p>What I wanted to do in the <code class="language-plaintext highlighter-rouge">solidifire</code> repository is create a database that maps Account and Volume IDs to Names, so that we can look up a Volume or Account Name based on its ID at the specific time. It’d also help us track name changes as well as CRUD events on these objects.</p>

<p>With that we could show Volumes and Accounts by names, rather than by IDs (HCICollector v0.7). But then I realized it’d be a lot of work (another container, another database, more work to make use of it in Grafana 6…) and at the same time I wasn’t even sure if anyone cared.</p>

<p>I’m not sure if this should be filed under “unsolvable”, “needs no solution”, or even “solved”. Enterprise folks who forward SolidFire logs to Elastic, Splunk, or Graylog have this problem solved for them and would maybe prefer to send <code class="language-plaintext highlighter-rouge">sfcollector</code> metrics to the same platform. But I don’t consider it fully solved because <code class="language-plaintext highlighter-rouge">sfcollector</code> currently can send metrics only to Graphite and forwarding and keeping all SolidFire logs for months or years is expensive (maybe 100 GB per month?).</p>

<p>This could be improved by supporting these back-ends from <code class="language-plaintext highlighter-rouge">sfcollector</code> and having a syslog filter recipe to strip out non-essential data from the SolidFire logs (and someone would have to do that work). As far as simple log forwarding is concerned, that’s the easy “Part 1” (three short video demos created while I was researching this topic):</p>

<ul>
  <li><a href="https://www.youtube.com/watch?v=scRJePcTp2k">Splunk</a></li>
  <li><a href="https://www.youtube.com/watch?v=lgCn3D010fY">Elastic</a></li>
  <li><a href="https://www.youtube.com/watch?v=S0kOwhGfeTA">Graylog</a></li>
</ul>

<h3 id="netapp-trident">NetApp Trident</h3>

<p>Since last year Trident exports its metrics. The number of SolidFire-related metrics is small, but they’re available and only need to be visualized.</p>

<p><code class="language-plaintext highlighter-rouge">solidfire-exporter</code> personas will no doubt create their own Trident metrics visualizations, but Operations folks not used to creating own dashboards may benefit from being able to see those in HCICollector.</p>

<h2 id="download-hcicollector">Download HCICollector</h2>

<p>Download HCICollector v0.7: <a href="https://github.com/scaleoutsean/hcicollector/releases/tag/v0.7">https://github.com/scaleoutsean/hcicollector/releases/tag/v0.7</a>.</p>

      </article>
    </div>
    
      <div class="categories">
    <span><p>Categories:</p>
    
    
      <a href="
      /categories/#projects">projects</a>
      &nbsp; 
    
      <a href="
      /categories/#solidfire">solidfire</a>
       
    
  </span>
</div>
    

  
    <div>
      <h3>Related Posts</h3>
      <ul>
      
        <li><a href="/2021/03/24/netapp-hci-compute-node-local-hardware-monitoring.html">Hardware monitoring of NetApp HCI compute nodes for dark sites</a></li>
      
        <li><a href="/2021/03/09/get-started-with-solidfire-exporter.html">Get started with solidfire-exporter</a></li>
      
        <li><a href="/2020/12/08/get-bearer-token-for-netapp-hci-hybrid-cloud-control-logs.html">Get NetApp Hybrid Cloud Control logs via the HCC API</a></li>
      
        <li><a href="/2024/05/29/sfc-v2.html">SolidFire Collector v2.0.0 is ready</a></li>
      
        <li><a href="/2021/01/15/netapp-hci-storagegrid-splunk-smartstore-on-efseries.html">Virtualized StorageGRID for Splunk Smartstore on NetApp HCI and EF-Series array</a></li>
      
      </ul>
    </div>
  

    
  </div><footer class= "footer">
    <p>2024-08-04 13:23 </p>
    <p>Copyright © 2024 scaleoutSean. Content is released under the CC BY license. Design: Alessio Franceschi</p>
</footer>

</body>
</html>
