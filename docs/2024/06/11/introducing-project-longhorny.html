<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Project Longhorny | Acting Technologist</title>
<meta name="description" content="Manage SolidFire cluster pairs and volume replication from the CLI">


  <meta name="author" content="scaleoutSean">
  
  <meta property="article:author" content="scaleoutSean">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Acting Technologist">
<meta property="og:title" content="Project Longhorny">
<meta property="og:url" content="https://scaleoutsean.github.io/2024/06/11/introducing-project-longhorny.html">


  <meta property="og:description" content="Manage SolidFire cluster pairs and volume replication from the CLI">





  <meta name="twitter:site" content="@scaleoutSean">
  <meta name="twitter:title" content="Project Longhorny">
  <meta name="twitter:description" content="Manage SolidFire cluster pairs and volume replication from the CLI">
  <meta name="twitter:url" content="https://scaleoutsean.github.io/2024/06/11/introducing-project-longhorny.html">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2024-06-11T00:00:00+08:00">






<link rel="canonical" href="https://scaleoutsean.github.io/2024/06/11/introducing-project-longhorny.html">







  <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />


  <meta name="msvalidate.01" content="7cf5b7d96a77410a8ad035f764dc81b3">





<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Acting Technologist Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic" rel="stylesheet" type="text/css">


  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Acting Technologist
          <span class="site-subtitle">human action through technology</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/archive/"
                
                
              >Archive</a>
            </li><li class="masthead__menu-item">
              <a
                href="/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/projects/"
                
                
              >Projects</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://scaleoutsean.github.io/" itemprop="url">scaleoutSean</a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Project Longhorny">
    <meta itemprop="description" content="  Introduction  What exactly does Longhorny do?  Longhorny walk-through  Site-level actions  Conclusion  Demo">
    <meta itemprop="datePublished" content="2024-06-11T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://scaleoutsean.github.io/2024/06/11/introducing-project-longhorny.html" itemprop="url">Project Longhorny
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2024-06-11T00:00:00+08:00">2024-06-11 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#what-exactly-does-longhorny-do">What exactly does Longhorny do?</a></li>
  <li><a href="#longhorny-walk-through">Longhorny walk-through</a></li>
  <li><a href="#site-level-actions">Site-level actions</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
  <li><a href="#demo">Demo</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>An introduction has already been written in <a href="/2024/06/01/pvc-volume-relationships-in-solidfire-trident-part-1.html">Kubernetes, Trident and SolidFire configuration visibility</a>, where I said a tool for managing replication relationships was one of my use cases motivated by the recent progress of scripting/automating Kubernetes-to-SolidFire volume mapping.</p>

<p>It all started after I recently finished <a href="/2024/05/29/sfc-v2.html">SFC v2</a> and thought about two things:</p>

<ul>
  <li>it'd be nice to be able to monitor SolidFire replication, which is no tool - apart from SolidFire UI - currently offers. We'd only need to "list" replication relationships and send them to database as we do for all other things in SFC</li>
  <li>it'd be also nice to monitor Trident volumes and their attributes</li>
</ul>

<p>Then I revisited Trident-to-SolidFire mapping (link at the top) and after that the next logical step was to make it easier to use information from Trident to set up replication on SolidFire.</p>

<p>At first, all I wanted was <code class="language-plaintext highlighter-rouge">list</code> and <code class="language-plaintext highlighter-rouge">pair</code>, to list paired clusters and volumes, and be able to add (<code class="language-plaintext highlighter-rouge">pair</code>) volumes from (say) Trident on your production site. But then I got carried away and added more stuff. Eventually I though it should be posted to <a href="https://github.com/scaleoutsean/longhorny">its own repository</a> rather than to the usual place (the scripts folder in Awesome SolidFire repo). Which has been done today.</p>

<h2 id="what-exactly-does-longhorny-do">What exactly does Longhorny do?</h2>

<p>Longhorny is well-documented, so you can read all about it in the repo. But briefly:</p>

<ul>
  <li>Pair two clusters for replication. Also list and unpair (if they have no paired volumes between them).</li>
  <li>Pair one or more volume pairs for replication. Also list and unpair (one pair at a time).</li>
  <li>Find mismatched volume pairs.</li>
  <li>Take a snapshot of all volumes at the source.</li>
  <li>Reverse replication direction for all paired volumes.</li>
  <li>Change replication mode for all or selected volumes (at the source).</li>
  <li>Prime the remote site using a list of volumes from the source site.</li>
</ul>

<p>First we use <code class="language-plaintext highlighter-rouge">cluster --pair</code> to pair two clusters.</p>

<p>Then we use <code class="language-plaintext highlighter-rouge">volume</code> actions (you may open in new tab to see it clearly):</p>

<p><img src="/assets/images/introducing-longhorny-volume-help-screenshot.png" alt="Longhorny's volume help" /></p>

<p>Normally <code class="language-plaintext highlighter-rouge">volume pair</code> would be the first action to use, but there are others.</p>

<p>Once I did <code class="language-plaintext highlighter-rouge">list</code> and <code class="language-plaintext highlighter-rouge">pair</code>, I thought I also needed <code class="language-plaintext highlighter-rouge">unpair</code>, then it ocurred to me I may as well do <code class="language-plaintext highlighter-rouge">reverse</code> for failback, <code class="language-plaintext highlighter-rouge">prime-dst</code> to save time, etc.</p>

<p><code class="language-plaintext highlighter-rouge">site</code>-related actions are just two and work-in-progress as I'm not sure if I really need them.</p>

<h2 id="longhorny-walk-through">Longhorny walk-through</h2>

<p>Let's see an example. Assume our production site has Hyper-V or something like that, owned by Account ID 13.</p>

<ul>
  <li>Cluster PROD
    <ul>
      <li>Account 13 has volumes 40, 41, 42</li>
    </ul>
  </li>
  <li>Cluster DR
    <ul>
      <li>(nothing)</li>
    </ul>
  </li>
</ul>

<p>Pair PROD with DR without providing the passwords (so that we get prompted to enter them):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py <span class="se">\</span>
  <span class="nt">--src</span> <span class="s2">"{ 'mvip': '192.168.1.30', 'username':'admin', 'password':''}"</span> <span class="se">\</span>
  <span class="nt">--dst</span> <span class="s2">"{ 'mvip': '192.168.105.32', 'username':'admin', 'password':''}"</span> <span class="se">\</span>
  cluster <span class="nt">--pair</span>
</code></pre></div></div>

<p>List clusters (below I remove <code class="language-plaintext highlighter-rouge">--src</code> and <code class="language-plaintext highlighter-rouge">--dst</code> to make it easier to follow):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py cluster <span class="nt">--list</span>
</code></pre></div></div>

<p>This shows the clusters have been paired, latency is 1ms (good for all modes) and they're connected. Exclusive 1-to-1 relationship is the only one supported, by the way. (People who have more clusters surely can write a Longhorny that works with several sites at a time.)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="sh">'</span><span class="s">PROD</span><span class="sh">'</span><span class="p">:</span> <span class="p">[{</span><span class="sh">'</span><span class="s">clusterName</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">DR</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">clusterPairID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">clusterPairUUID</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">b9322478-3779-4cd3-908f-2a48f22202fe</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">clusterUUID</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bgn0</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">latency</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">mvip</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">192.168.105.32</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Connected</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">version</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">12.5.0.897</span><span class="sh">'</span><span class="p">}],</span>
 <span class="sh">'</span><span class="s">DR</span><span class="sh">'</span><span class="p">:</span> <span class="p">[{</span><span class="sh">'</span><span class="s">clusterName</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">PROD</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">clusterPairID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">clusterPairUUID</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">b9322478-3779-4cd3-908f-2a48f22202fe</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">clusterUUID</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">wcwb</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">latency</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">mvip</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">192.168.1.30</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Connected</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">version</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">12.5.0.897</span><span class="sh">'</span><span class="p">}]}</span>
</code></pre></div></div>

<p>All right, that's good. The next step is to create an account and volumes on the remote site. You may create them manually and set them to <code class="language-plaintext highlighter-rouge">replicationTarget</code> mode and then <code class="language-plaintext highlighter-rouge">--pair</code> them.</p>

<p>On the <strong>remote</strong> site cluster we created account ID 3 and one volume with the same properties (size, etc.) as volume 40 from the <strong>source</strong> site. Its volume ID is 5.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py volume <span class="nt">--pair</span> <span class="nt">--data</span> <span class="s2">"40,5"</span>
</code></pre></div></div>

<p>That pairs volume ID 40 from the source cluster with volume ID 5 on the destination cluster. SolidFire sets up pairing in Async replication mode by default. Output from: <code class="language-plaintext highlighter-rouge">volume --list</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="sh">'</span><span class="s">clusterPairID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">localVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">localVolumeName</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">test</span><span class="sh">'</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">remoteVolumeName</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">testr</span><span class="sh">'</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">remoteReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Async</span><span class="sh">'</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">remoteReplicationPauseLimit</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3145728000</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">remoteReplicationStateSnapshots</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">PausedDisconnected</span><span class="sh">'</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">remoteReplicationState</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">PausedDisconnected</span><span class="sh">'</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">remoteVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="sh">'</span><span class="s">volumePairUUID</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">44df1d5e-8694-4ed1-bdaf-fa773fb9b165</span><span class="sh">'</span><span class="p">}]</span>
</code></pre></div></div>

<p>It may take a few minutes for the volumes to sync, depending on network bandwidth and volume data size.</p>

<p>For the other two source volumes (41, 42), we can try <code class="language-plaintext highlighter-rouge">--prime-dst</code>. When we use <code class="language-plaintext highlighter-rouge">--prime-dst</code>, the first <code class="language-plaintext highlighter-rouge">DATA</code> element is account IDs (from the source <em>and</em> destination) and the second is list of volume IDs from the source that we want to create replication targets for.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py volume <span class="nt">--prime-dst</span> <span class="nt">--data</span> <span class="s2">"13,3;41,42"</span>
</code></pre></div></div>

<p>This takes the properties of volume IDs 41 and 42 that belong to account ID 13 and creates "the same" at the remote site with the remote account ID 3 as their owner. Let's say these new, remote volumes have IDs 6, 7.</p>

<p>They have the same properties as 41, 42 from the source, including name and priming changes the new volumes to replicationTarget mode, so our task is now very easy - we just need to pair them.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py volume <span class="nt">--pair</span> <span class="nt">--data</span> <span class="s2">"41,6;42,7"</span>
</code></pre></div></div>

<p>Now <code class="language-plaintext highlighter-rouge">volume --list</code> shows three volume pairs.</p>

<p>Let's say volumes 40 and 42 are less important apps and I would be content with SnapshotOnly replication mode. Let's do that!</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py volume <span class="nt">--set-mode</span> <span class="nt">--data</span> <span class="s2">"SnapshotsOnly;41,42"</span>
</code></pre></div></div>

<p>What if I need to failover to the remote site? There's <code class="language-plaintext highlighter-rouge">volume reverse</code>, but let's take a snapshot of the replicated volumes at the source site first, just in the case this DR test craps out.</p>

<p>The snapshots are taken individually, so if you have consistency groups, take those snapshots separately. Longhorny currently does not know what volume is or isn't in some logical grouping.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py volume <span class="nt">--snapshot</span> <span class="nt">--data</span> <span class="s2">"24;before-dr"</span>
</code></pre></div></div>

<p>Three local (not replicated) snapshots named "<code class="language-plaintext highlighter-rouge">before-dr</code>" have been created on the source and have a 24 hour retention. We can execute our DR test now.</p>

<p>Now we <strong>should stop all workloads</strong> that use paired volumes as we'll make the paired volumes on the source replication targets, which will deny access to iSCSI clients at the source site. At the remote site you also don't want to be having any workloads attempting to use the remote volumes (they can't be used yet, they're in replication target mode).</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py volume <span class="nt">--reverse</span>
</code></pre></div></div>

<p>This makes replicated volumes at the second site read-write. Now we can start using replica volumes at the remote site.</p>

<p>To fall back, stop remote workloads, <strong>wait until reverse replication is in sync</strong> and then run the same workflow again (maybe take a snapshot at the remote site before failback, too).</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~<span class="nv">$ </span>./longhorny.py volume <span class="nt">--reverse</span>
</code></pre></div></div>

<p>I mentioned that in the documentation but in the case you didn't notice, Longhorny doesn't have a super-pretty CLI output. That's on purpose.</p>

<p>Take an example of this "<code class="language-plaintext highlighter-rouge">volume --mismatched</code>" (finds "orphaned" paired volumes) output that you'd see if someone unilaterally removed 5,40 replication pair <strong>at the remote site</strong> (where that pair is 40,5). We could identify this quickly with three paired volumes on the source, but then what?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="sh">'</span><span class="s">PROD</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span><span class="sh">'</span><span class="s">volumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">volumePairUUID</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">44df1d5e-8694-4ed1-bdaf-fa773fb9b165</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">mismatchSite</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">DR</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">5</span><span class="p">}}]</span>
</code></pre></div></div>

<p>Longhorny outputs Python "sequences" to the shell so that you can take this output, paste it into your Python shell and do something with it.</p>

<p>All Longhorny output is like that - it's meant to be used elsewhere (send to SFC, send to Splunk, send to own script, etc.) and not something that merely lets you do in the CLI what you can already do in the Web UI.</p>

<h2 id="site-level-actions">Site-level actions</h2>

<p>I haven't used any site-level actions in this walk-through, so here are some quick notes on that:</p>

<ul>
  <li>As of now, Longhorny connects to both the source and destination, because usually it needs information on how each side views cluster and volume relationships.</li>
  <li>That means although I have some <code class="language-plaintext highlighter-rouge">site</code>-level actions, they can't really work if the other site is unreachable, which sometimes defeats the purpose.</li>
  <li>I could modify the code to ignore the unreachable site, but it's not that simple; we'd also have to have some idea on how to reconcile the relationships after that, etc.</li>
</ul>

<p>To make an example, I'll expand on something from the Longhorny README file, which is that Longhorny doesn't prevent you from setting up replication pairs for volumes that belong to multiple accounts on the same site. Maybe you have three Kubernetes clusters on site A, which means you need three storage accounts for Trident CSI on site A. Fair enough.</p>

<p>But we know what's coming next - now different accounts/cluster owners want, or don't want - to failover to site B. Some do, some don't. Now we need per-account "<code class="language-plaintext highlighter-rouge">volume --reverse</code>". Okay, let's add that feature (I haven't, though).</p>

<p>Then a site fails. "Okay, not a problem - I'll use a <code class="language-plaintext highlighter-rouge">site</code> action to override!"</p>

<p>Well, sure, but now you may have a mess at your hands, especially if said Kubernetes admins are allowed to use Longhorny on their own. Some volumes are read-write on both sites, some on a site where a site-action was used to severe relationships and promote the site to read-write, some are read-only (replicationTarget mode) on both sites and no one remembers what exactly they did, there are no pre- or post-failover snapshots, etc. Mr. Storage Admin, can you figure it out for us?</p>

<p>I recognize the need for more features, but I think this is where things can get very complicated. At this moment site-level features are limited and as I don't really want to make them completely useful for the situations where a site is down or unreachable.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Longhorny isn't perfect and I could have done it better, but it's decent enough. I wrote it after I finished SFC v2 early this month - in fact I started writing it before I pushed the SFC v2 to Github (I haven't done that yet, but that's next).</p>

<p>Longhorny doesn't do anything you can't do by yourself in the SolidFire Web UI, except that it can take input from, and send output to, other programs. Which is the main thing about it.</p>

<p>It's usable and serves as reference to myself as I now have code to gather replication relationship information with SFC. I - and anybody who wants, really - also have a way to connect Trident configuration with SolidFire configuration, so that we can have a decently automated site failover for Kubernetes with SolidFire.</p>

<p>As I mentioned in <a href="/2024/06/03/pvc-volume-relationships-in-solidfire-trident-part-2.html">part 2 of the Kubernetes, Trident and SolidFire</a> series, there are some other scenarios where the Longhorny code will be useful.</p>

<p>In terms of programming languages, I'm a beginner, but I think it would have been easier and nicer to do Longhorny in PowerShell. But I almost had no choice but to do it in Python, considering that SFC is in Python and other integration (Trident, etc.) works better with Python. Before I wrote (didn't publish the code) a PowerShell wrapper for <code class="language-plaintext highlighter-rouge">kubectl</code> and it worked great, but with Python I and others don't need a wrapper there's a native Python client. So I think Python is the right choice, although not the best tool for this particular purpose.</p>

<h2 id="demo">Demo</h2>

<ul>
  <li><a href="https://rumble.com/v513r8w-project-longhorny.html">Project Longhorny</a> - 5m11s</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/api" class="page__taxonomy-item p-category" rel="tag">api</a><span class="sep">, </span>
    
      <a href="/tags/automation" class="page__taxonomy-item p-category" rel="tag">automation</a><span class="sep">, </span>
    
      <a href="/tags/replication" class="page__taxonomy-item p-category" rel="tag">replication</a><span class="sep">, </span>
    
      <a href="/tags/storage" class="page__taxonomy-item p-category" rel="tag">storage</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/projects" class="page__taxonomy-item p-category" rel="tag">projects</a><span class="sep">, </span>
    
      <a href="/categories/solidfire" class="page__taxonomy-item p-category" rel="tag">solidfire</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2024-06-11T00:00:00+08:00">2024-06-11 00:00</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?via=scaleoutSean&text=Project+Longhorny%20https%3A%2F%2Fscaleoutsean.github.io%2F2024%2F06%2F11%2Fintroducing-project-longhorny.html" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://scaleoutsean.github.io/2024/06/11/introducing-project-longhorny.html" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>

</section>


      
  <nav class="pagination">
    
      <a href="/2024/06/03/pvc-volume-relationships-in-solidfire-trident-part-2.html" class="pagination--pager" title="Kubernetes, Trident and SolidFire configuration - part 2">Previous</a>
    
    
      <a href="/2024/06/12/longhorny-cluster-volume-replication-report.html" class="pagination--pager" title="Reporting SolidFire cluster and volume pairing relationships">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/11/epa-4-beta.html" rel="permalink">E-Series Performance Analyzer (EPA) v4 beta
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-11T00:00:00+08:00">2025-08-11 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Introduction
  EPA 4
  EPA Collector-specific
  Details related to storage requirements
  What's next

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/11/bing-index-issue.html" rel="permalink">Got binged in July 2025
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-11T00:00:00+08:00">2025-08-11 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I don't track users (see Privacy page), don't have ads and don't care about "likes" or "followers", but generally I want my content to be in search engine in...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/07/30/solidfire-windows-admin-center-extension.html" rel="permalink">SolidFire Extension for Windows Admin Center 2025
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-07-30T00:00:00+08:00">2025-07-30 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          19 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Introduction
  Walk-through
  And nowâ€¦
  Conclusion
  Appendix A: demo
    
      Animated GIF (no playback control)
      Video demo with voice-over
    ...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/07/26/solidfire-windows-admin-center-gateway.html" rel="permalink">SolidFire Gateway for Windows Admin Center 2025
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-07-26T00:00:00+08:00">2025-07-26 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Introduction
  What it is
  What it does
  IIS Setup
  Why this matters
  What about it?
  Conclusion

</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2020-2025 scaleoutSean.github.io | <a href="https://scaleoutsean.github.io">Acting Technologist</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
