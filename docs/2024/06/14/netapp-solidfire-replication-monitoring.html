<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8">
    <meta http-equiv="content-language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="googlebot" content="noarchive">
    <meta name="googlebot" content="max-snippet:60">
    <meta name="googlebot" content="max-image-preview:small">
    <meta name="bingbot" content="noarchive">
    <meta name="bingbot" content="max-snippet:60">
    <meta name="bingbot" content="max-image-preview:small">
    <meta name="robots" content="noarchive">
    <meta name="robots" content="max-snippet:60">
    <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />
    <meta name="msvalidate.01" content="6FD3BAB558A4E2BB332C9D713233A925" />
    <title>
        
            Monitoring volume replication in NetApp SolidFire | Acting Technologist
      
    </title>
    <meta name="description" content="
     Monitor initial copy and ongoing replication on SolidFire
     ">

    <!-- LINK TO ATOM FEED FOR SEO -->
    <link rel="alternate" type="application/atom+xml" href="https://scaleoutsean.github.io/feed.xml" />

    <!-- FAVICON -->
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

    <link href="/_pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script>
    <div id="search"></div>
    <script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ element: "#search" });
        });
    </script>

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Monitoring volume replication in NetApp SolidFire | Acting Technologist</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Monitoring volume replication in NetApp SolidFire" />
<meta name="author" content="scaleoutSean" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Monitor initial copy and ongoing replication on SolidFire" />
<meta property="og:description" content="Monitor initial copy and ongoing replication on SolidFire" />
<link rel="canonical" href="https://scaleoutsean.github.io/2024/06/14/netapp-solidfire-replication-monitoring.html" />
<meta property="og:url" content="https://scaleoutsean.github.io/2024/06/14/netapp-solidfire-replication-monitoring.html" />
<meta property="og:site_name" content="Acting Technologist" />
<meta property="og:image" content="https://scaleoutsean.github.io/assets/images/solidfire-replication-monitoring-01-setup.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-14T00:00:00+08:00" />
<script type="application/ld+json">
{"image":"https://scaleoutsean.github.io/assets/images/solidfire-replication-monitoring-01-setup.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://scaleoutsean.github.io/2024/06/14/netapp-solidfire-replication-monitoring.html"},"author":{"@type":"Person","name":"scaleoutSean"},"description":"Monitor initial copy and ongoing replication on SolidFire","@type":"BlogPosting","url":"https://scaleoutsean.github.io/2024/06/14/netapp-solidfire-replication-monitoring.html","headline":"Monitoring volume replication in NetApp SolidFire","dateModified":"2024-06-14T00:00:00+08:00","datePublished":"2024-06-14T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

<body>

  <div class="container">
    <header id="header">
	<div id = site_title>
		<a href="https://scaleoutsean.github.io/">
			<h2 style="font-size:1.8em;">Acting Technologist</h2>
		</a>
		
		<h3>
			civilizations are created by individuals
		</h3>
		
	</div>

	<div id="subheader">
		
		<nav class="pages">
<a href="/about.html">About</a>

<a href="/archive.html">Archive</a>

<a href="/categories/">Categories</a>

<a href="/projects.html">Projects</a>
</nav>
		
		
		<nav class="social">
			
  
    <a href="https://www.github.com/scaleoutsean" target="_blank" id="github"><i class="fab fa-github" aria-hidden="true"></i></a>
  
   

  
    <a href="https://twitter.com/scaleoutsean" target="_blank" id="twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a>
  
   

  
  
    <a href="/feed.xml" target="_blank" id="rss"><i class="fas fa-rss" aria-hidden="true"></i></a>
   

		</nav>
		
	</div>
</header>


    <div class="post-container">
      <article id = "post">
        <h1 id = "post-title">Monitoring volume replication in NetApp SolidFire</h1>

  
  <div class = "post-info">
    <span>
        <i class="far fa-calendar" aria-hidden="true"></i> <span>14 Jun 2024</span> - <i class="far fa-clock"></i> 


  
  
    13 minute read
  

    </span>
  </div>
  
        <ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#solidfire-volume-replication">SolidFire volume replication</a></li>
  <li><a href="#failed-and-not-so-successful-approaches">Failed and not-so-successful approaches</a>
    <ul>
      <li><a href="#write-workload-at-destination">Write workload at destination</a></li>
      <li><a href="#node-throughput">Node throughput</a></li>
    </ul>
  </li>
  <li><a href="#good-approaches">Good approaches</a>
    <ul>
      <li><a href="#sync-jobs-at-destination">Sync jobs at destination</a></li>
      <li><a href="#volumes-statistics-at-source">Volume’s statistics at source</a></li>
    </ul>
  </li>
  <li><a href="#what-else">What else?</a></li>
  <li><a href="#all-together-now">All together now!</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
  <li><a href="#appendix-a---replication-metrics-in-sfc">Appendix A - replication metrics in SFC</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>Few weeks ago I saw a question about resolving volume pairing problems and monitoring volume replication on SolidFire, which is why I restarted work on these things.</p>

<p>The first step was <a href="/2024/06/11/introducing-project-longhorny.html">Project Longhorny</a>, released a few days ago, which covers essential replication operations such as pair, list and even reverse (change of replication direction).</p>

<p>The second part of the question is about monitoring of replication. This post will be about that.</p>

<p>The third part - not part of <em>this question</em>, but it’s a good question - is about making non-vSphere applications work with SolidFire failover. (For vSphere it was addressed with SolidFire’s SRA.) I’ve started working <a href="/2024/06/03/pvc-volume-relationships-in-solidfire-trident-part-2.html">on this</a> as well. With Longhorny in place, I can do some more work in this area.</p>

<p>Back to the question of monitoring the speed of initial copying and volume pairing status after that is complete.</p>

<h2 id="solidfire-volume-replication">SolidFire volume replication</h2>

<p>I suppose most SolidFire users know how SolidFire volume replication works, but if you’re just browsing: we need at least two “paired” clusters, and two volumes with same properties.</p>

<p>The target must have its access mode changed to “replication target” while the source usually remains in “read-write” mode. Once they’re paired, initial “baseline” happens asynchronously and then replication continues depending on the mode.</p>

<p><img src="/assets/images/solidfire-replication-monitoring-01-setup.png" alt="Async replication delay" /></p>

<p>There are three modes:</p>

<ul>
  <li>Async - as the word suggests, this mode allows up to hours of delay, but even on LAN networks some delay is usually present (there’s no delay if the volume has no writes, of course). Async is the default mode for all new relationships. If we want one of the other two, we have to modify the relationship and pick one of the following modes</li>
  <li>Sync - there’s no “delay” here, just added latency in writing. Data must be 100% in sync otherwise error is reported</li>
  <li>Snapshots-only - as the name says, only the special kind of snapshots - the kind that’s enabled for replication - are replicated to the remote site. You may have 2 snapshot schedules on the source volume: one every 5 minutes that expires in 60 minutes, and one hourly that’s enabled for replication and has the retention of 8 hours.</li>
</ul>

<p>At the destination, the arrow is inbound indicating incoming replication for the same volume.</p>

<p><img src="/assets/images/solidfire-replication-monitoring-02-destination-view.png" alt="Async replication delay" /></p>

<p>There’s no fixed “destination” as such, though. Cluster and volume pairing is bi-directional and the “direction” of each individual volume relationship depends on which of them is the sole replicationTarget. The other(s) must not be replication target, but one of the non-replication target modes (most commonly read-write).</p>

<p>As you can see in these screenshots, if your clusters aren’t too full or network out of order, once you correctly pair two volumes, they enter ResumingConnected. Note that I’m doing this on MTU 1500 on both Storage and Management network - it’s not a problem at all.</p>

<p>The other day the question was why there’s no progress indication, but replication status never even reached ResumingConnected. If they remain in PausedDisconnected or some other not-good status, then you need to RTFM, SolidFire KBs and maybe the NetApp TR-4741.</p>

<p>Let’s take a look at monitoring approaches.</p>

<h2 id="failed-and-not-so-successful-approaches">Failed and not-so-successful approaches</h2>

<p>I did have two SolidFire clusters - needed them to develop Longhorny - but replication between them could not actually work.</p>

<p>The reason was their networks were asymmetric and only one routing (for Management Network) was in place, so pairing, configuration and un-configuration all worked great, but replication did not.</p>

<p>During that time I made some semi-educated guesses how we may be able to monitor initial volume copy and ongoing bandwidth.</p>

<h3 id="write-workload-at-destination">Write workload at destination</h3>

<p>I thought I had a pretty sound idea here: simply monitor <code class="language-plaintext highlighter-rouge">writeBytes</code> in SolidFire’s <code class="language-plaintext highlighter-rouge">volumeStats</code> responses.</p>

<p>When the destination is in “replication target” mode, the only writes are from initial synchronization and replication.</p>

<p>Well, I just tried and … bzzzzt!</p>

<p>Write bytes from replication don’t register in that counter.</p>

<p>But, let’s not forget: by monitoring writeBytes on the source volume(s), we can get some idea of the amount of data that needs to be replicated. Maybe data is overwritten, in which case it won’t add up, but after watching for a while you can know that for these volumes every 1 GB of writes results in 300 MB of network data transfer, for example. Knowing storage efficiency for the volume helps as well.</p>

<h3 id="node-throughput">Node throughput</h3>

<p>If there’s nothing else, I thought, we can monitor the difference in network throughput during “usual” and “initial volume synchronization”.</p>

<p>This is fine if you don’t have bursty workloads or regular iSCSI client throughput that’s 50x bigger than your replication bandwidth.</p>

<p>Then the effect of initial volume synchronization won’t be even visible.</p>

<p>I was on an otherwise idle system so I was able to observe it, but it’s not a generally useful approach.</p>

<h2 id="good-approaches">Good approaches</h2>

<p>Today I installed another SolidFire Demo VM and it plays nicely with one of the existing SolidFire Demo VMs, so I was able to take a closer look at what <em>actually</em> works.</p>

<h3 id="sync-jobs-at-destination">Sync jobs at destination</h3>

<p>Now this looks like a no-brainer, but it didn’t when replication wasn’t occurring.</p>

<p><img src="/assets/images/solidfire-replication-monitoring-03-task-icon.png" alt="" /></p>

<p>Another reason it’s <em>not</em> a no-brainer is that if you play with little 1 GB volumes that have 100 MB on them, you won’t even notice this thing. The UI refreshes every now and then and if the task takes 5 seconds (5s x 50MB/s), you may very well miss it.</p>

<p>I had to recreate a relationship five times until I realized there was a task thing going on.</p>

<p>Finally I created a larger and fuller volume to be able to spot the icon, click on Tasks and see it before it expires.</p>

<p><img src="/assets/images/solidfire-replication-monitoring-04-task-page.png" alt="" /></p>

<p>Then I had to switch to an even larger one to be able to take this screenshot.</p>

<p><img src="/assets/images/solidfire-replication-monitoring-05-task-api.png" alt="" /></p>

<p>With that, the rest was easy:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ListSyncJobs"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Response:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"syncJobs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"blocksPerSecond"</span><span class="p">:</span><span class="w"> </span><span class="mi">3338</span><span class="p">,</span><span class="w">
        </span><span class="nl">"branchType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"volume"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"dstServiceID"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nl">"dstVolumeID"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="nl">"elapsedTime"</span><span class="p">:</span><span class="w"> </span><span class="mi">91</span><span class="p">,</span><span class="w">
        </span><span class="nl">"percentComplete"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="p">,</span><span class="w">
        </span><span class="nl">"remainingTime"</span><span class="p">:</span><span class="w"> </span><span class="mf">414.5555555555556</span><span class="p">,</span><span class="w">
        </span><span class="nl">"sliceID"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="nl">"stage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"remote"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Some of the interesting ones:</p>

<ul>
  <li>blocks per second = 3338 x 4kB = 10-15 MB/s</li>
  <li>destination volume ID = 10</li>
  <li>percent complete = 18 %</li>
  <li>remaining time = 414.55 seconds</li>
</ul>

<p>Again, this is at the destination where volume ID 10 is a replication target. In PowerShell, the cmdlet is <code class="language-plaintext highlighter-rouge">Get-SFSyncJob</code>.</p>

<p>There’s no such job/task at the source side for outgoing replication. Or at least I could not see it.</p>

<h3 id="volumes-statistics-at-source">Volume’s statistics at source</h3>

<p>First, in that screenshot from the Web UI at the site where the volume is read-write, we see a column named Async Delay:</p>

<p><img src="/assets/images/solidfire-replication-monitoring-01-setup.png" alt="Async replication delay" /></p>

<p>It’s easy to see that may be useful now that replication works….</p>

<p>This is <code class="language-plaintext highlighter-rouge">volumeStats</code> object, <code class="language-plaintext highlighter-rouge">asyncDelay</code> is key where the value is stored.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"volumeStats"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"accountID"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
        </span><span class="nl">"actualIOPS"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"asyncDelay"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00:00:00.000000"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"averageIOPSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">10736</span><span class="p">,</span><span class="w">
        </span><span class="nl">"burstIOPSCredit"</span><span class="p">:</span><span class="w"> </span><span class="mi">90000</span><span class="p">,</span><span class="w">
        </span><span class="nl">"clientQueueDepth"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"desiredMetadataHosts"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nl">"latencyUSec"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"metadataHosts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"deadSecondaries"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="nl">"liveSecondaries"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
          </span><span class="nl">"primary"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"nonZeroBlocks"</span><span class="p">:</span><span class="w"> </span><span class="mi">1309430</span><span class="p">,</span><span class="w">
        </span><span class="nl">"normalizedIOPS"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"readBytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">4908630016</span><span class="p">,</span><span class="w">
        </span><span class="nl">"readBytesLastSample"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"readLatencyUSec"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"readLatencyUSecTotal"</span><span class="p">:</span><span class="w"> </span><span class="mi">295870928</span><span class="p">,</span><span class="w">
        </span><span class="nl">"readOps"</span><span class="p">:</span><span class="w"> </span><span class="mi">59765</span><span class="p">,</span><span class="w">
        </span><span class="nl">"readOpsLastSample"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"samplePeriodMSec"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
        </span><span class="nl">"throttle"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-06-14T08:50:46.726614Z"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"unalignedReads"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"unalignedWrites"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"volumeAccessGroups"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="mi">4</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"volumeID"</span><span class="p">:</span><span class="w"> </span><span class="mi">135</span><span class="p">,</span><span class="w">
        </span><span class="nl">"volumeSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">20000538624</span><span class="p">,</span><span class="w">
        </span><span class="nl">"volumeUtilization"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"writeBytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">54330454016</span><span class="p">,</span><span class="w">
        </span><span class="nl">"writeBytesLastSample"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"writeLatencyUSec"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"writeLatencyUSecTotal"</span><span class="p">:</span><span class="w"> </span><span class="mi">7939281008</span><span class="p">,</span><span class="w">
        </span><span class="nl">"writeOps"</span><span class="p">:</span><span class="w"> </span><span class="mi">8191186</span><span class="p">,</span><span class="w">
        </span><span class="nl">"writeOpsLastSample"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"zeroBlocks"</span><span class="p">:</span><span class="w"> </span><span class="mi">3573514</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="what-else">What else?</h2>

<p>This isn’t new to me, but if you haven’t looked at these things before, <code class="language-plaintext highlighter-rouge">ListVolumes</code> method gives you volume properties (as opposed to <code class="language-plaintext highlighter-rouge">ListVolumeStat</code> which is about performance).</p>

<p>I removed unrelated items for easier viewing:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"access"</span><span class="p">:</span><span class="w"> </span><span class="s2">"readWrite"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"accountID"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
  </span><span class="nl">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="nl">"blockSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">4096</span><span class="p">,</span><span class="w">
  </span><span class="nl">"fifoSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nl">"minFifoSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"win2"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"totalSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">20000538624</span><span class="p">,</span><span class="w">
  </span><span class="nl">"volumeID"</span><span class="p">:</span><span class="w"> </span><span class="mi">135</span><span class="p">,</span><span class="w">
  </span><span class="nl">"volumePairs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"clusterPairID"</span><span class="p">:</span><span class="w"> </span><span class="mi">77</span><span class="p">,</span><span class="w">
      </span><span class="nl">"remoteReplication"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Async"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"pauseLimit"</span><span class="p">:</span><span class="w"> </span><span class="mi">3145728000</span><span class="p">,</span><span class="w">
        </span><span class="nl">"remoteServiceID"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nl">"resumeDetails"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nl">"snapshotReplication"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Idle"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"stateDetails"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Active"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"stateDetails"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"remoteSliceID"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="nl">"remoteVolumeID"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="nl">"remoteVolumeName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"win2-replica"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"volumePairUUID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5f70fc08-fad6-465d-8dac-83766eb38ab4"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Some replication-related stuff:</p>

<ul>
  <li>access is readWrite as we’d expect on a source</li>
  <li>FIFO size, minimum FIFO size - default values related to queuing of replication backlog</li>
  <li>volume pairs is the main one here, it contains information about the configuration and state of replication</li>
</ul>

<p>I almost forgot… See that snapshotReplication?</p>

<p>In any mode - Async, Sync, SnapshotsOnly - if we choose to enable replication in “Create Snapshot” options, the snapshot will be replicated and the state (Active or Idle) is also given in that JSON response.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"snapshotReplication"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Idle"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"stateDetails"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/images/solidfire-replication-monitoring-06-snapshot-replication.png" alt="" /></p>

<p>I took this snapshot on Async volume, so - because there’s no async delay in my case - the snapshot appeared at the destination in 1-2 seconds. I assume it would be “Active” if I was in SnapshotsOnly mode or async delay was measured in seconds or more.</p>

<h2 id="all-together-now">All together now!</h2>

<ul>
  <li>at replication source: delay in Async replication (which the destination can’t know on its own) and the state of replication from <code class="language-plaintext highlighter-rouge">ListVolumeStats</code></li>
  <li>at replication source: replication status and configuration from <code class="language-plaintext highlighter-rouge">ListVolumes</code></li>
  <li>at replication target: we can see the performance, time remaining, and volume ID of the target when initial sync is happening using <code class="language-plaintext highlighter-rouge">ListSyncJobs</code></li>
</ul>

<p>Because I didn’t need a working replication to extract replication configuration, I already added that to <a href="/2024/05/29/sfc-v2.html">SFC</a> last night. I’m still trying to figure out what should be fields and what tags, but the initial try is already on Github (it may change, but you may change it yourself as well!).</p>

<p>The other two - ListSyncJobs and (asyncDelay) ListVolumeStats - need to be added.</p>

<h2 id="conclusion">Conclusion</h2>

<p>The monitoring of the initial volume copy and status isn’t bad. If it doesn’t work, then yes, you can’t see much like I couldn’t when working on Longhorny.</p>

<p>Initial volume sync is a one-off thing, so that information isn’t very valuable unless you pair new volumes more than once (many people do it once and don’t touch it for years). But if you do this, you can watch per-volume progress in Reporting &gt; Running Tasks or via the CLI/API.</p>

<p>What seems more applicable to everyone is the need to monitor delay in async and snapshot replication and for any issues with synchronous replication.</p>

<p>If, for security or other reasons you can’t be logged in to SolidFire Web UI all the time, consider using PowerShell or some monitoring tool that collects these metrics (maybe even SFC, if I implement it).</p>

<p>If you aren’t even allowed to connect to the API endpoint (with PowerShell or something like SFC), you can still monitor these things by sending <a href="/2021/10/18/solidfire-syslog-filebeat-logstash-elk-stack.html">SolidFire log to Elasticsearch</a> or other similar software. That’s the most secure way because no one needs to access storage management interfaces on an ongoing basis.</p>

<h2 id="appendix-a---replication-metrics-in-sfc">Appendix A - replication metrics in SFC</h2>

<p>This is an example of the initial implementation.</p>

<ul>
  <li>Remote replication modes: Async (1), Sync (2), and SnapshotsOnly (3)</li>
  <li>State for snapshots and replication itself also uses integers to indicate status</li>
  <li>volume pair UUID (the last column in the first query) can be used to cross-reference volumes from different clusters, as it it’s unique to each volume replication relationship (or “volume pair”)</li>
  <li>Async delay is parsed and for volumes that are <em>not</em> paired, represented with the integer <code class="language-plaintext highlighter-rouge">-1</code>, while <code class="language-plaintext highlighter-rouge">0</code> and higher stand for delay measured in seconds</li>
  <li>Sync job (not shown)</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="nb">time</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="nv">"name"</span><span class="p">,</span><span class="n">account_id</span><span class="p">,</span><span class="k">access</span><span class="p">,</span><span class="n">remote_replication_mode</span><span class="p">,</span><span class="n">remote_replication_snap_state</span><span class="p">,</span><span class="n">remote_replication_state</span><span class="p">,</span><span class="n">remote_volume_id</span><span class="p">,</span><span class="n">remote_volume_name</span><span class="p">,</span><span class="n">volume_pair_uuid</span> <span class="k">FROM</span> <span class="nv">"volumes"</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">time</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">10</span>
<span class="n">name</span><span class="p">:</span> <span class="n">volumes</span>
<span class="nb">time</span>                 <span class="n">id</span>  <span class="n">name</span>        <span class="n">account_id</span> <span class="k">access</span>    <span class="n">remote_replication_mode</span> <span class="n">remote_replication_snap_state</span> <span class="n">remote_replication_state</span> <span class="n">remote_volume_id</span> <span class="n">remote_volume_name</span> <span class="n">volume_pair_uuid</span>
<span class="c1">----                 --  ----        ---------- ------    ----------------------- ----------------------------- ------------------------ ---------------- ------------------ ----------------</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span> <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">13</span>               <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span>    <span class="n">cfa9a820</span><span class="o">-</span><span class="mi">2150</span><span class="o">-</span><span class="mi">437</span><span class="k">c</span><span class="o">-</span><span class="n">b848</span><span class="o">-</span><span class="mi">207</span><span class="n">c85975d1f</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">136</span> <span class="n">sqldb</span>       <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">11</span>               <span class="k">sql</span><span class="o">-</span><span class="n">replica</span>        <span class="n">fba6dc63</span><span class="o">-</span><span class="mi">993</span><span class="k">c</span><span class="o">-</span><span class="mi">4</span><span class="n">a62</span><span class="o">-</span><span class="n">b85b</span><span class="o">-</span><span class="n">cb4043f04aae</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">135</span> <span class="n">win2</span>        <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">10</span>               <span class="n">win2</span><span class="o">-</span><span class="n">replica</span>       <span class="mi">5</span><span class="n">f70fc08</span><span class="o">-</span><span class="n">fad6</span><span class="o">-</span><span class="mi">465</span><span class="n">d</span><span class="o">-</span><span class="mi">8</span><span class="n">dac</span><span class="o">-</span><span class="mi">83766</span><span class="n">eb38ab4</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span> <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">13</span>               <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span>    <span class="n">cfa9a820</span><span class="o">-</span><span class="mi">2150</span><span class="o">-</span><span class="mi">437</span><span class="k">c</span><span class="o">-</span><span class="n">b848</span><span class="o">-</span><span class="mi">207</span><span class="n">c85975d1f</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">136</span> <span class="n">sqldb</span>       <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">11</span>               <span class="k">sql</span><span class="o">-</span><span class="n">replica</span>        <span class="n">fba6dc63</span><span class="o">-</span><span class="mi">993</span><span class="k">c</span><span class="o">-</span><span class="mi">4</span><span class="n">a62</span><span class="o">-</span><span class="n">b85b</span><span class="o">-</span><span class="n">cb4043f04aae</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">135</span> <span class="n">win2</span>        <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">10</span>               <span class="n">win2</span><span class="o">-</span><span class="n">replica</span>       <span class="mi">5</span><span class="n">f70fc08</span><span class="o">-</span><span class="n">fad6</span><span class="o">-</span><span class="mi">465</span><span class="n">d</span><span class="o">-</span><span class="mi">8</span><span class="n">dac</span><span class="o">-</span><span class="mi">83766</span><span class="n">eb38ab4</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span> <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">13</span>               <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span>    <span class="n">cfa9a820</span><span class="o">-</span><span class="mi">2150</span><span class="o">-</span><span class="mi">437</span><span class="k">c</span><span class="o">-</span><span class="n">b848</span><span class="o">-</span><span class="mi">207</span><span class="n">c85975d1f</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">136</span> <span class="n">sqldb</span>       <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">11</span>               <span class="k">sql</span><span class="o">-</span><span class="n">replica</span>        <span class="n">fba6dc63</span><span class="o">-</span><span class="mi">993</span><span class="k">c</span><span class="o">-</span><span class="mi">4</span><span class="n">a62</span><span class="o">-</span><span class="n">b85b</span><span class="o">-</span><span class="n">cb4043f04aae</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">135</span> <span class="n">win2</span>        <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">10</span>               <span class="n">win2</span><span class="o">-</span><span class="n">replica</span>       <span class="mi">5</span><span class="n">f70fc08</span><span class="o">-</span><span class="n">fad6</span><span class="o">-</span><span class="mi">465</span><span class="n">d</span><span class="o">-</span><span class="mi">8</span><span class="n">dac</span><span class="o">-</span><span class="mi">83766</span><span class="n">eb38ab4</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span> <span class="mi">13</span>         <span class="n">readWrite</span> <span class="mi">1</span>                       <span class="mi">2</span>                             <span class="mi">1</span>                        <span class="mi">13</span>               <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span>    <span class="n">cfa9a820</span><span class="o">-</span><span class="mi">2150</span><span class="o">-</span><span class="mi">437</span><span class="k">c</span><span class="o">-</span><span class="n">b848</span><span class="o">-</span><span class="mi">207</span><span class="n">c85975d1f</span>
<span class="o">&gt;</span> 
<span class="o">&gt;</span> <span class="k">SELECT</span> <span class="nb">time</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="nv">"name"</span><span class="p">,</span><span class="n">async_delay</span> <span class="k">FROM</span> <span class="nv">"volume_performance"</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=~/</span><span class="mi">134</span><span class="o">/</span> <span class="k">or</span> <span class="n">id</span><span class="o">=~/</span><span class="mi">135</span><span class="o">/</span> <span class="k">or</span> <span class="n">id</span><span class="o">=~/</span><span class="mi">136</span><span class="o">/</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">time</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">15</span>
<span class="n">name</span><span class="p">:</span> <span class="n">volume_performance</span>
<span class="nb">time</span>                 <span class="n">id</span>  <span class="n">name</span>  <span class="n">async_delay</span>
<span class="c1">----                 --  ----  -----------</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">136</span> <span class="n">sqldb</span> <span class="mi">3</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">134</span> <span class="n">win1</span>  <span class="o">-</span><span class="mi">1</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">135</span> <span class="n">win2</span>  <span class="mi">3</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">134</span> <span class="n">win1</span>  <span class="o">-</span><span class="mi">1</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">135</span> <span class="n">win2</span>  <span class="mi">0</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">136</span> <span class="n">sqldb</span> <span class="mi">0</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">135</span> <span class="n">win2</span>  <span class="mi">0</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">136</span> <span class="n">sqldb</span> <span class="mi">0</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">134</span> <span class="n">win1</span>  <span class="o">-</span><span class="mi">1</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">136</span> <span class="n">sqldb</span> <span class="mi">0</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">134</span> <span class="n">win1</span>  <span class="o">-</span><span class="mi">1</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">135</span> <span class="n">win2</span>  <span class="mi">0</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">134</span> <span class="n">win1</span>  <span class="o">-</span><span class="mi">1</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">135</span> <span class="n">win2</span>  <span class="mi">0</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">12</span><span class="n">Z</span> <span class="mi">136</span> <span class="n">sqldb</span> <span class="mi">0</span>

</code></pre></div></div>

<p>From the above it’s obvious volume 172 (syncJobTest) is the only replicating volume and it is the source, while the remote volume is the replica.</p>

<p>Since from the first query we know syncJobTest has a pairing relationship with syncJob-replica (volume ID 13 on the remote cluster), we can also query (and visualize) pairs like this.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="nb">time</span><span class="p">,</span><span class="n">id</span><span class="p">,</span><span class="nv">"name"</span><span class="p">,</span><span class="n">async_delay</span><span class="p">,</span><span class="k">cluster</span> <span class="k">FROM</span> <span class="nv">"volume_performance"</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span> <span class="s1">'172'</span> <span class="k">or</span> <span class="n">id</span><span class="o">=</span> <span class="s1">'13'</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">time</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">15</span>
<span class="n">name</span><span class="p">:</span> <span class="n">volume_performance</span>
<span class="nb">time</span>                 <span class="n">id</span>  <span class="n">name</span>            <span class="n">async_delay</span> <span class="k">cluster</span>
<span class="c1">----                 --  ----            ----------- -------</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">14</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span>     <span class="o">-</span><span class="mi">1</span>          <span class="n">PROD</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">40</span><span class="n">Z</span> <span class="mi">13</span>  <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span> <span class="o">-</span><span class="mi">1</span>          <span class="n">DR</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">14</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span>     <span class="o">-</span><span class="mi">1</span>          <span class="n">PROD</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="mi">40</span><span class="n">Z</span> <span class="mi">13</span>  <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span> <span class="o">-</span><span class="mi">1</span>          <span class="n">DR</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="mi">14</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span>     <span class="o">-</span><span class="mi">1</span>          <span class="n">PROD</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="n">Z</span> <span class="mi">13</span>  <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span> <span class="o">-</span><span class="mi">1</span>          <span class="n">DR</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">14</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span>     <span class="o">-</span><span class="mi">1</span>          <span class="n">PROD</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">40</span><span class="n">Z</span> <span class="mi">13</span>  <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span> <span class="o">-</span><span class="mi">1</span>          <span class="n">DR</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">14</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span>     <span class="o">-</span><span class="mi">1</span>          <span class="n">PROD</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">40</span><span class="n">Z</span> <span class="mi">13</span>  <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span> <span class="o">-</span><span class="mi">1</span>          <span class="n">DR</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">14</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span>     <span class="o">-</span><span class="mi">1</span>          <span class="n">PROD</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">40</span><span class="n">Z</span> <span class="mi">13</span>  <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span> <span class="o">-</span><span class="mi">1</span>          <span class="n">DR</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">14</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span>     <span class="o">-</span><span class="mi">1</span>          <span class="n">PROD</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">40</span><span class="n">Z</span> <span class="mi">13</span>  <span class="n">syncJob</span><span class="o">-</span><span class="n">replica</span> <span class="o">-</span><span class="mi">1</span>          <span class="n">DR</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">14</span><span class="n">Z</span> <span class="mi">172</span> <span class="n">syncJobTest</span>     <span class="o">-</span><span class="mi">1</span>          <span class="n">PROD</span>

</code></pre></div></div>

<p>You may notice now Async Delay for syncJobTest is <code class="language-plaintext highlighter-rouge">-1</code>. How is that possible? I changed its mode from Async to SnapshotsOnly, so there’s no more “Async Delay”. You can find more on these details in the SFC documentation for reference dashboard.</p>

<p>Here we got a short-lived remote sync job pushed on the <strong>remote</strong> cluster (notice the cluster name: <strong>DR</strong>), which took just a few seconds (not more than a minute, as we see just 2.25 seconds was left by the time SFC saw the job).</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">sync_jobs</span>
<span class="n">name</span><span class="p">:</span> <span class="n">sync_jobs</span>
<span class="nb">time</span>                 <span class="n">blocks_per_sec</span> <span class="k">cluster</span> <span class="n">dst_volume_id</span> <span class="n">elapsed_time</span> <span class="n">pct_complete</span> <span class="n">remaining_time</span>    <span class="n">stage</span> <span class="k">type</span>
<span class="c1">----                 -------------- ------- ------------- ------------ ------------ --------------    ----- ----</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span><span class="n">T14</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">40</span><span class="n">Z</span> <span class="mi">101968</span>         <span class="n">DR</span>      <span class="mi">11</span>            <span class="mi">1</span>            <span class="mi">31</span>           <span class="mi">2</span><span class="p">.</span><span class="mi">225806451612903</span> <span class="k">data</span>  <span class="n">remote</span>

</code></pre></div></div>

      </article>
    </div>
    
      <div class="categories">
    <span><p>Categories:</p>
    
    
      <a href="
      /categories/#solidfire">solidfire</a>
      &nbsp; 
    
      <a href="
      /categories/#projects">projects</a>
      &nbsp; 
    
      <a href="
      /categories/#monitoring">monitoring</a>
       
    
  </span>
</div>
    

  
    <div>
      <h3>Related Posts</h3>
      <ul>
      
        <li><a href="/2024/06/12/longhorny-cluster-volume-replication-report.html">Reporting SolidFire cluster and volume pairing relationships</a></li>
      
        <li><a href="/2024/06/15/sfc-adds-volume-replication-monitoring.html">SFC v2 adds volume replication monitoring</a></li>
      
        <li><a href="/2024/06/11/introducing-project-longhorny.html">Project Longhorny</a></li>
      
        <li><a href="/2024/06/03/pvc-volume-relationships-in-solidfire-trident-part-2.html">Kubernetes, Trident and SolidFire configuration - part 2</a></li>
      
        <li><a href="/2024/06/01/pvc-volume-relationships-in-solidfire-trident-part-1.html">Kubernetes, Trident and SolidFire configuration visibility</a></li>
      
      </ul>
    </div>
  

    
  </div><footer class= "footer">
    <p>2025-08-09 15:39 </p>
    <p>Copyright © 2025 scaleoutSean. Content is released under the CC BY license. Design: Alessio Franceschi</p>
</footer>

</body>
</html>
