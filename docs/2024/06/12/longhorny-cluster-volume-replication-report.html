<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8">
    <meta http-equiv="content-language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="googlebot" content="noarchive">
    <meta name="googlebot" content="max-snippet:60">
    <meta name="googlebot" content="max-image-preview:small">
    <meta name="bingbot" content="noarchive">
    <meta name="bingbot" content="max-snippet:60">
    <meta name="bingbot" content="max-image-preview:small">
    <meta name="robots" content="noarchive">
    <meta name="robots" content="max-snippet:60">
    <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />
    <title>
        
            Reporting SolidFire cluster and volume pairing relationships | Acting Technologist
      
    </title>
    <meta name="description" content="
     Creating reports for SolidFire cluster pairs and volume replication pairs
     ">

    <!-- LINK TO ATOM FEED FOR SEO -->
    <link rel="alternate" type="application/atom+xml" href="https://scaleoutsean.github.io/feed.xml" />

    <!-- FAVICON -->
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

    <link href="/_pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script>
    <div id="search"></div>
    <script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ element: "#search" });
        });
    </script>

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Reporting SolidFire cluster and volume pairing relationships | Acting Technologist</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Reporting SolidFire cluster and volume pairing relationships" />
<meta name="author" content="scaleoutSean" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Creating reports for SolidFire cluster pairs and volume replication pairs" />
<meta property="og:description" content="Creating reports for SolidFire cluster pairs and volume replication pairs" />
<link rel="canonical" href="https://scaleoutsean.github.io/2024/06/12/longhorny-cluster-volume-replication-report.html" />
<meta property="og:url" content="https://scaleoutsean.github.io/2024/06/12/longhorny-cluster-volume-replication-report.html" />
<meta property="og:site_name" content="Acting Technologist" />
<meta property="og:image" content="https://scaleoutsean.github.io/assets/images/cluster_pairing_relationships_cluster_pair.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-12T00:00:00+08:00" />
<script type="application/ld+json">
{"image":"https://scaleoutsean.github.io/assets/images/cluster_pairing_relationships_cluster_pair.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://scaleoutsean.github.io/2024/06/12/longhorny-cluster-volume-replication-report.html"},"author":{"@type":"Person","name":"scaleoutSean"},"description":"Creating reports for SolidFire cluster pairs and volume replication pairs","@type":"BlogPosting","url":"https://scaleoutsean.github.io/2024/06/12/longhorny-cluster-volume-replication-report.html","headline":"Reporting SolidFire cluster and volume pairing relationships","dateModified":"2024-06-12T00:00:00+08:00","datePublished":"2024-06-12T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

<body>

  <div class="container">
    <header id="header">
	<div id = site_title>
		<a href="https://scaleoutsean.github.io/">
			<h2 style="font-size:1.8em;">Acting Technologist</h2>
		</a>
		
		<h3>
			civilizations are created by individuals
		</h3>
		
	</div>

	<div id="subheader">
		
		<nav class="pages">
<a href="/about.html">About</a>

<a href="/archive.html">Archive</a>

<a href="/categories/">Categories</a>

<a href="/projects.html">Projects</a>
</nav>
		
		
		<nav class="social">
			
  
    <a href="https://www.github.com/scaleoutsean" target="_blank" id="github"><i class="fab fa-github" aria-hidden="true"></i></a>
  
   

  
    <a href="https://twitter.com/scaleoutsean" target="_blank" id="twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a>
  
   

  
  
    <a href="/feed.xml" target="_blank" id="rss"><i class="fas fa-rss" aria-hidden="true"></i></a>
   

		</nav>
		
	</div>
</header>


    <div class="post-container">
      <article id = "post">
        <h1 id = "post-title">Reporting SolidFire cluster and volume pairing relationships</h1>

  
  <div class = "post-info">
    <span>
        <i class="far fa-calendar" aria-hidden="true"></i> <span>12 Jun 2024</span> - <i class="far fa-clock"></i> 


  
  
    10 minute read
  

    </span>
  </div>
  
        <h2 id="introduction">Introduction</h2>

<p>This week I <a href="/2024/06/11/introducing-project-longhorny.html">released</a> Longhorny, my simple tool for SolidFire volume replication management and while there’s a “list” action for both cluster and volumes, I mentioned that these are meant to list relationships for a Longhorny-supported setup the user is working with, which is 1-to-1 exclusive pairing.</p>

<p>Longhorny can also find mismatched volumes, so given that Longhorny won’t even pair clusters with an existing relationship, the only problem that can happen with careful management is a mismatched volume or two.</p>

<p>I did notice two things, though: if a cluster is already paired, Longhorny doesn’t particularly care why and who, it just exits. Figuring out why is out of scope. The second is that if there’s more than a handful of mismatched volumes, which may happen in large clusters, it may be hard to figure out what’s what.</p>

<p>That made me think about creating the report action that would report on anything it sees - for both cluster relationships and volume relationships - and potentially be useful to non-Longhorny users with multiple clusters as well.</p>

<h2 id="matrices">Matrices</h2>

<p>It took me a while to figure out what I’d like to see and how to display it.</p>

<p>For now I’m using a basic approach - 2D matrix with N elements where N = (number_of_clusters + 1). The one extra cluster is for unconfigured/pending relationships.</p>

<p>In the case of Longhorny, which supports two (1-to-1) clusters, that would be 3x3.</p>

<p>I examine relationships from each cluster and when it’s all good, I get a matrix like this.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CLUSTER CONNECTIONS

              PROD  DR  UNCONFIGURED
PROD             0   1             0
DR               1   0             0
UNCONFIGURED     0   0             0
</code></pre></div></div>

<p>If it’s not good, then UNCONFIGURED may have more than 0 relationships or one of the other clusters has more than 1. Example:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CLUSTER CONNECTIONS

              PROD  DR  UNCONFIGURED
PROD             0   1             0
DR               1   0             0
UNCONFIGURED     1   0             0

UNCONFIGURED CLUSTERS

PROD
</code></pre></div></div>

<p>The same approach works for 3, 4 and 5-way pairs.</p>

<p>In this case we can figure the problem (PROD) and determine where the problem is. This isn’t hard to do without a matrix, but it may be for volumes because there may be hundreds or thousands and comparing them the traditional way would be slow and maybe need a lot of RAM.</p>

<p>For volumes, it’s going to be same approach, but I’m still thinking if I should try a multi-dimensional matrix with each item being a collection of more properties (number of cluster pairing relationships, number of paired volumes, number of all volumes). That seems more useful, but also more difficult to deal with.</p>

<p>These simple 2D matrices are easy to work with, and easy export to CSV or visualize. Example for the bad case (PROD is paired with UNCONFIGURED):</p>

<p><img src="/assets/images/cluster_pairing_relationships_cluster_pair.png" alt="" /></p>

<p>Similar can be done for volumes, but I may need to do that in another matrix because that seems easier.</p>

<p>Because there may be hundreds of paired (and dozens of unilaterally paired) volumes, it seems HTML volume ID pairs linked to volume details in SolidFire management UI would be a nice way to show that, but also require more work.</p>

<p>For up to 10-20 unilaterally paired volumes it’d be nice to be able to see names and maybe even accounts, so it appears “what’s better” is relative and needs experimentation.</p>

<p>If HTML is used, then plain old tables - especially if they can be filtered and sorted by column - may be valuable, too.</p>

<h2 id="tables">Tables</h2>

<p>As I progressed with volumes, it quickly became clear this is harder than clusters. And also, that hacking without a plan isn’t the best approach when you’re working on something not very simple.</p>

<p>Volume pairings can be screwed up in many ways, which makes it more complex than clusters.</p>

<p>Because I don’t want to spend a week on this, I abandoned the goal of adding cluster dimensions beyond 1-to-1 (two clusters). That would have to be another “level” of recursion, so nothing challenging, just more complicated and would need 3 or more clusters for testing, which I can’t run due to limited RAM in my lab.</p>

<p>So, with two mutually paired clusters, it is important to scan paired volumes twice and in both directions. That may seem strange at first, but unlike two clusters which are either paired or not paired, a volume pair can be paired and not paired at the same time (depending on the direction), and on top of that if a pair isn’t symmetrically paired one of the volumes may not even exist (which is important to know because re-pairing them in isn’t possible and corrective actions are different in different cases).</p>

<p>To put this in a matrix seems rather complicated (at least to me), so I’ll try using tables here.</p>

<p>I’m sure there is some “famous algorithm” out there that solves this and everyone but me knows about it, but we also need to check volume properties, so…</p>

<p>I produce a report (Appendix A) on a cluster pair with messed up not just relationships, but also volumes (see Appendix A).</p>

<h2 id="ispaired-in-solidfire-listvolumes-parameters"><code class="language-plaintext highlighter-rouge">isPaired</code> in SolidFire ListVolumes parameters</h2>

<p>Here’s how that works:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">isPaired</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">sfe_a</span><span class="p">.</span><span class="nf">invoke_sfapi</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">ListVolumes</span><span class="sh">'</span><span class="p">,</span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)[</span><span class="sh">'</span><span class="s">volumes</span><span class="sh">'</span><span class="p">])</span>
<span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">isPaired</span><span class="sh">'</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">sfe_a</span><span class="p">.</span><span class="nf">invoke_sfapi</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">ListVolumes</span><span class="sh">'</span><span class="p">,</span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)[</span><span class="sh">'</span><span class="s">volumes</span><span class="sh">'</span><span class="p">])</span>
<span class="mi">35</span>
</code></pre></div></div>

<blockquote>
  <p>is_paired (bool) – Returns volumes that are paired or not paired. Possible values are: true: Returns all paired volumes. false: Returns all volumes that are not paired. (<a href="https://solidfire-sdk-python.readthedocs.io/en/latest/solidfire.html#solidfire.models.ListVolumesRequest">source</a>)</p>
</blockquote>

<p>In order to get <em>all</em> volumes, we simply use <code class="language-plaintext highlighter-rouge">None</code>, right? Right?</p>

<p>Wrong. But I spent 1 day troubleshooting my own code because I didn’t notice (the default value is not documented, as per above) that the trouble was in the SolidFire API responses.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">isPaired</span><span class="sh">'</span><span class="p">:</span> <span class="bp">None</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">sfe_a</span><span class="p">.</span><span class="nf">invoke_sfapi</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">ListVolumes</span><span class="sh">'</span><span class="p">,</span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)[</span><span class="sh">'</span><span class="s">volumes</span><span class="sh">'</span><span class="p">])</span>
<span class="mi">35</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">sfe_a</span><span class="p">.</span><span class="nf">invoke_sfapi</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">ListVolumes</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">volumes</span><span class="sh">'</span><span class="p">])</span>
<span class="mi">40</span>
</code></pre></div></div>

<p>The documentation doesn’t say <code class="language-plaintext highlighter-rouge">False</code> is the default and anything but <code class="language-plaintext highlighter-rouge">True</code> is also <code class="language-plaintext highlighter-rouge">False</code>. In order to get <em>all</em> the volumes, one must use <code class="language-plaintext highlighter-rouge">isPaired</code> in parameters at all. That is ridiculous!</p>

<h2 id="conclusion">Conclusion</h2>

<p>I don’t know how many people have 2 clusters, let alone 3 or 4, but it’s an interesting problem in any case.</p>

<p>Unlike with one-to-many and any-to-any relationships that may be present on networks, these relationships seem easier to understand with matrices and especially so in 2-cluster situations.</p>

<p>The problem of “optimal” visualization requires some experimentation as I usually don’t deal with problems of this nature. For example, the image in this post would ideally use specific colors for anything that’s &gt;2 and for any non-0 value in UNCONFIGURED, but the software I used can’t do that.</p>

<p>Approximately half the time I spent unnecessarily “debugging” my own code, whereas I was unknowingly not getting the right responses from the API due to that isPaired thing above. And because of that the script is now an incredible mess and requires a complete rework. If I find the energy to deal with that stuff again, I may add it to Longhorny. I thought to do a bit more, but I’ve had enough of dealing with this stuff!</p>

<h2 id="appendix-a---tabular-report">Appendix A - tabular report</h2>

<p>Pairings on this cluster are truly messed up - different directions, sizes, accounts, missing one-side relationships, missing volumes…</p>

<p>Longhorny has a simple <code class="language-plaintext highlighter-rouge">--list</code> action for paired relationships only. For this same cluster pair with the same pairing issues, it returns this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MISMATCHED PAIRED VOLUMES ONLY:

<span class="o">[{</span><span class="s1">'DR'</span>: <span class="o">{</span><span class="s1">'volumeID'</span>: 397,
         <span class="s1">'volumePairUUID'</span>: <span class="s1">'d0970043-322d-442c-bbaa-7f87a79b82db'</span>,
         <span class="s1">'mismatchSite'</span>: <span class="s1">'PROD'</span>,
         <span class="s1">'remoteVolumeID'</span>: 158<span class="o">}}</span>,
 <span class="o">{</span><span class="s1">'PROD'</span>: <span class="o">{</span><span class="s1">'volumeID'</span>: 169,
           <span class="s1">'volumePairUUID'</span>: <span class="s1">'2484f857-9f7b-4d43-af86-8663774072a4'</span>,
           <span class="s1">'remoteSite'</span>: <span class="s1">'DR'</span>,
           <span class="s1">'remoteVolumeID'</span>: 410<span class="o">}}</span>,
 <span class="o">{</span><span class="s1">'PROD'</span>: <span class="o">{</span><span class="s1">'volumeID'</span>: 170,
           <span class="s1">'volumePairUUID'</span>: <span class="s1">'602c3630-ad30-4b2a-b03c-e9165f45d574'</span>,
           <span class="s1">'remoteSite'</span>: <span class="s1">'DR'</span>,
           <span class="s1">'remoteVolumeID'</span>: 411<span class="o">}}]</span>
</code></pre></div></div>

<p>The new <code class="language-plaintext highlighter-rouge">--report</code> action could provide information more detailed than just pairing-related information. Here’s what I get my my garbage code now.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="sh">'</span><span class="s">PROD</span><span class="sh">'</span><span class="p">:</span> <span class="p">[{</span><span class="sh">'</span><span class="s">localVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">135</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteVolumeId</span><span class="sh">'</span><span class="p">:</span> <span class="mi">395</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">replicationTarget</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">20000538624</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">20000538624</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">volumeSizeDiff</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">SnapshotsOnly</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Async</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">direction</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Local -&gt; Remote</span><span class="sh">'</span><span class="p">},</span>
          <span class="p">{</span><span class="sh">'</span><span class="s">localVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteVolumeId</span><span class="sh">'</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3001024512</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3001024512</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">volumeSizeDiff</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Async</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Async</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">direction</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Local &lt;-!!!-&gt; Remote</span><span class="sh">'</span><span class="p">},</span>
          <span class="p">{</span><span class="sh">'</span><span class="s">localVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">167</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteVolumeId</span><span class="sh">'</span><span class="p">:</span> <span class="mi">401</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10000269312</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10000269312</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">volumeSizeDiff</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Async</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Async</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">direction</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Local &lt;-!!!-&gt; Remote</span><span class="sh">'</span><span class="p">},</span>
          <span class="p">{</span><span class="sh">'</span><span class="s">localVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">169</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4000317440</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">SnapshotsOnly</span><span class="sh">'</span><span class="p">},</span>
          <span class="p">{</span><span class="sh">'</span><span class="s">localVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">170</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2000683008</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Async</span><span class="sh">'</span><span class="p">},</span>
          <span class="p">{</span><span class="sh">'</span><span class="s">localVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">171</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteVolumeId</span><span class="sh">'</span><span class="p">:</span> <span class="mi">412</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">readWrite</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2147483648</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1073741824</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">volumeSizeDiff</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1073741824</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">SnapshotsOnly</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">remoteReplicationMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Async</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">direction</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Local &lt;-!!!-&gt; Remote</span><span class="sh">'</span><span class="p">},</span>
          <span class="p">{</span><span class="sh">'</span><span class="s">localVolumeID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">158</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccessMode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">replicationTarget</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localAccountID</span><span class="sh">'</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">localSize</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2000683008</span><span class="p">}]}</span>
</code></pre></div></div>

<p>I’d also output that in tables for folks who want to view that output and not paste it into some program.</p>

<p>In this case the first table created at the “source” site shows the same thing as that long output above. View from local “SRC”:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+---------------+----------------+-------------------+-------------------+----------------+-----------------+-------------+-------------+----------------+----------------------+-----------------------+----------------------+
| localVolumeID | remoteVolumeId |  localAccessMode  | remoteAccessMode  | localAccountID | remoteAccountID |  localSize  | remoteSize  | volumeSizeDiff | localReplicationMode | remoteReplicationMode |      direction       |
+---------------+----------------+-------------------+-------------------+----------------+-----------------+-------------+-------------+----------------+----------------------+-----------------------+----------------------+
|      135      |      395       |     readWrite     | replicationTarget |       13       |        3        | 20000538624 | 20000538624 |       0        |    SnapshotsOnly     |         Async         |   Local -&gt; Remote    |
|      164      |      400       |     readWrite     |     readWrite     |       13       |       14        | 3001024512  | 3001024512  |       0        |        Async         |         Async         | Local &lt;-!!!-&gt; Remote |
|      167      |      401       |     readWrite     |     readWrite     |       13       |        3        | 10000269312 | 10000269312 |       0        |        Async         |         Async         | Local &lt;-!!!-&gt; Remote |
|      169      |                |     readWrite     |                   |       13       |                 | 4000317440  |             |                |    SnapshotsOnly     |                       |                      |
|      170      |                |     readWrite     |                   |       17       |                 | 2000683008  |             |                |        Async         |                       |                      |
|      171      |      412       |     readWrite     |     readWrite     |       13       |        7        | 2147483648  | 1073741824  |   1073741824   |    SnapshotsOnly     |         Async         | Local &lt;-!!!-&gt; Remote |
|      158      |                | replicationTarget |                   |       13       |                 | 2000683008  |             |                |                      |                       |                      |
+---------------+----------------+-------------------+-------------------+----------------+-----------------+-------------+-------------+----------------+----------------------+-----------------------+----------------------+
</code></pre></div></div>

<p>But, since some local volumes may be missing, we also need to look and report from remote cluster (DST). Of course, we could have “<code class="language-plaintext highlighter-rouge">-</code>” (empty) in localVolumeID value at the source when a volume from a relationship at the remote site does not exist but that seems un-actionable, when stuff is simply missing and all local values are “<code class="language-plaintext highlighter-rouge">-</code>”.</p>

<p>That should also serve as a reminder that nothing can replace log retention. <a href="https://github.com/scaleoutsean/sfc">SFC</a> doesn’t do it (yet), but <a href="/2021/10/18/solidfire-syslog-filebeat-logstash-elk-stack.html#get-events-and-faults-completely-from-api-logs">if you forward SolidFire API events to Elasticsearch</a> then should be able to see what that “<code class="language-plaintext highlighter-rouge">-</code>” used to be up to the moment it disappeared and who removed it.</p>

<p>In terms of Longhorny CLI I think it’s better to have two views which can be done by simply swapping <code class="language-plaintext highlighter-rouge">--src</code> and <code class="language-plaintext highlighter-rouge">--dst</code>. View of the same pairing relationships from the remote site (“DST”):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+---------------+----------------+-------------------+------------------+----------------+-----------------+-------------+-------------+----------------+----------------------+-----------------------+----------------------+
| localVolumeID | remoteVolumeId |  localAccessMode  | remoteAccessMode | localAccountID | remoteAccountID |  localSize  | remoteSize  | volumeSizeDiff | localReplicationMode | remoteReplicationMode |      direction       |
+---------------+----------------+-------------------+------------------+----------------+-----------------+-------------+-------------+----------------+----------------------+-----------------------+----------------------+
|      395      |      135       | replicationTarget |    readWrite     |       3        |       13        | 20000538624 | 20000538624 |       0        |        Async         |     SnapshotsOnly     |   Remote -&gt; Local    |
|      397      |                |     readWrite     |                  |       3        |                 | 2000683008  |             |                |        Async         |                       |                      |
|      400      |      164       |     readWrite     |    readWrite     |       14       |       13        | 3001024512  | 3001024512  |       0        |        Async         |         Async         | Local &lt;-!!!-&gt; Remote |
|      401      |      167       |     readWrite     |    readWrite     |       3        |       13        | 10000269312 | 10000269312 |       0        |        Async         |         Async         | Local &lt;-!!!-&gt; Remote |
|      412      |      171       |     readWrite     |    readWrite     |       7        |       13        | 1073741824  | 2147483648  |  <span class="nt">-1073741824</span>   |        Async         |     SnapshotsOnly     | Local &lt;-!!!-&gt; Remote |
|      411      |                |     readWrite     |                  |       7        |                 | 2000683008  |             |                |                      |                       |                      |
+---------------+----------------+-------------------+------------------+----------------+-----------------+-------------+-------------+----------------+----------------------+-----------------------+----------------------+
</code></pre></div></div>

      </article>
    </div>
    
      <div class="categories">
    <span><p>Categories:</p>
    
    
      <a href="
      /categories/#solidfire">solidfire</a>
      &nbsp; 
    
      <a href="
      /categories/#projects">projects</a>
       
    
  </span>
</div>
    

  
    <div>
      <h3>Related Posts</h3>
      <ul>
      
        <li><a href="/2024/06/14/netapp-solidfire-replication-monitoring.html">Monitoring volume replication in NetApp SolidFire</a></li>
      
        <li><a href="/2024/06/15/sfc-adds-volume-replication-monitoring.html">SFC v2 adds volume replication monitoring</a></li>
      
        <li><a href="/2024/06/11/introducing-project-longhorny.html">Project Longhorny</a></li>
      
        <li><a href="/2024/06/03/pvc-volume-relationships-in-solidfire-trident-part-2.html">Kubernetes, Trident and SolidFire configuration - part 2</a></li>
      
        <li><a href="/2024/06/01/pvc-volume-relationships-in-solidfire-trident-part-1.html">Kubernetes, Trident and SolidFire configuration visibility</a></li>
      
      </ul>
    </div>
  

    
  </div><footer class= "footer">
    <p>2025-06-22 13:55 </p>
    <p>Copyright © 2025 scaleoutSean. Content is released under the CC BY license. Design: Alessio Franceschi</p>
</footer>

</body>
</html>
