<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8">
    <meta http-equiv="content-language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="googlebot" content="noarchive">
    <meta name="googlebot" content="max-snippet:60">
    <meta name="googlebot" content="max-image-preview:small">
    <meta name="bingbot" content="noarchive">
    <meta name="bingbot" content="max-snippet:60">
    <meta name="bingbot" content="max-image-preview:small">
    <meta name="robots" content="noarchive">
    <meta name="robots" content="max-snippet:60">
    <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />
    <title>
        
            Increase size of SolidFire volumes paired for replication | Acting Technologist
      
    </title>
    <meta name="description" content="
     How to increase total size of SolidFire volumes paired for replication
     ">

    <!-- LINK TO ATOM FEED FOR SEO -->
    <link rel="alternate" type="application/atom+xml" href="https://scaleoutsean.github.io/feed.xml" />

    <!-- FAVICON -->
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

    <link href="/_pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script>
    <div id="search"></div>
    <script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ element: "#search" });
        });
    </script>

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Increase size of SolidFire volumes paired for replication | Acting Technologist</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Increase size of SolidFire volumes paired for replication" />
<meta name="author" content="scaleoutSean" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to increase total size of SolidFire volumes paired for replication" />
<meta property="og:description" content="How to increase total size of SolidFire volumes paired for replication" />
<link rel="canonical" href="https://scaleoutsean.github.io/2024/06/28/growing-solidfire-volumes-paired-for-replication.html" />
<meta property="og:url" content="https://scaleoutsean.github.io/2024/06/28/growing-solidfire-volumes-paired-for-replication.html" />
<meta property="og:site_name" content="Acting Technologist" />
<meta property="og:image" content="https://scaleoutsean.github.io/assets/images/solidfire-volume-pairing-at-source.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-28T00:00:00+08:00" />
<script type="application/ld+json">
{"headline":"Increase size of SolidFire volumes paired for replication","dateModified":"2024-06-28T00:00:00+08:00","datePublished":"2024-06-28T00:00:00+08:00","url":"https://scaleoutsean.github.io/2024/06/28/growing-solidfire-volumes-paired-for-replication.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://scaleoutsean.github.io/2024/06/28/growing-solidfire-volumes-paired-for-replication.html"},"description":"How to increase total size of SolidFire volumes paired for replication","author":{"@type":"Person","name":"scaleoutSean"},"image":"https://scaleoutsean.github.io/assets/images/solidfire-volume-pairing-at-source.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

<body>

  <div class="container">
    <header id="header">
	<div id = site_title>
		<a href="https://scaleoutsean.github.io/">
			<h2 style="font-size:1.8em;">Acting Technologist</h2>
		</a>
		
		<h3>
			civilizations are created by individuals
		</h3>
		
	</div>

	<div id="subheader">
		
		<nav class="pages">
<a href="/about.html">About</a>

<a href="/archive.html">Archive</a>

<a href="/categories/">Categories</a>

<a href="/projects.html">Projects</a>
</nav>
		
		
		<nav class="social">
			
  
    <a href="https://www.github.com/scaleoutsean" target="_blank" id="github"><i class="fab fa-github" aria-hidden="true"></i></a>
  
   

  
    <a href="https://twitter.com/scaleoutsean" target="_blank" id="twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a>
  
   

  
  
    <a href="/feed.xml" target="_blank" id="rss"><i class="fas fa-rss" aria-hidden="true"></i></a>
   

		</nav>
		
	</div>
</header>


    <div class="post-container">
      <article id = "post">
        <h1 id = "post-title">Increase size of SolidFire volumes paired for replication</h1>

  
  <div class = "post-info">
    <span>
        <i class="far fa-calendar" aria-hidden="true"></i> <span>28 Jun 2024</span> - <i class="far fa-clock"></i> 


  
  
    6 minute read
  

    </span>
  </div>
  
        <ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#situation">Situation</a></li>
  <li><a href="#procedure">Procedure</a></li>
  <li><a href="#kubernetes">Kubernetes</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
  <li><a href="#appendix-a---upsize-remote-and-resize-in-longhorny">Appendix A - upsize remote and resize in Longhorny</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>You’ve paired two volumes at the source and the destination cluster, and now you need to grow their size.</p>

<p>This post reviews how to do that correctly on SolidFire.</p>

<h2 id="situation">Situation</h2>

<p>Source: volume ID 136 (5GB) is asynchronously replicated to the same-sized “target” volume at Destination.</p>

<p><img src="/assets/images/solidfire-volume-pairing-at-source.png" alt="" /></p>

<p>Destination: incoming Async replication from the source.</p>

<p><img src="/assets/images/solidfire-volume-pairing-at-destination.png" alt="" /></p>

<p>The NetApp TR (TR-4741) contains this gem to help you out:</p>

<blockquote>
  <p>The source volume should be of equal size to the target volume. If the size of the source and target volumes do not match, replication transitions to an error state.</p>
</blockquote>

<p>Uh, okay… Good to know, Pete. But 95% of the readers must be wondering how to <em>avoid</em> this problem when they need to grow a replicated volume.</p>

<p><img src="/assets/images/solidfire-volume-pairing-useless-advice.png" alt="" /></p>

<p>Clearly that’s too much to ask for: it’s an exercise for the reader, as they say.</p>

<h2 id="procedure">Procedure</h2>

<p>We’ll try the following:</p>

<ul>
  <li>Suspend replication at source</li>
  <li>Grow target volume size</li>
  <li>Grow source volume size</li>
  <li>(Optional) use filesystem tools to grow filesystem to new volume size</li>
  <li>Resume replication at source</li>
</ul>

<p>Because the volumes are already paired, we only need to use <a href="https://docs.netapp.com/us-en/element-software/api/reference_element_api_volume_pairing_order_of_operations.html">“ModifyVolumePair”</a> which RTFM says needs only be executed at the source.</p>

<p>View volume pairing by looking it up by volume ID (136) at the source. Status is “active” which tells us the pairing relationship is fine, so I won’t check from the other side.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">/home/sean</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-SFVolumePair</span><span class="w"> </span><span class="nt">-SourceVolumeID</span><span class="w"> </span><span class="nx">136</span><span class="w"> 

</span><span class="n">VolumeID</span><span class="w">                    </span><span class="p">:</span><span class="w"> </span><span class="nx">136</span><span class="w">
</span><span class="n">Name</span><span class="w">                        </span><span class="p">:</span><span class="w"> </span><span class="nx">sqldb</span><span class="w">
</span><span class="n">AccountID</span><span class="w">                   </span><span class="p">:</span><span class="w"> </span><span class="nx">13</span><span class="w">
</span><span class="n">CreateTime</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="nx">2024-03-30T15:48:37Z</span><span class="w">
</span><span class="n">VolumeConsistencyGroupUUID</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="nx">037c2c49-d6cc-4a0b-9b82-4cb287634c33</span><span class="w">
</span><span class="n">VolumeUUID</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="nx">52707066-3f85-44a6-a2a2-ebb8e7bc0ba0</span><span class="w">
</span><span class="n">EnableSnapMirrorReplication</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">False</span><span class="w">
</span><span class="n">Status</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="nx">active</span><span class="w">
</span><span class="n">Access</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="nx">readWrite</span><span class="w">
</span><span class="n">Enable512e</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="nx">True</span><span class="w">
</span><span class="n">Iqn</span><span class="w">                         </span><span class="p">:</span><span class="w"> </span><span class="nx">iqn.2010-01.com.solidfire:wcwb.sqldb.136</span><span class="w">
</span><span class="n">ScsiEUIDeviceID</span><span class="w">             </span><span class="p">:</span><span class="w"> </span><span class="nx">7763776200000088f47acc0100000000</span><span class="w">
</span><span class="n">ScsiNAADeviceID</span><span class="w">             </span><span class="p">:</span><span class="w"> </span><span class="nx">6f47acc1000000007763776200000088</span><span class="w">
</span><span class="n">Qos</span><span class="w">                         </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"MinIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="s2">"MaxIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w"> </span><span class="s2">"BurstIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="s2">"BurstTime"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">}</span><span class="w">
</span><span class="n">QosPolicyID</span><span class="w">                 </span><span class="p">:</span><span class="w"> </span><span class="nx">1</span><span class="w">
</span><span class="n">VolumeAccessGroups</span><span class="w">          </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="w">
</span><span class="n">VolumePairs</span><span class="w">                 </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">sql-replica</span><span class="p">}</span><span class="w">
</span><span class="n">DeleteTime</span><span class="w">                  </span><span class="p">:</span><span class="w"> 
</span><span class="n">PurgeTime</span><span class="w">                   </span><span class="p">:</span><span class="w"> 
</span><span class="n">LastAccessTime</span><span class="w">              </span><span class="p">:</span><span class="w"> </span><span class="nx">2024-06-16T16:07:04Z</span><span class="w">
</span><span class="n">LastAccessTimeIO</span><span class="w">            </span><span class="p">:</span><span class="w"> </span><span class="nx">2024-06-16T16:07:04Z</span><span class="w">
</span><span class="n">SliceCount</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="nx">1</span><span class="w">
</span><span class="n">TotalSize</span><span class="w">                   </span><span class="p">:</span><span class="w"> </span><span class="nx">5000658944</span><span class="w">
</span><span class="n">BlockSize</span><span class="w">                   </span><span class="p">:</span><span class="w"> </span><span class="nx">4096</span><span class="w">
</span><span class="n">VirtualVolumeID</span><span class="w">             </span><span class="p">:</span><span class="w"> 
</span><span class="n">Attributes</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="p">{[</span><span class="n">SfQosId</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]}</span><span class="w">
</span><span class="n">CurrentProtectionScheme</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="nx">singleHelix</span><span class="w">
</span><span class="n">PreviousProtectionScheme</span><span class="w">    </span><span class="p">:</span><span class="w"> 
</span><span class="n">FifoSize</span><span class="w">                    </span><span class="p">:</span><span class="w"> </span><span class="nx">5</span><span class="w">
</span><span class="n">MinFifoSize</span><span class="w">                 </span><span class="p">:</span><span class="w"> </span><span class="nx">0</span><span class="w">
</span></code></pre></div></div>

<p>Modify the relationship by manually pausing replication at the source.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Set-SFVolumePair</span><span class="w"> </span><span class="nt">-VolumeID</span><span class="w"> </span><span class="nx">136</span><span class="w"> </span><span class="nt">-PausedManual</span><span class="p">:</span><span class="nv">$True</span><span class="w"> 
</span></code></pre></div></div>

<p>Now we can increase the size of both the source and target. Total size given above is 5000658944 bytes. Let’s add 4,000 in 4096 byte blocks = 16384000 bytes. New size: 5000658944 + 16384000 = 5017042944 bytes.</p>

<p>Resizing the destination volume is <strong>the only operation that needs to be done at the destination</strong>.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">/home/sean</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Set-SFVolume</span><span class="w"> </span><span class="nt">-VolumeID</span><span class="w"> </span><span class="nx">11</span><span class="w"> </span><span class="nt">-TotalSize</span><span class="w"> </span><span class="nx">5017042944</span><span class="w">

</span><span class="n">Confirm</span><span class="w">
</span><span class="nx">Are</span><span class="w"> </span><span class="nx">you</span><span class="w"> </span><span class="nx">sure</span><span class="w"> </span><span class="nx">you</span><span class="w"> </span><span class="nx">want</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">perform</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">action</span><span class="nf">?</span><span class="w">
</span><span class="nx">Performing</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">operation</span><span class="w"> </span><span class="s2">"SetSFVolume"</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="s2">"192.168.1.34 {"</span><span class="nx">VolumeID</span><span class="s2">" = 11}"</span><span class="o">.</span><span class="w">
</span><span class="p">[</span><span class="n">Y</span><span class="p">]</span><span class="w"> </span><span class="n">Yes</span><span class="w">  </span><span class="p">[</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="n">Yes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">All</span><span class="w">  </span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="w"> </span><span class="n">No</span><span class="w">  </span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">All</span><span class="w">  </span><span class="p">[</span><span class="n">S</span><span class="p">]</span><span class="w"> </span><span class="n">Suspend</span><span class="w">  </span><span class="p">[</span><span class="nf">?</span><span class="p">]</span><span class="w"> </span><span class="n">Help</span><span class="w"> </span><span class="p">(</span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">):</span><span class="w"> </span><span class="n">y</span><span class="w">

</span><span class="n">VolumeID</span><span class="w">                    </span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="w">
</span><span class="n">Name</span><span class="w">                        </span><span class="p">:</span><span class="w"> </span><span class="n">sql</span><span class="nt">-replica</span><span class="w">
</span><span class="n">AccountID</span><span class="w">                   </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="n">CreateTime</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="nt">-06-14T16</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">26</span><span class="n">Z</span><span class="w">
</span><span class="nx">VolumeConsistencyGroupUUID</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="nx">c413905b-54c5-48d1-80a2-e4fa563b59a8</span><span class="w">
</span><span class="n">VolumeUUID</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="n">c74bf578</span><span class="nt">-c7d8-4959-9562-cce73a62a86d</span><span class="w">
</span><span class="n">EnableSnapMirrorReplication</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="w">
</span><span class="n">Status</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="n">active</span><span class="w">
</span><span class="n">Access</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="n">replicationTarget</span><span class="w">
</span><span class="n">Enable512e</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="n">True</span><span class="w">
</span><span class="n">Iqn</span><span class="w">                         </span><span class="p">:</span><span class="w"> </span><span class="n">iqn.</span><span class="mi">2010</span><span class="nt">-01</span><span class="o">.</span><span class="nf">com</span><span class="o">.</span><span class="nf">solidfire</span><span class="p">:</span><span class="n">xh67.sql</span><span class="nt">-replica</span><span class="o">.</span><span class="nf">11</span><span class="w">
</span><span class="n">ScsiEUIDeviceID</span><span class="w">             </span><span class="p">:</span><span class="w"> </span><span class="mi">786836370000000</span><span class="n">bf47acc0100000000</span><span class="w">
</span><span class="n">ScsiNAADeviceID</span><span class="w">             </span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="n">f47acc100000000786836370000000b</span><span class="w">
</span><span class="n">Qos</span><span class="w">                         </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"MinIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="s2">"MaxIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1500</span><span class="p">,</span><span class="w"> </span><span class="s2">"BurstIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1500</span><span class="p">,</span><span class="w"> </span><span class="s2">"BurstTime"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">}</span><span class="w">
</span><span class="n">QosPolicyID</span><span class="w">                 </span><span class="p">:</span><span class="w"> 
</span><span class="n">VolumeAccessGroups</span><span class="w">          </span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="n">VolumePairs</span><span class="w">                 </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">sqldb</span><span class="p">}</span><span class="w">
</span><span class="n">DeleteTime</span><span class="w">                  </span><span class="p">:</span><span class="w"> 
</span><span class="n">PurgeTime</span><span class="w">                   </span><span class="p">:</span><span class="w"> 
</span><span class="n">LastAccessTime</span><span class="w">              </span><span class="p">:</span><span class="w"> 
</span><span class="n">LastAccessTimeIO</span><span class="w">            </span><span class="p">:</span><span class="w"> 
</span><span class="n">SliceCount</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="nx">1</span><span class="w">
</span><span class="n">TotalSize</span><span class="w">                   </span><span class="p">:</span><span class="w"> </span><span class="nx">5017436160</span><span class="w">

</span></code></pre></div></div>

<p>Now repeat this <strong>on the source side</strong> for the pair, where the volume is readWrite.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">/home/sean</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Set-SFVolume</span><span class="w"> </span><span class="nt">-VolumeID</span><span class="w"> </span><span class="nx">136</span><span class="w"> </span><span class="nt">-TotalSize</span><span class="w"> </span><span class="nx">5017042944</span><span class="w">                  

</span><span class="n">Confirm</span><span class="w">
</span><span class="nx">Are</span><span class="w"> </span><span class="nx">you</span><span class="w"> </span><span class="nx">sure</span><span class="w"> </span><span class="nx">you</span><span class="w"> </span><span class="nx">want</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">perform</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">action</span><span class="nf">?</span><span class="w">
</span><span class="nx">Performing</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">operation</span><span class="w"> </span><span class="s2">"SetSFVolume"</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="s2">"192.168.1.30 {"</span><span class="nx">VolumeID</span><span class="s2">" = 136}"</span><span class="o">.</span><span class="w">
</span><span class="p">[</span><span class="n">Y</span><span class="p">]</span><span class="w"> </span><span class="n">Yes</span><span class="w">  </span><span class="p">[</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="n">Yes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">All</span><span class="w">  </span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="w"> </span><span class="n">No</span><span class="w">  </span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">All</span><span class="w">  </span><span class="p">[</span><span class="n">S</span><span class="p">]</span><span class="w"> </span><span class="n">Suspend</span><span class="w">  </span><span class="p">[</span><span class="nf">?</span><span class="p">]</span><span class="w"> </span><span class="n">Help</span><span class="w"> </span><span class="p">(</span><span class="n">default</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">):</span><span class="w"> </span><span class="n">Y</span><span class="w"> 

</span><span class="n">VolumeID</span><span class="w">                    </span><span class="p">:</span><span class="w"> </span><span class="mi">136</span><span class="w">
</span><span class="n">Name</span><span class="w">                        </span><span class="p">:</span><span class="w"> </span><span class="n">sqldb</span><span class="w">
</span><span class="n">AccountID</span><span class="w">                   </span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="w">
</span><span class="n">CreateTime</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="nt">-03-30T15</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">37</span><span class="n">Z</span><span class="w">
</span><span class="nx">VolumeConsistencyGroupUUID</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="nx">037c2c49-d6cc-4a0b-9b82-4cb287634c33</span><span class="w">
</span><span class="n">VolumeUUID</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="mi">52707066</span><span class="nt">-3f85-44a6-a2a2-ebb8e7bc0ba0</span><span class="w">
</span><span class="n">EnableSnapMirrorReplication</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">False</span><span class="w">
</span><span class="n">Status</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="n">active</span><span class="w">
</span><span class="n">Access</span><span class="w">                      </span><span class="p">:</span><span class="w"> </span><span class="n">readWrite</span><span class="w">
</span><span class="n">Enable512e</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="n">True</span><span class="w">
</span><span class="n">Iqn</span><span class="w">                         </span><span class="p">:</span><span class="w"> </span><span class="n">iqn.</span><span class="mi">2010</span><span class="nt">-01</span><span class="o">.</span><span class="nf">com</span><span class="o">.</span><span class="nf">solidfire</span><span class="p">:</span><span class="n">wcwb.sqldb.</span><span class="mi">136</span><span class="w">
</span><span class="n">ScsiEUIDeviceID</span><span class="w">             </span><span class="p">:</span><span class="w"> </span><span class="mi">7763776200000088</span><span class="n">f47acc0100000000</span><span class="w">
</span><span class="n">ScsiNAADeviceID</span><span class="w">             </span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="n">f47acc1000000007763776200000088</span><span class="w">
</span><span class="n">Qos</span><span class="w">                         </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"MinIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="s2">"MaxIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w"> </span><span class="s2">"BurstIOPS"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="s2">"BurstTime"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">}</span><span class="w">
</span><span class="n">QosPolicyID</span><span class="w">                 </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="n">VolumeAccessGroups</span><span class="w">          </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="w">
</span><span class="n">VolumePairs</span><span class="w">                 </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">sql-replica</span><span class="p">}</span><span class="w">
</span><span class="n">DeleteTime</span><span class="w">                  </span><span class="p">:</span><span class="w"> 
</span><span class="n">PurgeTime</span><span class="w">                   </span><span class="p">:</span><span class="w"> 
</span><span class="n">LastAccessTime</span><span class="w">              </span><span class="p">:</span><span class="w"> </span><span class="nx">2024-06-16T16:07:04Z</span><span class="w">
</span><span class="n">LastAccessTimeIO</span><span class="w">            </span><span class="p">:</span><span class="w"> </span><span class="nx">2024-06-16T16:07:04Z</span><span class="w">
</span><span class="n">SliceCount</span><span class="w">                  </span><span class="p">:</span><span class="w"> </span><span class="nx">1</span><span class="w">
</span><span class="n">TotalSize</span><span class="w">                   </span><span class="p">:</span><span class="w"> </span><span class="nx">5017436160</span><span class="w">

</span></code></pre></div></div>

<p>Now each side in the pair has the identical and larger TotalSize property (5017436160 bytes).</p>

<p>We could immediately resume replication, but in most cases you will want to resize the filesystem first. I mean at the source, obviously, because the destination is a replica at there’s no need to touch contents of the replica volume.</p>

<p>Technically you can resume replication now and resize the filesystem later, it’s just that the added capacity won’t be visible to filesystem until the filesystem has been resized.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">/home/sean</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-SFVolumePair</span><span class="w"> </span><span class="nt">-SourceVolumeID</span><span class="w"> </span><span class="nx">136</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Select-Object</span><span class="w"> </span><span class="nt">-Property</span><span class="w"> </span><span class="nx">TotalSize</span><span class="w">

 </span><span class="n">TotalSize</span><span class="w">
 </span><span class="o">---------</span><span class="w">
</span><span class="mi">5017436160</span><span class="w">

</span><span class="n">PS</span><span class="w"> </span><span class="nx">/home/sean</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Set-SFVolumePair</span><span class="w"> </span><span class="nt">-VolumeID</span><span class="w"> </span><span class="nx">136</span><span class="w"> </span><span class="nt">-PausedManual</span><span class="p">:</span><span class="nv">$False</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">-PausedManual:$False</code> is enough to unpause the state and minutes later replication should be back to normal.</p>

<h2 id="kubernetes">Kubernetes</h2>

<p>In a Kubernetes environment, if resizing is allowed in the StorageClass, editing the PVC claim is enough to resize the volume and filesystem at the source. But the remote volume would still remain undersized, so that the volume pair’s replication would enter error state. To avoid that, you need to resize the destination volume as well.</p>

<p>Because in Trident CSI PVCs you probably use larger units like 20G or 20Gi rather than bytes (which is allowed, but not common), you can use the SoliFire UI to pick the same size at the destination, or maybe a CLI utility that changes the destination first and gives you the amount of bytes to use in PVC at the source side. That way you don’t have to use the UI if you can accomplish everything from the CLI.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Whether it’s Kubernetes or something else, it’s best to first manually pause replication for the volume at the source, resize the volume at the destination, then at the source, and finally resume volume replication from the source.</p>

<p>You may also want to confirm each cluster has enough capacity to allow new storage growth, and take a snapshot with few hours of retention time before each step described above.</p>

<h2 id="appendix-a---upsize-remote-and-resize-in-longhorny">Appendix A - upsize remote and resize in Longhorny</h2>

<p>Two actions have been added to <a href="https://github.com/scaleoutsean/longhorny">Longhorny</a>:</p>

<ul>
  <li>resize</li>
  <li>upsize-remote</li>
</ul>

<p>Resize adds the specified amount in bytes to both paired volumes. Longhorny can’t resize the filesystem for the user, so that part has to be done manually (only at the source side, since the destination will receive updated volume data thanks to replication).</p>

<p>Upsize remote, as the name suggests, looks up the source volume size, grows the destination volume to the same size, and resumes replication. Its main use case is to make it easy to recover replication relationships broken by Trident CSI volume expand feature.</p>


      </article>
    </div>
    
      <div class="categories">
    <span><p>Categories:</p>
    
    
      <a href="
      /categories/#storage">storage</a>
      &nbsp; 
    
      <a href="
      /categories/#solidfire">solidfire</a>
      &nbsp; 
    
      <a href="
      /categories/#automation">automation</a>
       
    
  </span>
</div>
    

  
    <div>
      <h3>Related Posts</h3>
      <ul>
      
        <li><a href="/2024/07/02/solidfire-volume-attributes-from-trident-and-other-apps.html">Extract SolidFire volume attributes created by Trident or other apps</a></li>
      
        <li><a href="/2022/01/01/getting-solidfire-volume-details-python-powershell-api-cli.html">Getting SolidFire volume details with Powershell and Python</a></li>
      
        <li><a href="/2024/04/01/windows-server-2025-with-solidfire-part-two-sql-server-2022.html">Windows Server 2025 with NetApp SolidFire 12 iSCSI Part Two</a></li>
      
        <li><a href="/2024/03/31/windows-server-2025-with-solidfire-part-one.html">Windows Server 2025 with NetApp SolidFire 12 iSCSI</a></li>
      
        <li><a href="/2021/06/22/solidfire-backup-and-cloning-with-per-storage-node-queues.html">Maximum parallelization of SolidFire Backup and Volume Copy/Clone jobs</a></li>
      
      </ul>
    </div>
  

    
  </div><footer class= "footer">
    <p>2024-10-10 17:11 </p>
    <p>Copyright © 2024 scaleoutSean. Content is released under the CC BY license. Design: Alessio Franceschi</p>
</footer>

</body>
</html>
