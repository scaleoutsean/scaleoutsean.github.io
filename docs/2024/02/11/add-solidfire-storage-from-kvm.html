<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Add NetApp SolidFire iSCSI storage to KVM | Acting Technologist</title>
<meta name="description" content="Overview of SolidFire-related storage options for KVM">


  <meta name="author" content="scaleoutSean">
  
  <meta property="article:author" content="scaleoutSean">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Acting Technologist">
<meta property="og:title" content="Add NetApp SolidFire iSCSI storage to KVM">
<meta property="og:url" content="https://scaleoutsean.github.io/2024/02/11/add-solidfire-storage-from-kvm.html">


  <meta property="og:description" content="Overview of SolidFire-related storage options for KVM">





  <meta name="twitter:site" content="@scaleoutSean">
  <meta name="twitter:title" content="Add NetApp SolidFire iSCSI storage to KVM">
  <meta name="twitter:description" content="Overview of SolidFire-related storage options for KVM">
  <meta name="twitter:url" content="https://scaleoutsean.github.io/2024/02/11/add-solidfire-storage-from-kvm.html">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2024-02-11T00:00:00+08:00">






<link rel="canonical" href="https://scaleoutsean.github.io/2024/02/11/add-solidfire-storage-from-kvm.html">







  <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />


  <meta name="msvalidate.01" content="7cf5b7d96a77410a8ad035f764dc81b3">





<!-- end _includes/seo.html -->


<meta name="bingbot" content="noindex,noarchive,nofollow">


  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Acting Technologist Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic" rel="stylesheet" type="text/css">


  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/scaleoutsean-acting-technologist.png" alt="Acting Technologist"></a>
        
        <a class="site-title" href="/">
          Acting Technologist
          <span class="site-subtitle">human action through technology</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/archive/"
                
                
              >Archive</a>
            </li><li class="masthead__menu-item">
              <a
                href="/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/projects.html"
                
                
              >Projects</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Add NetApp SolidFire iSCSI storage to KVM">
    <meta itemprop="description" content="Overview of SolidFire-related storage options for KVM">
    <meta itemprop="datePublished" content="2024-02-11T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://scaleoutsean.github.io/2024/02/11/add-solidfire-storage-from-kvm.html" itemprop="url">Add NetApp SolidFire iSCSI storage to KVM
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2024-02-11T00:00:00+08:00">2024-02-11 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#storage-options-exposed-in-virtual-manager">Storage options exposed in Virtual Manager</a>
    <ul>
      <li><a href="#filesystem-directory">Filesystem directory</a></li>
      <li><a href="#physical-disk-device">Physical disk device</a></li>
      <li><a href="#preformatted-block-device">Preformatted block device</a></li>
      <li><a href="#iscsi-target">iSCSI target</a></li>
      <li><a href="#lvm">LVM</a></li>
      <li><a href="#mpath">mpath</a></li>
      <li><a href="#zfs-pool">ZFS pool</a></li>
    </ul>
  </li>
  <li><a href="#conclusion">Conclusion</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>Continuing from the previous post on <a href="/2024/02/07/migrate-netapp-hci-from-vmware.html">hypervisor OS alternatives for NetApp HCI</a>, this post reviews storage options from KVM with SolidFire.</p>

<h2 id="storage-options-exposed-in-virtual-manager">Storage options exposed in Virtual Manager</h2>

<p>When adding storage to KVM using Virtual Manager, you'll see the following options.</p>

<p><img src="/assets/images/kvm-add-storage-solidfire-01.png" alt="" /></p>

<p>Below you can find my comments on some of them.</p>

<p>There are no "best practices" for this - in one case one may be better than the rest, in another some other option may be better.</p>

<p>You may also have a diverse virtualization environment with several different approaches (e.g. one for VDI, another for HA clusters).</p>

<h3 id="filesystem-directory">Filesystem directory</h3>

<p><img src="/assets/images/kvm-add-storage-solidfire-02-fs-directory.png" alt="" /></p>

<p>Obviously, a SolidFire disk won't be accessible at a directory unless it's already logged in to, formatted, and mounted.</p>

<p>If you have that and it works for you then it is fine. I generally use that in my "static" non-HA environments, do not partition volumes, and I format them with XFS.</p>

<h3 id="physical-disk-device">Physical disk device</h3>

<p><img src="/assets/images/kvm-add-storage-solidfire-03-physical-disk-device.png" alt="" /></p>

<p>I've no idea why I would use this. Oracle RAC, perhaps? Who knows!</p>

<h3 id="preformatted-block-device">Preformatted block device</h3>

<p><img src="/assets/images/kvm-add-storage-solidfire-04-preformatted-block-device.png" alt="" /></p>

<p>I guess this is like vRDM in VMware and can be used to expose pass-through block devices to VM for boot from iSCSI and such?</p>

<p>By the way, you can boot KVM VMs from iSCSI (I have a video on YouTube), but it's been a while since I tried or heard about anyone who needs that.</p>

<h3 id="iscsi-target">iSCSI target</h3>

<p><img src="/assets/images/kvm-add-storage-solidfire-05-iscsi-target.png" alt="" /></p>

<p>Why bother with this?</p>

<p>Because an iSCSI device may be specified by one of: device ID, label, partition label, partition UUID, path, UUID.</p>

<p>That also means it's easy to view the SolidFire volume the same way from another KVM host. That may make it easier to manage multiple KVM hosts attached to SolidFire. The same iSCSI device ID will be visible the same way on another KVM host logged into the same SolidFire target.</p>

<p>Another reason may be if you have a bunch of different on-demand requirements, so you can't pick one in advance: whereas "filesystem directory" works fine, it has pre-determined filesystem and formatting options. If you want to set these on demand, then using iSCSI targets is better.</p>

<h3 id="lvm">LVM</h3>

<p><img src="/assets/images/kvm-add-storage-solidfire-06-lvm.png" alt="" /></p>

<p>LVM group requires an OS with LVM2. If you don't have an LVM group, SolidFire devices must be available and then you can provide a list like so:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;source&gt;</span>
    <span class="nt">&lt;device</span> <span class="na">path=</span><span class="s">"/dev/sdb"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;device</span> <span class="na">path=</span><span class="s">"/dev/sdc"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/source&gt;</span>
</code></pre></div></div>

<p>It's generally better to use stable device names, such as labels (single host) or device IDs (HA clusters). Look under /dev/disk/by-path or /dev/disk/by-id.</p>

<p>If you start with LVM ready to go, you'd first expose SolidFire disks to a KVM host or hosts, and then (one host first) configure LVM groups identically, unmount, disconnect, then <a href="https://access.redhat.com/solutions/4123">import that configuration on another host</a>. So, this is a bit complicated.</p>

<p>You may want to use this if you want to create KVM volumes larger than 16 TiB, or if you expect to need to frequently resize underlying LVM group, for example.</p>

<h3 id="mpath">mpath</h3>

<p><img src="/assets/images/kvm-add-storage-solidfire-07-mpath.png" alt="" /></p>

<p>If you prefer to access and directly multi-path devices. And who doesn't, right?</p>

<p>Well, I don't.</p>

<p>Because then I have to also manage Device Mapper. Why bother? I prefer to configure iSCSI NICs into an LACP bond and have a single but redundant path to the volume.</p>

<h3 id="zfs-pool">ZFS pool</h3>

<p><img src="/assets/images/kvm-add-storage-solidfire-08-zfs-pool.png" alt="" /></p>

<p>ZFS has some nice management features that you cannot get from SolidFire.</p>

<p>But - just like with multi-path above - I never use it unless I have to. Why, because I don't want to have another thing to manage.</p>

<p>When would I use ZFS? Maybe for VMs with containers, or certain types of developer workstations.</p>

<p>As I said in the <a href="/2022/04/05/proxmox-solidfire.html">Proxmox</a> post, using ZFS with compression enabled may result in a <em>higher</em> storage consumption on SolidFire because instead of deduplicating ZFS data across all KVM systems, snapshots, clones, you end up scrambling block hashes and diminishing storage efficiency. This isn't to say it's impossible to save SolidFire storage capacity with ZFS compression enabled - probably there are scenarios in which it is possible - but just test your use case before you commit because it may not save capacity while still wasting KVM hosts' CPU and memory resources.</p>

<p>Like with LVM, you can provide a list of constituent disks, it's best to use stable device names. ZFS packages must be available on the host.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Filesystem directory (with SolidFire volumes formatted and mounted consistently across all KVM systems involved in your configuration) is an okay approach, especially if you configure systems with something like Terraform or Ansible so that your configuration is identical on all hosts.</p>

<p>Then you can use HA for VMs and that can work as well as any other option.</p>

<p>For DevOps, containers, and &gt;16TiB volumes, I'd also look at LVM (XFS) and ZFS (with compression disabled).</p>

<p>If you're interested in using SolidFire iSCSI devices from KVM in a consistent manner, you can reference <a href="https://github.com/scaleoutsean/solidbackup">solidbackup</a> for some examples of dealing with SolidFire iSCSI.</p>

<p>I have some additional notes on KVM with SolidFire in the <a href="/2022/04/05/proxmox-solidfire.html">Proxmox</a> post mentioned above.</p>

<p>You may find more about the KVM storage options and considerations for each <a href="https://libvirt.org/storage.html">here</a>.</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/hci" class="page__taxonomy-item p-category" rel="tag">hci</a><span class="sep">, </span>
    
      <a href="/tags/kvm" class="page__taxonomy-item p-category" rel="tag">kvm</a><span class="sep">, </span>
    
      <a href="/tags/netapp-hci" class="page__taxonomy-item p-category" rel="tag">netapp hci</a><span class="sep">, </span>
    
      <a href="/tags/proxmox" class="page__taxonomy-item p-category" rel="tag">proxmox</a><span class="sep">, </span>
    
      <a href="/tags/solidfire" class="page__taxonomy-item p-category" rel="tag">solidfire</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/solidfire" class="page__taxonomy-item p-category" rel="tag">solidfire</a><span class="sep">, </span>
    
      <a href="/categories/storage" class="page__taxonomy-item p-category" rel="tag">storage</a><span class="sep">, </span>
    
      <a href="/categories/virtualization" class="page__taxonomy-item p-category" rel="tag">virtualization</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2024-02-11T00:00:00+08:00">2024-02-11 00:00</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?via=scaleoutSean&text=Add+NetApp+SolidFire+iSCSI+storage+to+KVM%20https%3A%2F%2Fscaleoutsean.github.io%2F2024%2F02%2F11%2Fadd-solidfire-storage-from-kvm.html" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://scaleoutsean.github.io/2024/02/11/add-solidfire-storage-from-kvm.html" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>

</section>


      
  <nav class="pagination">
    
      <a href="/2024/02/07/migrate-netapp-hci-from-vmware.html" class="pagination--pager" title="How to change NetApp HCI from VMware to alternatives">Previous</a>
    
    
      <a href="/2024/02/15/storagegrid-on-vmware.html" class="pagination--pager" title="NetApp StorageGRID on VMware">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/31/epa-version-3-dot-5.html" rel="permalink">EPA version 3.5.0
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-31T00:00:00+08:00">2025-08-31 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">What's new in EPA v3.5.0
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/27/epa-version-3-dot-4-dot-1.html" rel="permalink">EPA version 3.4.1
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-27T00:00:00+08:00">2025-08-27 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">What's new in EPA v3.4.1
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/24/epa-version-3-dot-4.html" rel="permalink">EPA version 3.4.0
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-24T00:00:00+08:00">2025-08-24 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">What's new in EPA v3.4.0
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/20/econfig-v2-updates.html" rel="permalink">E-Config v2 updated for QLC drives
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-20T00:00:00+08:00">2025-08-20 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I got carried away while making overdue updates to E-Config and added a new feature
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2020-2025 scaleoutSean.github.io | <a href="https://scaleoutsean.github.io">Acting Technologist</a> | Terms: <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank">CC BY 4.0</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
