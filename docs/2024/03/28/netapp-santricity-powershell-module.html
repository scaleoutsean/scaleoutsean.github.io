<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8">
    <meta http-equiv="content-language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="googlebot" content="noarchive">
    <meta name="googlebot" content="max-snippet:60">
    <meta name="googlebot" content="max-image-preview:small">
    <meta name="bingbot" content="noarchive">
    <meta name="bingbot" content="max-snippet:60">
    <meta name="bingbot" content="max-image-preview:small">
    <meta name="robots" content="noarchive">
    <meta name="robots" content="max-snippet:60">
    <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />
    <title>
        
            NetApp SANtricity PowerShell module for E-Series | Acting Technologist
      
    </title>
    <meta name="description" content="
     Get and use PowerShell 5.1 module for NetApp SANtricity (E-series, EF-Series)
     ">

    <!-- LINK TO ATOM FEED FOR SEO -->
    <link rel="alternate" type="application/atom+xml" href="https://scaleoutsean.github.io/feed.xml" />

    <!-- FAVICON -->
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

    <link href="/_pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script>
    <div id="search"></div>
    <script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ element: "#search" });
        });
    </script>

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>NetApp SANtricity PowerShell module for E-Series | Acting Technologist</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="NetApp SANtricity PowerShell module for E-Series" />
<meta name="author" content="scaleoutSean" />
<meta property="og:locale" content="en" />
<meta name="description" content="Get and use PowerShell 5.1 module for NetApp SANtricity (E-series, EF-Series)" />
<meta property="og:description" content="Get and use PowerShell 5.1 module for NetApp SANtricity (E-series, EF-Series)" />
<link rel="canonical" href="https://scaleoutsean.github.io/2024/03/28/netapp-santricity-powershell-module.html" />
<meta property="og:url" content="https://scaleoutsean.github.io/2024/03/28/netapp-santricity-powershell-module.html" />
<meta property="og:site_name" content="Acting Technologist" />
<meta property="og:image" content="https://scaleoutsean.github.io/assets/images/netapp_eseries_santricity_powershell_module_01.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-03-28T00:00:00+08:00" />
<script type="application/ld+json">
{"headline":"NetApp SANtricity PowerShell module for E-Series","dateModified":"2024-03-28T00:00:00+08:00","datePublished":"2024-03-28T00:00:00+08:00","image":"https://scaleoutsean.github.io/assets/images/netapp_eseries_santricity_powershell_module_01.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://scaleoutsean.github.io/2024/03/28/netapp-santricity-powershell-module.html"},"author":{"@type":"Person","name":"scaleoutSean"},"@type":"BlogPosting","url":"https://scaleoutsean.github.io/2024/03/28/netapp-santricity-powershell-module.html","description":"Get and use PowerShell 5.1 module for NetApp SANtricity (E-series, EF-Series)","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

<body>

  <div class="container">
    <header id="header">
	<div id = site_title>
		<a href="https://scaleoutsean.github.io/">
			<h2 style="font-size:1.8em;">Acting Technologist</h2>
		</a>
		
		<h3>
			civilizations are created by individuals
		</h3>
		
	</div>

	<div id="subheader">
		
		<nav class="pages">
<a href="/about.html">About</a>

<a href="/archive.html">Archive</a>

<a href="/categories/">Categories</a>

<a href="/projects.html">Projects</a>
</nav>
		
		
		<nav class="social">
			
  
    <a href="https://www.github.com/scaleoutsean" target="_blank" id="github"><i class="fab fa-github" aria-hidden="true"></i></a>
  
   

  
    <a href="https://twitter.com/scaleoutsean" target="_blank" id="twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a>
  
   

  
  
    <a href="/feed.xml" target="_blank" id="rss"><i class="fas fa-rss" aria-hidden="true"></i></a>
   

		</nav>
		
	</div>
</header>


    <div class="post-container">
      <article id = "post">
        <h1 id = "post-title">NetApp SANtricity PowerShell module for E-Series</h1>

  
  <div class = "post-info">
    <span>
        <i class="far fa-calendar" aria-hidden="true"></i> <span>28 Mar 2024</span> - <i class="far fa-clock"></i> 


  
  
    5 minute read
  

    </span>
  </div>
  
        <ul>
  <li><a href="#get-netappsantricity-module-for-powershell-51">Get NetApp.SANtricity module for PowerShell 5.1</a></li>
  <li><a href="#install-and-load">Install and load</a></li>
  <li><a href="#use">Use</a></li>
  <li><a href="#end">End</a></li>
  <li><a href="#appendix-a---known-issues--workarounds">Appendix A - Known issues \&amp; workarounds</a></li>
</ul>

<h2 id="get-netappsantricity-module-for-powershell-51">Get NetApp.SANtricity module for PowerShell 5.1</h2>

<p>The problem is you can’t. Or maybe you can, but it’s not easy.</p>

<p>It appears it was deprecated some time ago and removed from NetApp downloads.</p>

<p>I don’t know if the file is available on the Internet, but you should be able to ask NetApp Support to share it with you.</p>

<p>Here’s the file and SHA256 hash of the installer I used<a href="https://pub-b36e83914b354d7d9986e006905799c0.r2.dev/eseries-powershell-module-01.40.002.3000.zip">.</a></p>

<pre><code class="language-raw">Algorithm: SHA256
Hash: 69B1A05948A5D14880D1CC0546833CB9913D5B28D8F78DA2EAF0A0827B9C6AA3
Path: SANtricity_PowerShell_Module_01.40.0002.3000.exe  
</code></pre>

<p>The package is digitally signed by NetApp, by the way.</p>

<h2 id="install-and-load">Install and load</h2>

<p>I think this old module can work only with PowerShell 5.1 (and not PS Core), but the good news is Microsoft keeps that version around so I was able to install it on Windows 11 without any workarounds.</p>

<p>By default, it is installed to <code class="language-plaintext highlighter-rouge">C:\Program Files\NetApp\Modules\NetApp.SANtricity.PowerShell\</code>.</p>

<p>Start PowerShell 5.1 and check your modules:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\sean</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-Module</span><span class="w">

</span><span class="n">ModuleType</span><span class="w"> </span><span class="nx">Version</span><span class="w">    </span><span class="nx">Name</span><span class="w">                                </span><span class="nx">ExportedCommands</span><span class="w">                                                                                               
</span><span class="o">----------</span><span class="w"> </span><span class="o">-------</span><span class="w">    </span><span class="o">----</span><span class="w">                                </span><span class="o">----------------</span><span class="w">                                                                                               
</span><span class="n">Script</span><span class="w">     </span><span class="nx">1.0.0.0</span><span class="w">    </span><span class="nx">ISE</span><span class="w">                                 </span><span class="p">{</span><span class="n">Get-IseSnippet</span><span class="p">,</span><span class="w"> </span><span class="nx">Import-IseSnippet</span><span class="p">,</span><span class="w"> </span><span class="nx">New-IseSnippet</span><span class="p">}</span><span class="w">                                                            
</span><span class="n">Manifest</span><span class="w">   </span><span class="nx">3.1.0.0</span><span class="w">    </span><span class="nx">Microsoft.PowerShell.Management</span><span class="w">     </span><span class="p">{</span><span class="n">Add-Computer</span><span class="p">,</span><span class="w"> </span><span class="nx">Add-Content</span><span class="p">,</span><span class="w"> </span><span class="nx">Checkpoint-Computer</span><span class="p">,</span><span class="w"> </span><span class="nx">Clear-Content...</span><span class="p">}</span><span class="w">                                             
</span><span class="n">Manifest</span><span class="w">   </span><span class="nx">3.0.0.0</span><span class="w">    </span><span class="nx">Microsoft.PowerShell.Security</span><span class="w">       </span><span class="p">{</span><span class="n">ConvertFrom-SecureString</span><span class="p">,</span><span class="w"> </span><span class="nx">ConvertTo-SecureString</span><span class="p">,</span><span class="w"> </span><span class="nx">Get-Acl</span><span class="p">,</span><span class="w"> </span><span class="nx">Get-AuthenticodeSignature...</span><span class="p">}</span><span class="w">                      
</span><span class="n">Manifest</span><span class="w">   </span><span class="nx">3.1.0.0</span><span class="w">    </span><span class="nx">Microsoft.PowerShell.Utility</span><span class="w">        </span><span class="p">{</span><span class="n">Add-Member</span><span class="p">,</span><span class="w"> </span><span class="nx">Add-Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Clear-Variable</span><span class="p">,</span><span class="w"> </span><span class="nx">Compare-Object...</span><span class="p">}</span><span class="w">                                                      
</span><span class="n">Manifest</span><span class="w">   </span><span class="nx">3.0.0.0</span><span class="w">    </span><span class="nx">Microsoft.WSMan.Management</span><span class="w">          </span><span class="p">{</span><span class="n">Connect-WSMan</span><span class="p">,</span><span class="w"> </span><span class="nx">Disable-WSManCredSSP</span><span class="p">,</span><span class="w"> </span><span class="nx">Disconnect-WSMan</span><span class="p">,</span><span class="w"> </span><span class="nx">Enable-WSManCredSSP...</span><span class="p">}</span><span class="w"> 
</span></code></pre></div></div>

<p>That’s fine, you can edit <code class="language-plaintext highlighter-rouge">$env:PSModulePath</code> and refer to it from scripts, or simply import on demand.</p>

<p>Note that in this part below you need elevated privileges aka “Run as Administrator”.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Import-Module</span><span class="w"> </span><span class="s2">"C:\Program Files\NetApp\Modules\NetApp.SANtricity.PowerShell\NetApp.SANtricity.Functions.psm1"</span><span class="w">

</span><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-Module</span><span class="w">

</span><span class="n">ModuleType</span><span class="w"> </span><span class="nx">Version</span><span class="w">    </span><span class="nx">Name</span><span class="w">                                </span><span class="nx">ExportedCommands</span><span class="w">                                                                                               
</span><span class="o">----------</span><span class="w"> </span><span class="o">-------</span><span class="w">    </span><span class="o">----</span><span class="w">                                </span><span class="o">----------------</span><span class="w">                                                                                               
</span><span class="n">Script</span><span class="w">     </span><span class="nx">1.0.0.0</span><span class="w">    </span><span class="nx">ISE</span><span class="w">                                 </span><span class="p">{</span><span class="n">Get-IseSnippet</span><span class="p">,</span><span class="w"> </span><span class="nx">Import-IseSnippet</span><span class="p">,</span><span class="w"> </span><span class="nx">New-IseSnippet</span><span class="p">}</span><span class="w">                                                            
</span><span class="n">Manifest</span><span class="w">   </span><span class="nx">3.1.0.0</span><span class="w">    </span><span class="nx">Microsoft.PowerShell.Management</span><span class="w">     </span><span class="p">{</span><span class="n">Add-Computer</span><span class="p">,</span><span class="w"> </span><span class="nx">Add-Content</span><span class="p">,</span><span class="w"> </span><span class="nx">Checkpoint-Computer</span><span class="p">,</span><span class="w"> </span><span class="nx">Clear-Content...</span><span class="p">}</span><span class="w">                                             
</span><span class="n">Manifest</span><span class="w">   </span><span class="nx">3.1.0.0</span><span class="w">    </span><span class="nx">Microsoft.PowerShell.Utility</span><span class="w">        </span><span class="p">{</span><span class="n">Add-Member</span><span class="p">,</span><span class="w"> </span><span class="nx">Add-Type</span><span class="p">,</span><span class="w"> </span><span class="nx">Clear-Variable</span><span class="p">,</span><span class="w"> </span><span class="nx">Compare-Object...</span><span class="p">}</span><span class="w">                                                      
</span><span class="n">Script</span><span class="w">     </span><span class="nx">0.0</span><span class="w">        </span><span class="nx">NetApp.SANtricity.Functions</span><span class="w">         </span><span class="p">{</span><span class="n">Get-NeBuildinfo</span><span class="p">,</span><span class="w"> </span><span class="nx">Get-NeCommands</span><span class="p">,</span><span class="w"> </span><span class="nx">Get-NeEventLogDebug</span><span class="p">,</span><span class="w"> </span><span class="nx">Get-NeKeyValue...</span><span class="p">}</span><span class="w">                                      
</span><span class="n">Binary</span><span class="w">     </span><span class="nx">1.1.0.0</span><span class="w">    </span><span class="nx">PSScheduledJob</span><span class="w">                      </span><span class="p">{</span><span class="n">Add-JobTrigger</span><span class="p">,</span><span class="w"> </span><span class="nx">Disable-JobTrigger</span><span class="p">,</span><span class="w"> </span><span class="nx">Disable-ScheduledJob</span><span class="p">,</span><span class="w"> </span><span class="nx">Enable-JobTrigger...</span><span class="p">}</span><span class="w">  
</span></code></pre></div></div>

<p>NetApp.SANtricity.Functions and PSScheduledJob modules have been imported. (And yeah, that SANtricity module is not versioned.)</p>

<h2 id="use">Use</h2>

<p>In the late 2010s I created two simple demos (you can find them on YouTube, try searching for SANtricity PowerShell).</p>

<p>Fortunately, there’s been no updates since then, so those very already likely showcase the latest and greatest (what I’m using in this post).</p>

<p>For that and other reasons I’ll just show cmdlets available in the module:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Windows\system32</span><span class="err">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">Get-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">NetApp.SANtricity.Functions</span><span class="p">)</span><span class="o">.</span><span class="nf">exportedCommands</span><span class="p">)</span><span class="o">.</span><span class="nf">Keys</span><span class="w">
</span><span class="n">Get-NeBuildinfo</span><span class="w">
</span><span class="nx">Get-NeCommands</span><span class="w">
</span><span class="n">Get-NeEventLogDebug</span><span class="w">
</span><span class="nx">Get-NeKeyValue</span><span class="w">
</span><span class="n">Get-NeModuleinfo</span><span class="w">
</span><span class="nx">Get-NeProxyCredential</span><span class="w">
</span><span class="n">New-NeCredential</span><span class="w">
</span><span class="nx">New-NeKeyValue</span><span class="w">
</span><span class="n">Send-NeAutoSupportData</span><span class="w">
</span><span class="nx">Set-NeEventLogDebug</span><span class="w">
</span><span class="n">Start-NeAutoSupport</span><span class="w">
</span><span class="nx">Get-NeAsyncMirrorGroups</span><span class="w">
</span><span class="n">Get-NeAsyncMirrorGroupStorageSystems</span><span class="w">
</span><span class="nx">Get-NeAsyncMirrorIncompletePairs</span><span class="w">
</span><span class="n">Get-NeAsyncMirrorPairs</span><span class="w">
</span><span class="nx">Get-NeAsyncMirrorPairsRepositoryUtilization</span><span class="w">
</span><span class="n">Get-NeAvailableMelEvents</span><span class="w">
</span><span class="nx">Get-NeConcatRepositoryVolumes</span><span class="w">
</span><span class="n">Get-NeConsistencyGroup</span><span class="w">
</span><span class="nx">Get-NeConsistencyGroupMember</span><span class="w">
</span><span class="n">Get-NeConsistencyGroupSnapshots</span><span class="w">
</span><span class="nx">Get-NeConsistencyGroupViews</span><span class="w">
</span><span class="n">Get-NeConsistencyGroupViewVolumes</span><span class="w">
</span><span class="nx">Get-NeDeviceAlertsConfig</span><span class="w">
</span><span class="n">Get-NeEthernetInterfaces</span><span class="w">
</span><span class="nx">Get-NeFirmwareFiles</span><span class="w">
</span><span class="n">Get-NeFirmwareUpgrade</span><span class="w">
</span><span class="nx">Get-NeRemoteMirrorSyncProgress</span><span class="w">
</span><span class="n">Get-NeRemoteMirrorVolumeCandidates</span><span class="w">
</span><span class="nx">Get-NeSnapshot</span><span class="w">
</span><span class="n">Get-NeStorageSystemFromFolder</span><span class="w">
</span><span class="nx">Get-NeSyslogConfig</span><span class="w">
</span><span class="n">Get-NeValidateConfig</span><span class="w">
</span><span class="nx">Get-NeVolumeExpansion</span><span class="w">
</span><span class="n">Get-NeVolumeGroupExpansionCandidates</span><span class="w">
</span><span class="nx">Get-NeVolumeGroupReductionCount</span><span class="w">
</span><span class="n">New-NeAsyncMirrorGroups</span><span class="w">
</span><span class="nx">New-NeAsyncMirrorPairs</span><span class="w">
</span><span class="n">New-NeConsistencyGroup</span><span class="w">
</span><span class="nx">New-NeConsistencyGroupMember</span><span class="w">
</span><span class="n">New-NeConsistencyGroupSnapshots</span><span class="w">
</span><span class="nx">New-NeConsistencyGroupViews</span><span class="w">
</span><span class="n">New-NeConsistencyGroupViewsBatch</span><span class="w">
</span><span class="nx">New-NeSnapshot</span><span class="w">
</span><span class="n">Remove-NeAsyncMirrorGroups</span><span class="w">
</span><span class="nx">Remove-NeAsyncMirrorIncompletePairs</span><span class="w">
</span><span class="n">Remove-NeAsyncMirrorPairs</span><span class="w">
</span><span class="nx">Remove-NeConsistencyGroup</span><span class="w">
</span><span class="n">Remove-NeConsistencyGroupMember</span><span class="w">
</span><span class="nx">Remove-NeConsistencyGroupSnapshots</span><span class="w">
</span><span class="n">Remove-NeConsistencyGroupViews</span><span class="w">
</span><span class="nx">Remove-NeSnapshot</span><span class="w">
</span><span class="n">Set-NeResumeAsyncMirrorGroup</span><span class="w">
</span><span class="nx">Set-NeResumeFlashCache</span><span class="w">
</span><span class="n">Set-NeSuspendAsyncMirrorPair</span><span class="w">
</span><span class="nx">Set-NeSuspendFlashCache</span><span class="w">
</span><span class="n">Set-NeSyncAsyncMirrorPair</span><span class="w">
</span><span class="nx">Test-NeSendTestEmail</span><span class="w">
</span><span class="n">Test-NeSendTestSyslogMessages</span><span class="w">
</span><span class="nx">Test-NeTestAsyncMirrorConnectivity</span><span class="w">
</span><span class="n">Test-NeTestRemoteMirrorCommunication</span><span class="w">
</span><span class="nx">Update-NeActivateFirmwareUpgrade</span><span class="w">
</span><span class="n">Update-NeAddDrivesToFlashCache</span><span class="w">
</span><span class="nx">Update-NeAsyncMirrorGroups</span><span class="w">
</span><span class="n">Update-NeAsyncMirrorIncompletePairs</span><span class="w">
</span><span class="nx">Update-NeConcatRepositoriesFromMutipleVolumes</span><span class="w">
</span><span class="n">Update-NeConcatRepositoriesFromSingleVolume</span><span class="w">
</span><span class="nx">Update-NeConfigureFalshCache</span><span class="w">
</span><span class="n">Update-NeConsistencyGroup</span><span class="w">
</span><span class="nx">Update-NeConsistencyGroupMember</span><span class="w">
</span><span class="n">Update-NeConsistencyGroupMemberBatch</span><span class="w">
</span><span class="nx">Update-NeConvertToReadWriteSnapshotVolume</span><span class="w">
</span><span class="n">Update-NeDeviceAlertsConfig</span><span class="w">
</span><span class="nx">Update-NeDownloadFirmwareUpgrade</span><span class="w">
</span><span class="n">Update-NeEthernetInterfaces</span><span class="w">
</span><span class="nx">Update-NeExpandConcatRepositoryVolume</span><span class="w">
</span><span class="n">Update-NeFirmwareUpgrade</span><span class="w">
</span><span class="nx">Update-NeInitializeThinVolume</span><span class="w">
</span><span class="n">Update-NeInitializeVolume</span><span class="w">
</span><span class="nx">Update-NeMoveHost</span><span class="w">
</span><span class="n">Update-NeMoveVolumeMappings</span><span class="w">
</span><span class="nx">Update-NeReloadFirmwareUpgrade</span><span class="w">
</span><span class="n">Update-NeRemoveDrivesFromFlashCache</span><span class="w">
</span><span class="nx">Update-NeRollbackCgSnapshot</span><span class="w">
</span><span class="n">Update-NeSyslogConfig</span><span class="w">
</span><span class="nx">Update-NeThinVolumeExpansion</span><span class="w">
</span><span class="n">Update-NeValidateConfig</span><span class="w">
</span><span class="nx">Update-NeVolumeExpansion</span><span class="w">
</span><span class="n">Update-NeVolumeGroupExpansion</span><span class="w">
</span></code></pre></div></div>

<p>Connect directly (better) or through SANtricity Web Services Proxy (okay, but I don’t like it).</p>

<p>If you decide to use the WSP you need to add the array to it.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># $ManagementIpAddresses is a list (one for each controller)</span><span class="w">
</span><span class="c"># URL would be the URL to your WSP API endpoint</span><span class="w">
</span><span class="nv">$ManagementIpAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1.2.3.4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"5.6.7.8"</span><span class="w">
</span><span class="nv">$Url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">https://woo.hoo:8082</span><span class="w">
</span><span class="c"># it appears this assumes both WSP and controller have the same $cred</span><span class="w">
</span><span class="c">#    - use $cred1 and $cred2 if that's not the case</span><span class="w">
</span><span class="nv">$cred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-NeProxyCredential</span><span class="w"> </span><span class="nt">-Url</span><span class="w"> </span><span class="nv">$Url</span><span class="w"> </span><span class="nt">-ProxyUser</span><span class="w"> </span><span class="nv">$user</span><span class="w"> </span><span class="nt">-ProxyPwd</span><span class="w"> </span><span class="nv">$pwd</span><span class="w">
</span><span class="err">$</span><span class="p">(</span><span class="n">New-NeStorageSystem</span><span class="w"> </span><span class="nt">-Cred</span><span class="w"> </span><span class="nv">$cred</span><span class="w"> </span><span class="nt">-ControllerAddresses</span><span class="w"> </span><span class="nv">$ManagementIpAddresses</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out-Null</span><span class="w">
</span><span class="nx">Start-sleep</span><span class="w"> </span><span class="nx">5</span><span class="w">  </span><span class="c"># let the proxy connect to back-end array</span><span class="w">
</span><span class="c"># ip1 would be the first controller in the WSP response</span><span class="w">
</span><span class="n">ss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-NeStorageSystem</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$cred</span><span class="w"> </span><span class="o">|</span><span class="nf">?</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">ip1</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$ManagementIpAddresses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w">

</span><span class="c"># $ss will have the name and ID of the added array: $ss.Name and $ss.Id</span><span class="w">

</span></code></pre></div></div>

<p>After that you’d connect <em>through</em> the proxy.</p>

<p>Users who <em>do not use</em> the WSP would go directly to (one of) the controllers. In that case you’d skip the step of adding the array, you’d instead just connect.</p>

<p>Here’s <a href="https://www.youtube.com/watch?v=7JmfXDZS6nI">one of the old YouTube videos</a> that show a demo of that.</p>

<p>As I recall from using the API directly, Bearer Token has to be reissued - it may not be synced across the controllers, so keep that in mind.</p>

<h2 id="end">End</h2>

<p>On the laptop where I can connect to E-Series, I couldn’t even import the modules because of “security”.</p>

<p>The installation and module loading steps were confirmed to work on a Windows outside my restricted environment, but I don’t have E-Series there so I couldn’t actually try using the module this time.</p>

<p>In the recent years I’ve been using the SANtricity API directly, which is why I lost track of this module.</p>

<p>Using the API is not that hard, but for me the added convenience is a big plus as I can run my E-Series/SANtricity scripts using any PowerShell version, and on both Linux and Windows. Compared to SolidFire - which has an amazing PowerShell module - SANtricity functions aren’t super easy to use, so I would encourage you to use the API directly unless you have old scripts which work well for you.</p>

<h2 id="appendix-a---known-issues--workarounds">Appendix A - Known issues &amp; workarounds</h2>

<p>I found these in a SANtricty document from 2018… Don’t know if these have been fixed in subsequent releases, but maybe this will save you time so…</p>

<ul>
  <li>Get-NeAuditLog cmdlet - Fails with a return response of “Value cannot be null” referencing a parameter named disposition. Workaround: Use the SANtricity Web Services API endpoint (and GET /storage-system/{system-id}/audit-log) instead of Get-NeAuditLog</li>
  <li>Get-NeLocalUsersInfo cmdlet - The returned value for minimumPasswordLength field is null. Future new releases of the SANtricity OS will return a valid value for the field. Workaround: Upgrade to the next release of SANtricity OS when available.</li>
  <li>Update-NeExternalKeyServerCertificateCsr cmdlet- An exception will be thrown only if required parameters are used for the cmdlet, no optional parameters. Workaround: Use the cmdlet with all required and optional parameters.</li>
  <li>Get-NeLdapRoles cmdlet - Typo in the synopsis statement on the get-help output for the cmdlet.</li>
  <li>Update-NeSslconfigReset cmdlet - Typo in the synopsis statement on the get-help output for the cmdlet.</li>
</ul>

      </article>
    </div>
    
      <div class="categories">
    <span><p>Categories:</p>
    
    
      <a href="
      /categories/#storage">storage</a>
      &nbsp; 
    
      <a href="
      /categories/#automation">automation</a>
       
    
  </span>
</div>
    

    
      <div class="related" data-pagefind-ignore>

    <h4>Possibly related - use live search at the top to find other content</h4>
    
    
    
    
    
    
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/23/grafana-11-netapp-solidfire-sfc.html">• NetApp SolidFire Collector with Grafana 11</a></h5>
          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/23/econfig-update.html">• EConfig v2</a></h5>
          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/11/netapp-eseries-containerized-beegfs-nfs-s3-all-in-one.html">• NetApp E-Series with containerized BeeGFS, NFS, S3</a></h5>
          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/09/solidbackup-velero-backup-non-k8s-volumes-netapp-solidfire-to-s3.html">• Backup NetApp SolidFire's non-Kubernetes volumes with Velero</a></h5>
          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/02/storagegrid-networking.html">• NetApp StorageGRID networks</a></h5>
          </div>
          
          
            
    
    </div>

    

    
  </div><footer class= "footer">
    <p>2024-04-23 19:13 </p>
    <p>Copyright © 2024 scaleoutSean. Content is released under the CC BY license. Design: Alessio Franceschi</p>
</footer>

</body>
</html>
