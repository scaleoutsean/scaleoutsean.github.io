<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Hybrid cloud scenarios with Cloudflare serverless | Acting Technologist</title>
<meta name="description" content="Opportunities for a better hybrid cloud architecture with Cloudflare">


  <meta name="author" content="scaleoutSean">
  
  <meta property="article:author" content="scaleoutSean">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Acting Technologist">
<meta property="og:title" content="Hybrid cloud scenarios with Cloudflare serverless">
<meta property="og:url" content="https://scaleoutsean.github.io/2022/09/29/cloudflare-serverless.html">


  <meta property="og:description" content="Opportunities for a better hybrid cloud architecture with Cloudflare">





  <meta name="twitter:site" content="@scaleoutSean">
  <meta name="twitter:title" content="Hybrid cloud scenarios with Cloudflare serverless">
  <meta name="twitter:description" content="Opportunities for a better hybrid cloud architecture with Cloudflare">
  <meta name="twitter:url" content="https://scaleoutsean.github.io/2022/09/29/cloudflare-serverless.html">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2022-09-29T00:00:00+08:00">






<link rel="canonical" href="https://scaleoutsean.github.io/2022/09/29/cloudflare-serverless.html">







  <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />


  <meta name="msvalidate.01" content="7cf5b7d96a77410a8ad035f764dc81b3">





<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Acting Technologist Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic" rel="stylesheet" type="text/css">


  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/scaleoutsean-acting-technologist.png" alt="Acting Technologist"></a>
        
        <a class="site-title" href="/">
          Acting Technologist
          <span class="site-subtitle">human action through technology</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/archive/"
                
                
              >Archive</a>
            </li><li class="masthead__menu-item">
              <a
                href="/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/projects.html"
                
                
              >Projects</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Hybrid cloud scenarios with Cloudflare serverless">
    <meta itemprop="description" content="Opportunities for a better hybrid cloud architecture with Cloudflare">
    <meta itemprop="datePublished" content="2022-09-29T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://scaleoutsean.github.io/2022/09/29/cloudflare-serverless.html" itemprop="url">Hybrid cloud scenarios with Cloudflare serverless
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-09-29T00:00:00+08:00">2022-09-29 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#cloudflare-scenarios-for-hybrid-cloud-users">Cloudflare scenarios for Hybrid Cloud users</a></li>
  <li><a href="#experiment">Experiment</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>Cloudflare is building a better infrastructure for Hybrid Cloud:</p>

<ul>
  <li>Simpler (less cognitive overload)</li>
  <li>Lower cost</li>
  <li>Better-performing</li>
  <li>Architecturally sound (in my opinion)</li>
</ul>

<p>I wanted to illustrate and comment on currently or soon-to-be available options from a perspective of on-premises storage options.</p>

<h2 id="cloudflare-scenarios-for-hybrid-cloud-users">Cloudflare scenarios for Hybrid Cloud users</h2>

<p>What we can do with it today as far as <strong>hybrid</strong> cloud deployments are concerned?</p>

<p>Before we begin, we should understand Cloudflare Workers. If we don't have time to do that, let's just say those are stateless, short-lived Node.JS-like containers.</p>

<p>We can run Workers and use Cloudflare Zero Trust services (there's Tunnel, etc.) to connect to on-premises infrastructure. There's also Algo Smart Routing to optimize routing and latency.</p>

<p><img src="/assets/images/cloudflare-stateless-with-all-storage-on-prem.png" alt="Cloudflare Workers with on-prem data and applications" /></p>

<p>Note on SMB and NFS: these services would not be used from containers, but by external application users who need access to NFS or SMB when - for example - applications simply cannot be containerized. An example can be seen <a href="https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/use_cases/smb/#connect-to-smb-server-with-warp-to-tunnel">here</a>. For example, something like this:</p>

<p><img src="/assets/images/cloudflare-stateless-with-all-storage-on-prem-mobile.png" alt="Cloudflare Workers with on-prem data and applications used by mobile users" /></p>

<p>Would this approach be too slow? I don't think it would be too slow for small workloads. You wouldn't be able to use Workers to run SAP HANA this way, but many applications (maybe 50%) consume just a few hundred IOPS.</p>

<p>I haven't done any benchmarking of these use cases, but I have no doubt this is feasible for smaller applications. Last year I tested bandwidth and latency from my home lab to a nearby hyperscaler and it was 30 MB/s and just a few milliseconds, respectively. For database workloads that is as fast as small RAID array with 10K RPM SAS disks.</p>

<p>And, since Workers has recently been open-sourced, I think users will be able to run their Workers apps on-premises as well.</p>

<p>I think this approach is much simpler than with hyperscalers - Cloudflare takes care of all the network "magic" for you, and some additional services not mentioned here are competitively priced or even free.</p>

<p>Cloudflare object storage called R2 has GA'd recently. That opens up additional possibilities. Enterprises can keep their object data on-premises and replicate it to Cloudflare R2. Or just move all their object storage to R2.</p>

<p><img src="/assets/images/cloudflare-stateless-cloud-object-on-prem-file-r-w-db.png" alt="Cloudflare Workers with some data in Cloudflare object storage and database replicas" /></p>

<p>If object storage is updated and replicated to R2, this again makes it possible to run applications on-premises and in the cloud - just write and delete objects in the read-write location (whether that's R2 or on-prem S3) and replicate to the read-only location.</p>

<p>I made a small variation on the on-prem DB type - if you prefer to use HTTPS to connect from workers, that's also possible with RESTful plugins or native RESTful databases.</p>

<p>Workers with read-heavy workloads can take advantage of SQLite read-only replicas. Like with distributed objects, we can write to on-premises DB and replicate it to Cloudflare by pushing updates to D1, Cloudflare's SQLite service. That could work in reverse, too - one could collect IoT data in D1 and use Workers to replicate data to SQLite or other databases on-premises.</p>

<p><img src="/assets/images/cloudflare-stateless-state-in-r2-and-ro-db.png" alt="Cloudflare Workers with some data in Cloudflare object storage" /></p>

<p>D1 is not GA yet, but it will lets users run distributed SQLite completely within Cloudflare, accessible to Workers in read-write fashion.</p>

<p>Like with R2 and Workers today, it will be possible to have applications and data only on Cloudflare, but this post has focused on hybrid use cases where for whatever reasons, some data and workloads live on-premises (or in any hyperscaler or other public cloud provider, for that matter). Storing data-at-rest on premises may be cheaper or not, but it has a different data sovereignty profile and egress is almost always cheaper compared to public cloud.</p>

<h2 id="experiment">Experiment</h2>

<p>I haven't used Cloudflare Workers to build a hybrid cloud application which uses on-prem data.</p>

<p>At this time I have a light-weight worker application (an E-Series sizer) up and running in Workers but its data is self-contained and it could also run client-side (using client-side JavaScript rather than Worker-side), so it doesn't showcase many unique features of CloudFlare serverless - for now all you get is a container that quickly starts on-demand and renders JS server-side.</p>

<p>With the ability to offload I/O to R2 and soon D1, I think this stack is very powerful and yet simple to understand and manage. I could make it hybrid by moving its small database to an on-prem S3 or PostgreSQL, but I haven't done that because of maintenance burden.</p>

<p>Here's how it could work:</p>

<ul>
  <li>JavaScript-powered application uploaded to on-premises S3 storage or running in Workers with server-side rendering (like my E-Series sizer)
    <ul>
      <li>For S3-based static apps with JS, use Cloudflare DNS and Web Proxy map external TLD to proxy on-premises S3 app - application is cached by Cloudflare and runs client-side in the browser</li>
      <li>For Workers-based apps, application runs in Cloudflare Workers and uses on-prem data (S3 or SQL)</li>
    </ul>
  </li>
  <li>Between Cloudflare Web Proxy and on-premises data set up Reverse Proxy for logging, authentication, security (this can be a Cloudflare service, or DIY on-prem)</li>
</ul>

<p><img src="/assets/images/cloudflare-proxy.png" alt="Cloudflare DNS with Web Proxy" /></p>

<ul>
  <li>On-premises PostgreSQL Docker container with RESTful API exposed to the Web via Cloudflare Zero Trust (Tunnel). Alternatively consider Cloudflare Argo to avoid exposing database to the Internet and/or your external clients.</li>
</ul>

<p><img src="/assets/images/cloudflare-restful-database.png" alt="Cloudflare DNS with Web Proxy" /></p>

<p>We could connect from the Web app directly to an on-prem database by opening on-prem firewall to authenticated and authorized users, but then we'd have to take care of network security by ourselves.</p>

<p>This approach above only exposes our S3 bucket (which is read-only) to Cloudflare Web Proxy, and the application can contain authentication and authorization code. PostgreSQL database is not directly exposed to the Internet (it's RESTful HTTPS, proxied by Cloudflare, but can use Argo instead) and it allows access to only authenticated Web application users.</p>

<h2 id="conclusion">Conclusion</h2>

<p>I'm not a big fan of how applications are deployed to hyperscalers: it's either lift &amp; shift, which usually doesn't result in improvements, or highly proprietary. Even with Kubernetes, many staff "specialize" in individual hyperscaler's flavor of managed Kubernetes service and can't easily combine it with, or migrate to, another Kubernetes service elsewhere. And then there are all sorts of complex fees - FinOps, proprietary and non-portable network and identity management, etc.</p>

<p>Cloudflare focuses on Web-related services (no Big Data solutions for now) that are simple to understand, open, affordable and most importantly, done right. If I had all my applications in one hyperscaler, I'd look for opportunities to move some services to Cloudflare rather than another hyperscaler (although that is sometimes unavoidable due to the need to use hyperscaler-specific applications).</p>

<p>I look forward to increased awareness and adoption of Cloudflare services among hybrid and public cloud users.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/cloudflare" class="page__taxonomy-item p-category" rel="tag">cloudflare</a><span class="sep">, </span>
    
      <a href="/tags/containers" class="page__taxonomy-item p-category" rel="tag">containers</a><span class="sep">, </span>
    
      <a href="/tags/hybrid-cloud" class="page__taxonomy-item p-category" rel="tag">hybrid cloud</a><span class="sep">, </span>
    
      <a href="/tags/netapp" class="page__taxonomy-item p-category" rel="tag">netapp</a><span class="sep">, </span>
    
      <a href="/tags/solidfire" class="page__taxonomy-item p-category" rel="tag">solidfire</a><span class="sep">, </span>
    
      <a href="/tags/workers" class="page__taxonomy-item p-category" rel="tag">workers</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/cloud" class="page__taxonomy-item p-category" rel="tag">cloud</a><span class="sep">, </span>
    
      <a href="/categories/storage" class="page__taxonomy-item p-category" rel="tag">storage</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-09-29T00:00:00+08:00">2022-09-29 00:00</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?via=scaleoutSean&text=Hybrid+cloud+scenarios+with+Cloudflare+serverless%20https%3A%2F%2Fscaleoutsean.github.io%2F2022%2F09%2F29%2Fcloudflare-serverless.html" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://scaleoutsean.github.io/2022/09/29/cloudflare-serverless.html" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>

</section>


      
  <nav class="pagination">
    
      <a href="/2022/09/27/beegfs-csi-nomad-kubernetes.html" class="pagination--pager" title="Speed of volume creation with BeeGFS CSI">Previous</a>
    
    
      <a href="/2022/09/30/velero-backup-192.html" class="pagination--pager" title="Velero 1.9 with AWS and CSI plugins for ARM64">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/09/04/sfc-solidfire-collector-v2-dot-1-dot-0.html" rel="permalink">SolidFire Collector v2.1.0
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-09-04T00:00:00+08:00">2025-09-04 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Stack complete and tagged
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/31/epa-version-3-dot-5.html" rel="permalink">EPA version 3.5.0
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-31T00:00:00+08:00">2025-08-31 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">What's new in EPA v3.5.0
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/27/epa-version-3-dot-4-dot-1.html" rel="permalink">EPA version 3.4.1
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-27T00:00:00+08:00">2025-08-27 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">What's new in EPA v3.4.1
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/08/24/epa-version-3-dot-4.html" rel="permalink">EPA version 3.4.0
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-08-24T00:00:00+08:00">2025-08-24 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">What's new in EPA v3.4.0
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2020-2025 scaleoutSean.github.io | <a href="https://scaleoutsean.github.io">Acting Technologist</a> | Terms: <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank">CC BY 4.0</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
