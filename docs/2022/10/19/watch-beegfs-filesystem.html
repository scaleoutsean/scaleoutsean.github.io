<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>BeeGFS filesystem event monitoring with watcher | Acting Technologist</title>
<meta name="description" content="Simple way to watch file and directory changes on BeeGFS clients">


  <meta name="author" content="scaleoutSean">
  
  <meta property="article:author" content="scaleoutSean">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Acting Technologist">
<meta property="og:title" content="BeeGFS filesystem event monitoring with watcher">
<meta property="og:url" content="https://scaleoutsean.github.io/2022/10/19/watch-beegfs-filesystem.html">


  <meta property="og:description" content="Simple way to watch file and directory changes on BeeGFS clients">





  <meta name="twitter:site" content="@scaleoutSean">
  <meta name="twitter:title" content="BeeGFS filesystem event monitoring with watcher">
  <meta name="twitter:description" content="Simple way to watch file and directory changes on BeeGFS clients">
  <meta name="twitter:url" content="https://scaleoutsean.github.io/2022/10/19/watch-beegfs-filesystem.html">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2022-10-19T00:00:00+08:00">






<link rel="canonical" href="https://scaleoutsean.github.io/2022/10/19/watch-beegfs-filesystem.html">







  <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />


  <meta name="msvalidate.01" content="7cf5b7d96a77410a8ad035f764dc81b3">





<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Acting Technologist Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic" rel="stylesheet" type="text/css">


  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/scaleoutsean-acting-technologist.png" alt="Acting Technologist"></a>
        
        <a class="site-title" href="/">
          Acting Technologist
          <span class="site-subtitle">human action through technology</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/archive/"
                
                
              >Archive</a>
            </li><li class="masthead__menu-item">
              <a
                href="/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/projects.html"
                
                
              >Projects</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="BeeGFS filesystem event monitoring with watcher">
    <meta itemprop="description" content="Simple approach to watch file and directory changes on BeeGFS clients">
    <meta itemprop="datePublished" content="2022-10-19T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://scaleoutsean.github.io/2022/10/19/watch-beegfs-filesystem.html" itemprop="url">BeeGFS filesystem event monitoring with watcher
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-10-19T00:00:00+08:00">2022-10-19 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>Maybe you've used an app (or an ONTAP feature) that makes use of the FPolicy API. FPolicy is proven in large and busy NAS environments, and has rich features and integrations for auditing, anti-ransomware protection and more. It is commercially licensed, mostly to ISVs.</p>

<p>On Linux OS there are several similar applications and most use <a href="https://en.wikipedia.org/wiki/Inotify">inotify</a>, a Linux subsystem which monitors the filesystem and sends event notifications.</p>

<p><a href="https://github.com/e-dant/watcher">watcher</a> does <em>not</em> use inotify and seems quite new, so I wanted to check it out.</p>

<p>Both inotify (in the case you pick another utility that leverages it) and watcher are permissively licensed, and may not be able to solve all your problems (let's leave it at that).</p>

<p>Normally we'd start watcher on a BeeGFS client by passing it a BeeGFS mount point like so:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./watch /mnt/beegfs
</code></pre></div></div>

<p>Now we can create some BeeGFS filesystem activity on that BeeGFS client:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">touch</span> /mnt/beegfs/test01.txt 
<span class="nv">$ </span><span class="nb">cat</span> /mnt/beegfs/test01.txt 
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"tasdfasf"</span> <span class="o">&gt;&gt;</span> /mnt/beegfs/test01.txt 
<span class="nv">$ </span><span class="nb">mv</span> /mnt/beegfs/test01.txt /mnt/beegfs/test02.txt
<span class="nv">$ </span><span class="nb">rm</span> /mnt/beegfs/test02.txt
</code></pre></div></div>

<p>Watcher output:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./watch /mnt/beegfs/
{"water.watcher.stream":{
"1666112809564097156":{"where":"/mnt/beegfs/test01.txt","what":"modify","kind":"file"},
"1666112818382373993":{"where":"/mnt/beegfs/test01.txt","what":"destroy","kind":"dir"},
"1666112818383007343":{"where":"/mnt/beegfs/test02.txt","what":"create","kind":"file"},
"1666112821797725785":{"where":"/mnt/beegfs/test02.txt","what":"destroy","kind":"dir"},
(CTRL+C)
</code></pre></div></div>

<p>Of course, this is quite basic and not very practical.  A slightly more advanced approach:</p>

<ul>
  <li>Create a watch service that runs on all BeeGFS clients and writes changes to a file</li>
  <li>Use Filebeat or other utility to read watch output and send it to Elasticsearch</li>
  <li>Use Elasticsearch to gather and analyze data from all BeeGFS clients</li>
</ul>

<p>This lets us know when what changed, but not by whom.</p>

<p>While watcher doesn't do a lot, the information it collects can be useful in various ways:</p>

<ul>
  <li>Create a queue of new and modified files to replicate or backup; to be honest I don't know how to create a query that gets a list of unique files that have been modified and created but not subsequently destroyed, but in an environment where files are only added and deleted, this query should be very simple</li>
  <li>Create a list of <em>modified</em> files; this can be useful as well, because we could use this information to overwrite a remote file replica without making a date or checksum comparison. This should be trivial for use cases where data is ingressed via a single BeeGFS client</li>
  <li>Create a search engine for file and directory names; some files may no longer exist (if they were subsequently deleted) but that should be easy to see from Elasticsearch results (<code class="language-plaintext highlighter-rouge">destroy</code> action should appear after <code class="language-plaintext highlighter-rouge">modify</code> when sorted by time (descending) and may be good enough for some use cases). We can touch all files in a directory tree to get watcher to log them and populate Elasticsearch</li>
</ul>

<p>BeeGFS has its own method of watching filesystem activity which is more advanced, gathers events from metadata servers (rather than from clients) and provides a lot more data.</p>

<p>Watcher is simple single-binary utility, but I think (I have a BeeGFS cluster with only one client in my lab) it must be deployed to all BeeGFS clients where we wish to monitor the same filesystem, so I would recommend it for simple use cases similar to what I described above.</p>

<p>If you expect to need more details, consider other, more mature Linux utilities or BeeGFS' own filesystem activity monitor (<a href="https://doc.beegfs.io/latest/advanced_topics/filesystem_modification_events.html">RTFM</a>).</p>

<p>I haven't tested watcher under a heavy workload.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/beegfs" class="page__taxonomy-item p-category" rel="tag">beegfs</a><span class="sep">, </span>
    
      <a href="/tags/fsnotify" class="page__taxonomy-item p-category" rel="tag">fsnotify</a><span class="sep">, </span>
    
      <a href="/tags/watch" class="page__taxonomy-item p-category" rel="tag">watch</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/storage" class="page__taxonomy-item p-category" rel="tag">storage</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-10-19T00:00:00+08:00">2022-10-19 00:00</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?via=scaleoutSean&text=BeeGFS+filesystem+event+monitoring+with+watcher%20https%3A%2F%2Fscaleoutsean.github.io%2F2022%2F10%2F19%2Fwatch-beegfs-filesystem.html" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://scaleoutsean.github.io/2022/10/19/watch-beegfs-filesystem.html" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>

</section>


      
  <nav class="pagination">
    
      <a href="/2022/09/30/velero-backup-192.html" class="pagination--pager" title="Velero 1.9 with AWS and CSI plugins for ARM64">Previous</a>
    
    
      <a href="/2022/10/20/beegfs-hsm-irods-robinhood.html" class="pagination--pager" title="iRODS or Robinhood HSM with BeeGFS">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2026/01/11/windows-hyper-v-netapp-eseries-santricity.html" rel="permalink">Windows Server 2025 and Hyper-V with NetApp E-Series
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2026-01-11T00:00:00+08:00">2026-01-11 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Notes on Windows Server 2025 and E-Series SANtricity arrays in iSCSI and NVMe/RoCEv2 environments
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2026/01/10/minio-aistor-eseries-patterns.html" rel="permalink">E-Series and MinIO AIStor Enterprise Lite patterns
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2026-01-10T00:00:00+08:00">2026-01-10 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Why single node clusters are now an Enterprise approach and earlier E-Series patterns stil relevant
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2026/01/10/eseries-santricity-odx-vaai.html" rel="permalink">Windows ODX with E-Series SANtricity
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2026-01-10T00:00:00+08:00">2026-01-10 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Windows Offloaded Data Transfer (ODX) with NetApp E-Series SANtricity
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2026/01/06/eseries-santricity-powershell.html" rel="permalink">santricity-powershell for Day 1+ E-Series automation
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2026-01-06T00:00:00+08:00">2026-01-06 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Replace SMcli for most Day 1+ operations
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2020-2025 scaleoutSean.github.io | <a href="https://scaleoutsean.github.io">Acting Technologist</a> | Terms: <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank">CC BY 4.0</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
