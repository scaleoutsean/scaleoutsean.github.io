<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8">
    <meta http-equiv="content-language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="googlebot" content="noarchive">
    <meta name="googlebot" content="max-snippet:60">
    <meta name="googlebot" content="max-image-preview:small">
    <meta name="bingbot" content="noarchive">
    <meta name="bingbot" content="max-snippet:60">
    <meta name="bingbot" content="max-image-preview:small">
    <meta name="robots" content="noarchive">
    <meta name="robots" content="max-snippet:60">
    <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />
    <title>
        
            Check Active IQ connectivity from HCC on SolidFire mNode | Acting Technologist
      
    </title>
    <meta name="description" content="
     Check connectivity to Active IQ from HCC on SolidFire mNode
     ">

    <!-- LINK TO ATOM FEED FOR SEO -->
    <link rel="alternate" type="application/atom+xml" href="https://scaleoutsean.github.io/feed.xml" />

    <!-- FAVICON -->
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

    <link href="/_pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script>
    <div id="search"></div>
    <script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ element: "#search" });
        });
    </script>

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Check Active IQ connectivity from HCC on SolidFire mNode | Acting Technologist</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Check Active IQ connectivity from HCC on SolidFire mNode" />
<meta name="author" content="scaleoutSean" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Check connectivity to Active IQ from HCC on SolidFire mNode" />
<meta property="og:description" content="Check connectivity to Active IQ from HCC on SolidFire mNode" />
<link rel="canonical" href="https://scaleoutsean.github.io/2022/03/11/solidfire-mnode-active-iq-connectivity.html" />
<meta property="og:url" content="https://scaleoutsean.github.io/2022/03/11/solidfire-mnode-active-iq-connectivity.html" />
<meta property="og:site_name" content="Acting Technologist" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-11T00:00:00+08:00" />
<script type="application/ld+json">
{"headline":"Check Active IQ connectivity from HCC on SolidFire mNode","dateModified":"2022-03-11T00:00:00+08:00","datePublished":"2022-03-11T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://scaleoutsean.github.io/2022/03/11/solidfire-mnode-active-iq-connectivity.html"},"author":{"@type":"Person","name":"scaleoutSean"},"@type":"BlogPosting","url":"https://scaleoutsean.github.io/2022/03/11/solidfire-mnode-active-iq-connectivity.html","description":"Check connectivity to Active IQ from HCC on SolidFire mNode","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

<body>

  <div class="container">
    <header id="header">
	<div id = site_title>
		<a href="https://scaleoutsean.github.io/">
			<h2 style="font-size:1.8em;">Acting Technologist</h2>
		</a>
		
		<h3>
			civilizations are created by individuals
		</h3>
		
	</div>

	<div id="subheader">
		
		<nav class="pages">
<a href="/about.html">About</a>

<a href="/archive.html">Archive</a>

<a href="/categories/">Categories</a>

<a href="/projects.html">Projects</a>
</nav>
		
		
		<nav class="social">
			
  
    <a href="https://www.github.com/scaleoutsean" target="_blank" id="github"><i class="fab fa-github" aria-hidden="true"></i></a>
  
   

  
    <a href="https://twitter.com/scaleoutsean" target="_blank" id="twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a>
  
   

  
  
    <a href="/feed.xml" target="_blank" id="rss"><i class="fas fa-rss" aria-hidden="true"></i></a>
   

		</nav>
		
	</div>
</header>


    <div class="post-container">
      <article id = "post">
        <h1 id = "post-title">Check Active IQ connectivity from HCC on SolidFire mNode</h1>

  
  <div class = "post-info">
    <span>
        <i class="far fa-calendar" aria-hidden="true"></i> <span>11 Mar 2022</span> - <i class="far fa-clock"></i> 


  
  
    4 minute read
  

    </span>
  </div>
  
        <p>One annoyance with Active IQ connectivity from Hybrid Cloud Control for SolidFire/NetApp HCI/eSDS is that it’s not easy to tell what’s going on with it when it doesn’t work.</p>

<p>This post is about some basic steps to check its status.</p>

<p>First we check if the container is up and running.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>docker ps <span class="nt">-a</span>
CONTAINER ID        IMAGE
612e2da2a12f        mnode-svc-aiq-collector:1.7.1
</code></pre></div></div>

<p>Then we can use HCC’s Swagger or - simpler and faster - <code class="language-plaintext highlighter-rouge">sudo docker logs ${CONTAINERID}</code> to see if there are any obvious errors.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>docker logs 612e2da2a12f
Mar 11 2022 07:48:59.214 INFO log level <span class="nb">set </span>to INFO
Mar 11 2022 07:48:59.215 INFO Attempting to retrieve auth token...
/tmp/_MEIfmppJL/urllib3/connectionpool.py:1020: InsecureRequestWarning: Unverified HTTPS request is being made to host <span class="s1">'192.168.1.34'</span><span class="nb">.</span> Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
Mar 11 2022 07:48:59.258 INFO Token received from auth service.
Mar 11 2022 07:48:59.259 INFO Attempting to retrieve asset information...
Mar 11 2022 07:48:59.275 INFO Asset information retrieved from mnode-api service.
Mar 11 2022 07:48:59.275 INFO Attempting to retrieve mnode settings...
Mar 11 2022 07:48:59.371 INFO Mnode settings retrieved from mnode-api service.
Mar 11 2022 07:48:59.378 INFO Starting collector<span class="o">(</span>s<span class="o">)</span> <span class="k">for </span>mnode
Mar 11 2022 07:48:59.378 INFO Starting collector <span class="k">for </span>mnode <span class="nv">storage_id</span><span class="o">=</span>274fb77d-5faa-4530-a713-e24209bbacc5
Mar 11 2022 07:49:00.716 INFO ListClusterFaults summary : 5 of 5 faults are new, unresolved, or newly resolved
</code></pre></div></div>

<p>The problem with this is INFO log level doesn’t give much useful information.</p>

<p>Has it connected to an Active IQ API endpoint? Has it sent any payload (even with INFO level, that should appear every 10 minutes)? Nothing.</p>

<p>It might be helpful in the case of major problems such as a proxy trying to MITM your outgoing connection. But in this case not much can be glanced from logs. I looked through the documentation on how to enable DEBUG log level, but could not find that information. So it’s time to move on.</p>

<p>With that container ID we can do some additional checking.</p>

<p>We can enter the container and check its connections.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>docker <span class="nb">exec</span> <span class="nt">-it</span> 612e2da2a12f /bin/ash
<span class="c"># netstat </span>
Active Internet connections <span class="o">(</span>w/o servers<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       
tcp        1      0 612e2da2a12f:41736      10.0.0.40:http          CLOSE_WAIT  
tcp        0      0 169.254.104.28:58326    ec2-44-239-179-120.us-west-2.compute.amazonaws.com:https ESTABLISHED 
tcp        1      0 612e2da2a12f:60332      10.0.0.20:http          CLOSE_WAIT  
tcp       70      0 169.254.104.28:56100    sfdr.datafabric.lab:https CLOSE_WAIT  
tcp        0      0 169.254.104.28:58118    sfdr.datafabric.lab:https TIME_WAIT   
Active UNIX domain sockets <span class="o">(</span>w/o servers<span class="o">)</span>
Proto RefCnt Flags       Type       State         I-Node Path
</code></pre></div></div>

<p>All right, so there’s a connection to EC2 (IPv4: 44.239…). Exit the container, and use mNode shell to check if that IP may be AIQ API endpoint:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nslookup monitoring.solidfire.com
Server:		192.168.1.4
Address:	192.168.1.4#53

Non-authoritative answer:
Name:	monitoring.solidfire.com
Address: 52.36.127.139
Name:	monitoring.solidfire.com
Address: 44.239.179.120
</code></pre></div></div>

<p>It looks that way. The second DNS result indicates our container is connected to AIQ via HTTPS and therefore we know it can get out to the Internet and connect to an Active IQ API endpoint.</p>

<p>Also on mNode, see if <a href="https://stackoverflow.com/questions/46704745/docker-stat-network-traffic">Transmit</a> on eth0 is increasing (as it tries to send data out). First we get Docker’s PID for the AIQ collector container and then watch its traffic.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>docker inspect 612e2da2a12f | <span class="nb">grep</span> <span class="s1">'"Pid":'</span>
30756

<span class="nv">$ </span><span class="nb">cat</span> /proc/30756/net/dev
Inter-|   Receive                                                |  Transmit
 face |bytes    packets errs drop fifo frame compressed multicast|bytes    packets errs drop fifo colls carrier compressed
    lo:    1686      20    0    0    0     0          0         0     1686      20    0    0    0     0       0          0
  eth1: 19009170    6125    0   24    0     0          0         0   928784    4524    0    0    0     0       0          0
  eth0:    5146      41    0    0    0     0          0         0     4956      22    0    0    0     0       0          0

<span class="nv">$ </span><span class="nb">cat</span> /proc/30756/net/dev
Inter-|   Receive                                                |  Transmit
 face |bytes    packets errs drop fifo frame compressed multicast|bytes    packets errs drop fifo colls carrier compressed
    lo:    1686      20    0    0    0     0          0         0     1686      20    0    0    0     0       0          0
  eth1: 19013079    6136    0   24    0     0          0         0   931452    4534    0    0    0     0       0          0
  eth0:    5146      41    0    0    0     0          0         0     4956      22    0    0    0     0       0          0

</code></pre></div></div>

<p>eth1 might be used for iSCSI or something, so we’d watch the NIC used for the default route (here, eth0) to see if its Transmit counter is incrementing. It’s not, but that may be because the storage is SolidFire Demo VM for which AIQ Collector probably doesn’t feed details into AIQ.</p>

<p>I don’t know what else can be done to make this easier. Potentially you could use tcpdump on mNode to watch if traffic is going to monitoring.solidfire.com:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>tcpdump <span class="nt">-i</span> eth0 44.239.179.120
dropped privs to tcpdump
tcpdump: verbose output suppressed, use <span class="nt">-v</span> or <span class="nt">-vv</span> <span class="k">for </span>full protocol decode
listening on eth0, link-type EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>, capture size 96 bytes
...
</code></pre></div></div>

<p>I happen to have this mNode configured with SF Demo VM, so I didn’t see anything and I didn’t expect it’d be sending anything. But a non-demo setup (eSDS or SolidFire or NetApp HCI) might dump traffic to Active IQ here.</p>

      </article>
    </div>
    
      <div class="categories">
    <span><p>Categories:</p>
    
    
      <a href="
      /categories/#storage">storage</a>
       
    
  </span>
</div>
    

    
      <div class="related" data-pagefind-ignore>

    <h4>Possibly related - use live search at the top to find other content</h4>
    
    
    
    
    
    
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/23/econfig-update.html">• New EConfig tools</a></h5>
          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/11/netapp-eseries-containerized-beegfs-nfs-s3-all-in-one.html">• NetApp E-Series with containerized BeeGFS, NFS, S3</a></h5>
          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/09/solidbackup-velero-backup-non-k8s-volumes-netapp-solidfire-to-s3.html">• Backup NetApp SolidFire's non-Kubernetes volumes with Velero</a></h5>
          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/02/storagegrid-networking.html">• NetApp StorageGRID networks</a></h5>
          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div class = "related-posts">
          <h5><a href="/2024/04/01/windows-server-2025-with-solidfire-part-two-sql-server-2022.html">• Windows Server 2025 with NetApp SolidFire 12 iSCSI Part Two</a></h5>
          </div>
          
          
            
    
    </div>

    

    
  </div><footer class= "footer">
    <p>2024-04-23 03:13 </p>
    <p>Copyright © 2024 scaleoutSean. Content is released under the CC BY license. Design: Alessio Franceschi</p>
</footer>

</body>
</html>
