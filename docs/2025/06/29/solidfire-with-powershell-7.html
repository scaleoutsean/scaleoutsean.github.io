<!doctype html>
<html lang="en">
  <head>
        <meta charset="UTF-8">
    <meta http-equiv="content-language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="googlebot" content="noarchive">
    <meta name="googlebot" content="max-snippet:60">
    <meta name="googlebot" content="max-image-preview:small">
    <meta name="bingbot" content="noarchive">
    <meta name="bingbot" content="max-snippet:60">
    <meta name="bingbot" content="max-image-preview:small">
    <meta name="robots" content="noarchive">
    <meta name="robots" content="max-snippet:60">
    <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />
    <title>
        
            Connecting to SolidFire from PowerShell 7.5 | Acting Technologist
      
    </title>
    <meta name="description" content="
     How to connect when Connect-SFCluster does not work
     ">

    <!-- LINK TO ATOM FEED FOR SEO -->
    <link rel="alternate" type="application/atom+xml" href="https://scaleoutsean.github.io/feed.xml" />

    <!-- FAVICON -->
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

    <link href="/_pagefind/pagefind-ui.css" rel="stylesheet">
    <script src="/_pagefind/pagefind-ui.js" type="text/javascript"></script>
    <div id="search"></div>
    <script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ element: "#search" });
        });
    </script>

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Connecting to SolidFire from PowerShell 7.5 | Acting Technologist</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Connecting to SolidFire from PowerShell 7.5" />
<meta name="author" content="scaleoutSean" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to connect when Connect-SFCluster does not work" />
<meta property="og:description" content="How to connect when Connect-SFCluster does not work" />
<link rel="canonical" href="https://scaleoutsean.github.io/2025/06/29/solidfire-with-powershell-7.html" />
<meta property="og:url" content="https://scaleoutsean.github.io/2025/06/29/solidfire-with-powershell-7.html" />
<meta property="og:site_name" content="Acting Technologist" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-06-29T00:00:00+08:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://scaleoutsean.github.io/2025/06/29/solidfire-with-powershell-7.html"},"author":{"@type":"Person","name":"scaleoutSean"},"description":"How to connect when Connect-SFCluster does not work","@type":"BlogPosting","url":"https://scaleoutsean.github.io/2025/06/29/solidfire-with-powershell-7.html","headline":"Connecting to SolidFire from PowerShell 7.5","dateModified":"2025-06-29T00:00:00+08:00","datePublished":"2025-06-29T00:00:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

<body>

  <div class="container">
    <header id="header">
	<div id = site_title>
		<a href="https://scaleoutsean.github.io/">
			<h2 style="font-size:1.8em;">Acting Technologist</h2>
		</a>
		
		<h3>
			civilizations are created by individuals
		</h3>
		
	</div>

	<div id="subheader">
		
		<nav class="pages">
<a href="/about.html">About</a>

<a href="/archive.html">Archive</a>

<a href="/categories/">Categories</a>

<a href="/projects.html">Projects</a>
</nav>
		
		
		<nav class="social">
			
  
    <a href="https://www.github.com/scaleoutsean" target="_blank" id="github"><i class="fab fa-github" aria-hidden="true"></i></a>
  
   

  
    <a href="https://twitter.com/scaleoutsean" target="_blank" id="twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a>
  
   

  
  
    <a href="/feed.xml" target="_blank" id="rss"><i class="fas fa-rss" aria-hidden="true"></i></a>
   

		</nav>
		
	</div>
</header>


    <div class="post-container">
      <article id = "post">
        <h1 id = "post-title">Connecting to SolidFire from PowerShell 7.5</h1>

  
  <div class = "post-info">
    <span>
        <i class="far fa-calendar" aria-hidden="true"></i> <span>29 Jun 2025</span> - <i class="far fa-clock"></i> 


  
  
    2 minute read
  

    </span>
  </div>
  
        <h2 id="error">Error</h2>

<p>I get this in PowerShell 7.5 on Linux (also on 7.4).</p>

<pre><code class="language-raw">Connect-SFCluster: 
Could not load file or assembly 'System.Net.Http.WebRequest, Version=4.0.0.0, 
Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
</code></pre>

<p>It’s probably due to System.Net.Http.WebRequest removed from the recent .NET packages (after being deprecated for a while before that).</p>

<h2 id="fuhgeddaboudit">Fuhgeddaboudit</h2>

<p>Just forget about it.</p>

<p>Python SDK still seems to work, but there I’ve preemptively eliminated it from recent use (example: <a href="https://github.com/scaleoutsean/sfc/">SFC</a>). I don’t use PowerShell much in programs, but I use it it scripts or from console. Well, now I can’t.</p>

<h2 id="alternatives">Alternatives</h2>

<ul>
  <li>Create a docker container with older OS and .NET library. I have one on Github.</li>
  <li>Just fugheddaboutit and write your own functions</li>
</ul>

<p>Something like this works or me (set sfApiAddress, sfAccountName, sfAccountPass).</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$sfApiEndpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'https://'</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$sfApiAddress</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'/json-rpc/12.5/'</span><span class="w">
</span><span class="nv">$headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="s1">'Authorization'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Basic '</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="p">[</span><span class="n">Convert</span><span class="p">]</span><span class="err">::</span><span class="nx">ToBase64String</span><span class="err">(</span><span class="p">[</span><span class="n">Text.Encoding</span><span class="p">]</span><span class="err">::</span><span class="nx">ASCII</span><span class="err">.</span><span class="nx">GetBytes</span><span class="err">(</span><span class="s2">"</span><span class="nv">${sfAccountName}</span><span class="s2">:</span><span class="nv">${sfAccountPass}</span><span class="s2">"</span><span class="err">))</span><span class="w">
    </span><span class="s1">'Content-Type'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'application/json'</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="nv">$sfConnection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="s1">'ApiEndpoint'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">${sfApiEndpoint}</span><span class="w">
    </span><span class="s1">'Headers'</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">${headers}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$sfApiEndpoint</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">Post</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$sfConnection</span><span class="o">.</span><span class="nf">Headers</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="s1">'{"method":"GetClusterInfo"}'</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">Stop</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Connected to SolidFire cluster </span><span class="si">$(</span><span class="nv">$response</span><span class="o">.</span><span class="nf">result</span><span class="o">.</span><span class="nf">clusterInfo</span><span class="o">.</span><span class="nf">name</span><span class="si">)</span><span class="s2"> at </span><span class="nv">${sfApiAddress}</span><span class="s2"> successfully."</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Green</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Failed to connect to SolidFire cluster at </span><span class="nv">${sfApiAddress}</span><span class="s2">: </span><span class="bp">$_</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Red</span><span class="w">
    </span><span class="kr">return</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<p>Okay… So, this works. But I’m not done with the bad news.</p>

<p>The next problem is none of the other commands work either. Why? Because you need an SFConnection which hasn’t been created.</p>

<p>“Full version” of a command: <code class="language-plaintext highlighter-rouge">Get-SFAccount -SFConnection $sfConnection</code>.</p>

<p>I tried creating a <code class="language-plaintext highlighter-rouge">SolidFire.Core.Objects.SFConnection</code> object, but I hit a</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS <span class="o">&gt;</span> Add-Type <span class="nt">-AssemblyName</span> <span class="s1">'SolidFire.Core.Objects'</span> <span class="nt">-ErrorAction</span> SilentlyContinue
Add-Type: Cannot find path <span class="s1">'SolidFire.Core.Objects.dll'</span> because it does not exist.
</code></pre></div></div>

<p>All right. Maybe I could find this DLL somewhere, add it to my environment or make a copy in current directly, but who knows what’s the next problem?</p>

<p>I’ll just drop the SolidFire Tools for PowerShell and use native PowerShell cmdlets.</p>

<p>As we have the headers already, now we can reuse them.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$sfApiEndpoint</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">Post</span><span class="w"> </span><span class="se">`
</span><span class="w">    </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$headers</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="s1">'{"method":"GetAccountByID","params":{"accountID":4}}'</span><span class="w"> </span><span class="se">`
</span><span class="w">    </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">Stop</span><span class="w">
</span></code></pre></div></div>

<p>Also, here’s the stupidest hint of the week: if <code class="language-plaintext highlighter-rouge">$sfApiEndpoint</code> is a <code class="language-plaintext highlighter-rouge">string</code> such as https://cl.ust.er/json-rpc/12.5, that will work. If it’s a real <code class="language-plaintext highlighter-rouge">Uri</code>, well… You’re not supposed to use a proper <code class="language-plaintext highlighter-rouge">Uri</code> such as <code class="language-plaintext highlighter-rouge">$sfUri = 'https://cluster.solidfire.net'</code> and add <code class="language-plaintext highlighter-rouge">'/json-rpc/12.5'</code> to that. That won’t work well for <code class="language-plaintext highlighter-rouge">-Uri</code>s because you’d end up with two forward slashes. You need to trim the invisible <code class="language-plaintext highlighter-rouge">/</code> from at the end of your Uri variable.</p>

<p><img src="/assets/images/one-does-not-simply-pass-a-uri-var-to-uri-param.jpg" alt="One does not simply pass a URI variable to -Uri param" /></p>

<h2 id="conclusion">Conclusion</h2>

<p>Lame.</p>


      </article>
    </div>
    
      <div class="categories">
    <span><p>Categories:</p>
    
    
      <a href="
      /categories/#automation">automation</a>
      &nbsp; 
    
      <a href="
      /categories/#solidfire">solidfire</a>
       
    
  </span>
</div>
    

  
    <div>
      <h3>Related Posts</h3>
      <ul>
      
        <li><a href="/2025/07/07/firemox.html">Firemox - an anti-plugin for Proxmox PVE with NetApp SolidFire</a></li>
      
        <li><a href="/2024/06/28/growing-solidfire-volumes-paired-for-replication.html">Increase size of SolidFire volumes paired for replication</a></li>
      
        <li><a href="/2024/05/20/netapp-solidfire-input-for-telegraf.html">Use Telegraf to send NetApp SolidFire metrics to InfluxDB</a></li>
      
        <li><a href="/2024/04/01/windows-server-2025-with-solidfire-part-two-sql-server-2022.html">Windows Server 2025 with NetApp SolidFire 12 iSCSI Part Two</a></li>
      
        <li><a href="/2024/03/31/windows-server-2025-with-solidfire-part-one.html">Windows Server 2025 with NetApp SolidFire 12 iSCSI</a></li>
      
      </ul>
    </div>
  

    
  </div><footer class= "footer">
    <p>2025-08-11 20:09 </p>
    <p>Copyright © 2025 scaleoutSean. Content is released under the CC BY license. Design: Alessio Franceschi</p>
</footer>

</body>
</html>
