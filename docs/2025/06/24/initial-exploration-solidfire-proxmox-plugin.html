<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Do we need a NetApp SolidFire plugin for Proxmox | Acting Technologist</title>
<meta name="description" content="Tire-kicking exercise: SolidFire plugin for Proxmox PVE">


  <meta name="author" content="scaleoutSean">
  
  <meta property="article:author" content="scaleoutSean">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Acting Technologist">
<meta property="og:title" content="Do we need a NetApp SolidFire plugin for Proxmox">
<meta property="og:url" content="https://scaleoutsean.github.io/2025/06/24/initial-exploration-solidfire-proxmox-plugin.html">


  <meta property="og:description" content="Tire-kicking exercise: SolidFire plugin for Proxmox PVE">





  <meta name="twitter:site" content="@scaleoutSean">
  <meta name="twitter:title" content="Do we need a NetApp SolidFire plugin for Proxmox">
  <meta name="twitter:description" content="Tire-kicking exercise: SolidFire plugin for Proxmox PVE">
  <meta name="twitter:url" content="https://scaleoutsean.github.io/2025/06/24/initial-exploration-solidfire-proxmox-plugin.html">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2025-06-24T00:00:00+08:00">






<link rel="canonical" href="https://scaleoutsean.github.io/2025/06/24/initial-exploration-solidfire-proxmox-plugin.html">







  <meta name="google-site-verification" content="F6q7vIwQ2G0j8tk-KL9rAXOMLXMDMMUkEz4fRs1Nnnc" />


  <meta name="msvalidate.01" content="7cf5b7d96a77410a8ad035f764dc81b3">





<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Acting Technologist Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<script src="https://cdn.counter.dev/script.js" data-id="83dc700a-b821-4e57-9425-02b8336a9456" data-utcoffset="0"></script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic" rel="stylesheet" type="text/css">


  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/scaleoutsean-acting-technologist.png" alt="Acting Technologist"></a>
        
        <a class="site-title" href="/">
          Acting Technologist
          <span class="site-subtitle">human action through technology</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/archive/"
                
                
              >Archive</a>
            </li><li class="masthead__menu-item">
              <a
                href="/categories/"
                
                
              >Categories</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/projects.html"
                
                
              >Projects</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Do we need a NetApp SolidFire plugin for Proxmox">
    <meta itemprop="description" content="Would it be hard to create a SolidFire plugin for Proxmox?">
    <meta itemprop="datePublished" content="2025-06-24T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://scaleoutsean.github.io/2025/06/24/initial-exploration-solidfire-proxmox-plugin.html" itemprop="url">Do we need a NetApp SolidFire plugin for Proxmox
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-06-24T00:00:00+08:00">2025-06-24 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          14 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <ul>
  <li><a href="#who-wants-it-and-why">Who wants it and why?</a></li>
  <li><a href="#perl-for-the-win">Perl for the win!</a></li>
  <li><a href="#features">Features</a></li>
  <li><a href="#effort">Effort</a></li>
  <li><a href="#appendix-a-what-works-and-how">Appendix A: what works and how</a></li>
  <li><a href="#appendix-b-observations-problems-solutions">Appendix B: observations, problems, solutions</a></li>
  <li><a href="#appendix-c-why-i-dont-want-a-solidfire-plugin-for-pve">Appendix C: why I don't want a SolidFire plugin for PVE</a></li>
  <li><a href="#appendix-d-corosync-101-for-casual-users">Appendix D: Corosync 101 for casual users</a></li>
</ul>

<blockquote>
  <p>"Any headline that ends in a question mark can be answered by the word no."</p>
</blockquote>

<blockquote>
  <p><a href="https://en.wikipedia.org/wiki/Betteridge%27s_law_of_headlines">Betteridge</a></p>
</blockquote>

<p>My post title doesn't even have a question mark, but I tentatively reached the same conclusion.</p>

<h2 id="who-wants-it-and-why">Who wants it and why?</h2>

<p>No one is asking. Maybe some SolidFire users would want it - I don't know.</p>

<p>But as IT teams (mostly SMB, from what I see) kick tires on various "alternatives", sometimes they ask about plugins (not specifically SolidFire, but "overall").</p>

<p>My <a href="/2022/04/05/proxmox-solidfire.html">"SolidFire with Proxmox"</a> post gets visitors every now and again, so I figure there may be half a dozen users out there.</p>

<p>SolidFire is simple and easy to use. There isn't that much to automate and I don't know if there's much value in making what's already incredibly easy, easier…</p>

<p>Maybe there is a little. Someone would need to make that happen, though. At this time - with <a href="/2022/09/23/eoa-solidfire.html">not much time left</a> before End of Support arrives.</p>

<p>But still, I was curious so I looked at this "<a href="https://github.com/kolesa-team/pve-purestorage-plugin">community</a>" plugin for Pure Storage.</p>

<p>Let's see…</p>

<h2 id="perl-for-the-win">Perl for the win!</h2>

<p>Proxmox "PVE" storage plugins are written in Perl. That is hilarious!</p>

<p>I last used Perl in 2003 (I guess) and around 2010 I probably already thought I'd never need to use it again.</p>

<p>But here we are… I heard some rumors about Rust as well, so I took a look at these two.</p>

<p>Simple Perl script for <code class="language-plaintext highlighter-rouge">ListAccounts</code> method in Python API has been <a href="https://github.com/scaleoutsean/awesome-solidfire/commit/833dcf0c66dae8ea1e024fc867372448e94a4edc">posted</a> to my Awesome SolidFire repository.</p>

<p>In the same commit I made a Rust example.</p>

<p>So okay, Perl is possible, but unpleasant.</p>

<h2 id="features">Features</h2>

<p>I always thought VMware plugins were monstrosities, especially the ones bloated Java-based ones (before vSphere v7).</p>

<p>I've no idea if they were "bloated", but they certainly seemed so. And there were <strong>always</strong> some bugs. Year after year. Spot a bug if you do this, spot a bug if you do that, spot a bug if you upgrade vCenter… I tend to RTFM so I didn't encounter as many, but it was a terrible experience.</p>

<p>Proxmox storage plugins look exactly like I'd expect a storage plugin to look except for the fact that they're written in Perl.</p>

<p>This one has around 1,000 lines of code, and the usual features: create, grow, delete, purge, snapshot, clone and restore (from a snapshot).</p>

<p>SolidFire's API is probably easier to use than Pure's and unlike that plugin (iSCSI and FC), we don't have to deal with FC. Yay!</p>

<p>We also don't have to deal with multi-pathing (which seems like a big deal in this Pure Storage plugin), because every SolidFire who did it right does not <strong>have</strong> a multi-pathing SAN. Why? Because they use LACP or (maybe even) a single physical path to Solidfire storage.</p>

<p>So, it should be very easy to re-purpose the Pure plugin, right?</p>

<p>Pure Storage (Flash System) uses RESTful API and SolidFire uses JSON-RPC, so almost none of the plugin content can be "recycled" for SolidFire. But, with some DIY practice such as that sample script above and a bit of scrolling up and down that code, it's not too hard to do the basic stuff (such as, "create volume").</p>

<h2 id="effort">Effort</h2>

<p>I've started doing some search &amp; replace work, but I'm still not determined to go further.</p>

<p>But if anyone wants to try, it's worth looking at.</p>

<p>I don't have a Proxmox environment at this time so I'd have to set that up, and then I could try my "SolidFire plugin", see how each of those storage functions fails, fix them one by one, test and document. Writing five or six API methods is not even half the effort. See the list of recommended <a href="https://pve.proxmox.com/wiki/Storage_Plugin_Development">integration testing</a> for storage plugins. If you give it a try also check out the Linstor <a href="https://github.com/LINBIT/linstor-proxmox/blob/master/LINSTORPlugin.pm">plugin</a> that's very readable (great for those of us who suck at Perl!).</p>

<p>At minimum, I think we'd need at least 5 "subroutines" as they call them:</p>

<ul>
  <li>2-3 helper functions for SolidFire</li>
  <li>Create</li>
  <li>Delete</li>
  <li>Snapshot</li>
</ul>

<p>The rest of those that the Pure Storage plugin has are very nice to have, but at minimum I'd start with these three features and whatever other plumbing is required to make them work.</p>

<p>Since now one is asking and there are other pressing things to do (and where Perl isn't required), I doubt I'll try to make that happen. But, if I do it, I'll update this post!</p>

<h2 id="appendix-a-what-works-and-how">Appendix A: what works and how</h2>

<p>I blogged about this last year, but briefly: every SolidFire volume needs to be added like this: in Datacenter aka "vCenter", add iSCSI storage.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-01-add-iscsi-target.png" alt="Configure iSCSI Target" /></p>

<p>IDs should probably follow some convention like "clusterName-volumeName-volumeID" which in this particular case would be <code class="language-plaintext highlighter-rouge">DR-pve01-99</code>. Notice how <code class="language-plaintext highlighter-rouge">Nodes</code> is empty - like with vSphere, you could create a SolidFire VAG and simply add all PVE nodes' initiators to it the same way NetApp HCI did with vSphere ESXi servers.</p>

<p>Once that's done, you may have one or more such iSCSI targets aka "pools".</p>

<p><img src="/assets/images/proxmox-pve-solidfire-02-added-iscsi-target.png" alt="Configured iSCSI Target" /></p>

<p>Now you can create LVM on this iSCSI target and use it.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-03-add-lvm-on-iscsi-target.png" alt="Configure LVM on SolidFire iSCSI Target" /></p>

<p>You might do something like this. I tried "Wipe Removed Volumes" and it didn't do anything obvious, but this probably isn't a smart option for most SolidFire users (more on that later).</p>

<p><img src="/assets/images/proxmox-pve-solidfire-05-lvm-on-solidfire-lun.png" alt="LVM on SolidFire LUN in PVE" /></p>

<p>LXC containers:</p>

<p><img src="/assets/images/proxmox-pve-solidfire-06-lxc-vm-on-lvm-iscsi.png" alt="LXC on SolidFire-backed LXC in PVE" /></p>

<p>Now  you may wonder: if we had a PVE storage plugin for SolidFire, would SolidFire appear on that list? Not necessarily. More on that later.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-07-lxc-lv-creation.png" alt="LXC LV disk on SolidFire-backed LVM in PVE" /></p>

<p>This creates a LV for the container. Use <code class="language-plaintext highlighter-rouge">discard</code> (not shown, but it's in <code class="language-plaintext highlighter-rouge">Mount options</code> in the LXC containers screenshot above, make sure yuo select it!) to keep it slim.</p>

<p>For VMs (and containers) you can put boot disk on LVM backed by shared storage (here, SolidFire iSCSI, of course.) This creates more workload on storage, but OS is "movable" together with any extra disks with data which is good for HA and DR since you don't have to think where the OS is going to come from.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-08-boot-disk-creation.png" alt="VM boot disk on SolidFire-backed VM in PVE" /></p>

<p>Still, there's no value in having OS data on shared storage if one can use stateless OS, provision workload in containers and mount data volumes as Docker volumes. This is also useful with LXC containers.</p>

<p>Either way, LVM can host containers, VMs, boot and data disks. But in both cases you need to do your homework regarding HA with LVM on shared storage to make sure HA works the way you need.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-09-vms-and-lxc-on-lvm-with-solidfire-iscsi.png" alt="VM resources overview with Disk on LVM/iSCSI " /></p>

<p>After playing a bit I checked Account Efficiency for the user <code class="language-plaintext highlighter-rouge">pve</code>. Compression was high, dedupe fine.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-10-pve-lvm-solidfire-efficiency.png" alt="Proxmox PVE and SolidFire storage efficiency " /></p>

<p>This isn't representative, and there's no reason why you'd get more than with VMware or KVM or Trident, but as I mentioned in the old Proxmox post, blocks dedupe and decompress globally, which means across LVMs.</p>

<p>I checked in order to see if my storage efficiency was alarmingly low. It wasn't, so this is fine.</p>

<h2 id="appendix-b-observations-problems-solutions">Appendix B: observations, problems, solutions</h2>

<p>Some extra thoughts related to Proxmox PVE and/or SolidFire…</p>

<p>When you create LVM, Proxmox offers to expand existing LVM groups.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-11-proxmox-storage-ui.png" alt="Promox PVE Storage UI" /></p>

<p>I don't think that's what we should do with SolidFire, except in very special circumstances. Most users want 1-iSCSI-LUN = 1 LVM and then create LVs on that LUN. The default approach seems like VMware datastores that are spread over multiple extents or something like that… I would create a new LVM for every iSCSI volume.</p>

<p>Number (2) below: it's also not <em>easy</em> to achieve consistency in naming. iSCSI targets and LVMs can be observed, but VGs cannot, so I often had to leave that dialog box, go see what I have in terms of VG names, and then go back.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-12-proxmox-storage-naming-conventions.png" alt="Promox PVE Storage naming conventions" /></p>

<p>Number (1) above: even for SolidFire LUNs, I didn't start with <code class="language-plaintext highlighter-rouge">DR-volName-volID</code> but with just <code class="language-plaintext highlighter-rouge">DR</code>, so LUNs and LVMs aren't consistently named either. (LUN names can't be edited, so you can't fix it later if you don't want to remove anything you have on LVMs, and LVMs themselves.)</p>

<p>Number (3): it seems "Wipe Removed Volumes" activates a "shred-like" feature that senselessly overwrites LVs which creates a lot of workload on SolidFire. I can't say that's "unnecessary", but it often probably is unless you're in hosting business.</p>

<p>Also, near number (3) you can see cloning (copying) from one LVM to another can be done. It's not smart like VMware Storage vMotion,but it helps avoid the finding</p>

<p><img src="/assets/images/proxmox-pve-solidfire-13-proxmox-clone-from-local-to-shared.png" alt="LXC moved from local to shared PVE storage" /></p>

<p>You may want to give a higher bust setting to iSCSI volumes to handle these cases. While thinking about this, see top right corner - I created very small iSCSI volumes, which is why moving/rebalancing was necessary. Clone + delete (old) is one way to do it. I didn't see a "move" command, but even if there is it can't offload that from storage any better than cloning can.</p>

<h2 id="appendix-c-why-i-dont-want-a-solidfire-plugin-for-pve">Appendix C: why I don't want a SolidFire plugin for PVE</h2>

<p>Maybe it's because it's very hard to create one. But I actually got a very basic version working this weekend. It's not easy, but it's not super-hard, either.</p>

<p>The biggest reason is SolidFire is so easy to use, it's hard for me to see much value in creating a storage plugin that only saves the <em>easiest</em> step. Yes, I now need to do "three steps" instead of two or maybe one:</p>

<ul>
  <li>Create volume on SolidFire</li>
  <li>Create iSCSI storage "pool" (iSCSI target rescan is in this step)</li>
  <li>Create LVM</li>
</ul>

<p>With a SolidFire plugin, I would have two steps, or maybe one. And the SolidFire step (1) is the easiest one, so why create a plugin for SolidFire?</p>

<p>Considering how confusing the Proxmox UI is (see next Appendix), I honestly don't see value in having a SolidFire plugin for PVE. I just have to update and patch the thing and the confusing and difficult steps all remain (the other two).</p>

<p>I thought how I'd <em>want</em> this to work and my conclusion was: I'd prefer a good CLI that I could run on my management workstation or on a PVE node.</p>

<p>From that CLI, I'd like to automate all those steps, but especially the ones I now do in the Proxmox UI because that's the part that sucks.</p>

<p>I first created a basic SolidFirePlugin.pm which seemed useless to me (more on that later). Then I took some content from it and created what I'd like to have. The result was this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>perl ./perl-utils.pl  <span class="nt">-h</span>
Usage: ./perl-utils.pl &lt;subroutine&gt; <span class="o">[</span>args...]
Available subroutines:
  solidfire_cluster_info
  solidfire_volume_name_to_id &lt;volume_name&gt;
  solidfire_volume_id_to_name &lt;volume_id&gt;
  solidfire_create_volume &lt;volume_name&gt; &lt;size_gib&gt; <span class="o">[</span>qos_policy_id]
  solidfire_modify_volume &lt;volume_id&gt; &lt;new_size_gib&gt;
  solidfire_modify_volume_qos_policy &lt;volume_id&gt; &lt;new_qos_policy_id&gt;
  solidfire_delete_volume &lt;volume_id&gt;
  solidfire_create_qos_policy &lt;policy_name&gt; &lt;burst_iops&gt; &lt;min_iops&gt; &lt;max_iops&gt;
  solidfire_list_qos_policy <span class="o">[</span>policy_name]
  solidfire_modify_qos_policy &lt;policy_id&gt; &lt;new_burst_iops&gt; &lt;new_min_iops&gt; &lt;new_max_iops&gt;
  solidfire_print_volumes_for_account <span class="o">[</span>account_id]

<span class="nv">$ </span>perl ./perl-utils.pl solidfire_cluster_info
Property  Value                               
Name      DR                                  
Unique ID xh67                                
SVIP VLAN 0                                   
SVIP IP   192.168.105.34                      
UUID      2da5c99a-3cd1-46bc-abef-cadebec27bea

</code></pre></div></div>

<p>I get cluster name, iSCSI target IP, volume names, QoS and accounts, so entire back-end information PVE needs is available and can be piped to PVE CLI commands or API functions.</p>

<p>I created even more "subroutines" later, that were out of scope for Proxmox integration, but very much needed.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-04-prime-back-end-solidfire-for-proxmox-pve.png" alt="Prime SolidFire cluster for PVE" /></p>

<p>For example, let's say you tend to use these VM QoS settings. Fine.</p>

<p><img src="/assets/images/proxmox-pve-solidfire-14-proxmox-pve-vm-qos.png" alt="Proxmox VM storage QoS" /></p>

<p>We create a 1 TiB iSCSI LUN, give it 10K/50K/150K QoS and split it among 10 VMs, so each can get a fraction of that.</p>

<p>But, how do I really control and monitor that end-to-end? I can't. Or maybe I need a very complicated plugin.</p>

<p>Instead of that, I can solve this in my CLI with 10% of the effort:</p>

<ul>
  <li>Assign storage QoS tags to VMs (gold, silver, bronze)</li>
  <li>Use PVE API to query them</li>
  <li>Use my CLI to create the right number of SolidFire volumes with appropriate QoS settings</li>
</ul>

<p>Or maybe in the opposite direction, where I know I have 500K IOPS in my cluster with 5 SolidFire H610S nodes, so I create X LUNs with 400K IOPS (MinIOPS commitment) for VMs and leave the rest to LXC containers, and then create PVE storage QoS tags and decide individual VM's IO settings based on my resources.</p>

<p>No matter how I'd do it, it'd be always 10 times easier in my CLI than in a plugin because I can connect and use both APIs (SolidFire and Proxmox VE) and avoid the hassle of SSH-ing into a Proxmox box.</p>

<p>Earlier I mentioned how writing SolidFire-specific function is not even half of the effort required to do this. It's even worse than that. As I worked on this I realized there are additional parts (and this also answers the earlier Storage Plugin UI question):</p>

<ul>
  <li>Storage Plugin module with CLI commands</li>
  <li>Extra Perl module with SolidFire-specific logic, if one wishes to "piggyback" on one of existing plugins (and not have that module clobbered every time Proxmox is updated)</li>
  <li>Patches to the Proxmox UI (to get your storage exposed in the UI) - of course, this is the worst because every update breaks it, and then you have to patch, test and deploy again</li>
</ul>

<p>This one below is probably the easiest to piggyback on - it takes a new "back-end" module in the plugin and enough patching to show SolidFire in the drop-down list as well as expose any options that other, existing back-ends don't have (say, QoS).</p>

<p><img src="/assets/images/proxmox-pve-solidfire-15-proxmox-piggyback-storage-plugin.png" alt="ZFS over iSCSI" /></p>

<p>So even this "easiest" approach involves constant patching of the JS-based Proxmox Web UI every time PVE is updated. It's ridiculous. They can't "load" plugins like vCenter does - the experience is more consistent with having a vSphere storage plugin that invariably breaks every time unless you can get it included in Proxmox ISO (they have ZFS and Ceph included, for example, so Ceph with E-Series may be the easiest built-in approach as far as NetApp storage arrays are concerned.)</p>

<p>I'm still thinking if I should try to release the SolidFire CLI tool for PVE. Even that seems unnecessary.</p>

<p>If you create a SolidFire Volume Access Group and add PVE cluster members to it, all there is to do on SolidFire is create 1 or 2 TB volumes with one of 2-3 QoS policies you choose. That takes seconds. The rest of the problems and challenges are all on PVE side.</p>

<p>The CLI tool I wrote can do most of SolidFire-related workflow (including SolidFire Storage Account and VAG creation), but I'd like it to have just one key feature for PVE: scan &amp; create <em>consistently named</em> iSCSI volumes, LVMs and LGs so that it's easy to tell which VG is which LVM is which SolidFire volume.</p>

<p>End-to-end QoS monitoring and enforcement would be nice, but it's less important.</p>

<p>Two more observations related to Proxmox storage configuration file:</p>

<ul>
  <li>Of course, it uses a proprietary format…</li>
  <li>Secondly, only the first <code class="language-plaintext highlighter-rouge">iscsi</code> entry (<code class="language-plaintext highlighter-rouge">iscsi: DR</code>) was manually created. The rest of them are simply done by adding more iSCSI devices in the Proxmox Web UI. Because iscsid.conf is already capable of accessing the same SolidFire iSCSI Portal, you don't have to add or remove LUNs to this configuration file.</li>
  <li>LVMs are also added and removed by interacting in the UI, e.g. <code class="language-plaintext highlighter-rouge">base DR-pve02-101</code> is an LVM that uses another iSCSI pool (which is volume ID 101 and volume name <code class="language-plaintext highlighter-rouge">pve02</code> on SolidFire).</li>
</ul>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat</span> /etc/pve/storage.cfg 
<span class="nb">dir</span>: <span class="nb">local
	</span>path /var/lib/vz
	content backup,vztmpl,iso

iscsi: DR
	portal 192.168.105.34
	target iqn.2010-01.com.solidfire:xh67.pve01.99
	content none

lvmthin: local-lvm
	thinpool data
	vgname pve
	content images,rootdir

iscsi: DR-pve02-101
	portal 192.168.105.34
	target iqn.2010-01.com.solidfire:xh67.pve02.101
	content images

lvm: pve02-101-lvm
	vgname pve02-vg
	base DR-pve02-101:0.0.0.scsi-36f47acc1000000007868363700000065
	content rootdir,images
	saferemove 0
	shared 1

</code></pre></div></div>

<p>What's even funnier is when you use the Proxmox API, you get the same data structure in API response. Happy parsing!</p>

<p>If you have a CLI tool that takes care of adding and removing iSCSI devices and LVMs while giving things reasonable name, the rest is just creating LVs when you create VMs or LXC containers.</p>

<p>Speaking of which: those who want a good, modern UI should check <a href="/2024/02/28/incus-zfs-netapp-eseries.html">"native" LXC</a> on Ubuntu or <a href="/2022/07/10/xcp-ng-with-netapp-solidfire-iscsi.html">XCP-ng</a> than spend time fiddling with PVE's 20 year old UI. Or wait until they fix it, then give it a try again.</p>

<h2 id="appendix-d-corosync-101-for-casual-users">Appendix D: Corosync 101 for casual users</h2>

<p>As I tried to add the 2nd node to the cluster, I hit what seems to be a common Proxmox landmine.</p>

<blockquote>
  <p>I have a question that I tried many times and search over the Internet and got no answer. Well, I have 2 Proxmox machines fresh install. But when I join the cluster it had the pve-ssl.pem not exist error.
<a href="https://forum.proxmox.com/threads/joining-cluster-pve-ssl-pem-error.131263/">source</a></p>
</blockquote>

<blockquote>
  <p>I've spent all week trying to get clustering working but I'm having problems. 
<a href="https://forum.proxmox.com/threads/create-cluster-problem-possibly-ssl-related.130309/">source</a></p>
</blockquote>

<p>I've definitively seen this as well.</p>

<p>Corosync config after failed cluster expansion:</p>

<pre><code class="language-raw">nodelist {
  node {
    name: pve
    nodeid: 1
    quorum_votes: 1
    ring0_addr: 192.168.105.194
  }
  node {
    name: s195
    nodeid: 2
    quorum_votes: 1
    ring0_addr: 192.168.1.195
  }
}
</code></pre>

<p>Long story short, I suspect that PVE "smartly" picked "Private" (actually it's my iSCSI network, so I wouldn't have picked it if I noticed) network 192.168.105.0/24 for cluster traffic.</p>

<p>It also tried to pick a gateway on that network (I normally wouldn't have it on a iSCSI network, but I have some DHCP clients on it that need to get package updates). I noticed that and stopped DHCP server and gateway on that network.</p>

<p>Then later, when I rebooted the first single-node cluster, I realized my <code class="language-plaintext highlighter-rouge">ring0_addr</code> was down. Why would anyone go out of their way to pick a cluster interface that has DHCP address is beyond belief.</p>

<p>The second node did NOT get an IP address on that network and I tried adding it to the cluster before I configured fixed IP on iSCSI network and that was the end, I suspect…</p>

<p>Proxmox allows you to pick a "secondary" network for cluster traffic, but the UI is poor so I didn't even notice that until I reinstalled everything and paid close attention.</p>

<p>All right, fair enough - it works, but it's lame.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/iscsi" class="page__taxonomy-item p-category" rel="tag">iscsi</a><span class="sep">, </span>
    
      <a href="/tags/netapp" class="page__taxonomy-item p-category" rel="tag">netapp</a><span class="sep">, </span>
    
      <a href="/tags/proxmox" class="page__taxonomy-item p-category" rel="tag">proxmox</a><span class="sep">, </span>
    
      <a href="/tags/solidfire" class="page__taxonomy-item p-category" rel="tag">solidfire</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/solidfire" class="page__taxonomy-item p-category" rel="tag">solidfire</a><span class="sep">, </span>
    
      <a href="/categories/storage" class="page__taxonomy-item p-category" rel="tag">storage</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2025-06-24T00:00:00+08:00">2025-06-24 00:00</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?via=scaleoutSean&text=Do+we+need+a+NetApp+SolidFire+plugin+for+Proxmox%20https%3A%2F%2Fscaleoutsean.github.io%2F2025%2F06%2F24%2Finitial-exploration-solidfire-proxmox-plugin.html" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://scaleoutsean.github.io/2025/06/24/initial-exploration-solidfire-proxmox-plugin.html" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>

</section>


      
  <nav class="pagination">
    
      <a href="/2025/06/22/data-pipeline-with-beegfs-file-system-notifications-and-versity-s3-gateway.html" class="pagination--pager" title="Data pipeline with BeeGFS FS Event Notifications and Versity S3 Gateway">Previous</a>
    
    
      <a href="/2025/06/29/solidfire-with-powershell-7.html" class="pagination--pager" title="Connecting to SolidFire from PowerShell 7.5">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/10/10/post-quantum-crypto-proxy-for-solidfire-eseries-api.html" rel="permalink">Post-Quantum API proxy for E-Series and SolidFire
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-10-10T00:00:00+08:00">2025-10-10 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Enterprise-grade PQC TLS encryption for E-Series and SolidFire API endpoints
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/10/09/storagegrid-s3-cache-branch-buckets.html" rel="permalink">StorageGRID Branch Buckets and Read Cache
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-10-09T00:00:00+08:00">2025-10-09 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Some ways to take better advantage of the new features in StorageGRID 12
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/10/08/epa-3.5.1.html" rel="permalink">E-Series Performance Analyzer v3.5.1
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-10-08T00:00:00+08:00">2025-10-08 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">E-Series Performance Analyzer v3.5.1 has been released with minor improvements
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/10/07/ecp-eseries-performance-analyzer-aka-collector.html" rel="permalink">E-Series SANtricity Collector (ESC 4)
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2025-10-07T00:00:00+08:00">2025-10-07 00:00</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">About EPA 4 (aka ESC 4) and how to pick the right one for you
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/scaleoutsean" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2020-2025 scaleoutSean.github.io | <a href="https://scaleoutsean.github.io">Acting Technologist</a> | Terms: <a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank">CC BY 4.0</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
